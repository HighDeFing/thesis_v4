Universidad Central de Venezuela Facultad de Ciencias Escuela de Computación Centro de Computación Paralela y Distribuida Diseño e implementación de un Sistema Automatizado de Modelaje Meteorológico Interactivo Trabajo Especial de Grado Presentado ante la Ilustre Universidad Central de Venezuela Por el Bachiller: Jonathan E, Urrea F Para optar al Título de: Licenciado en Computación. Profesor Tutor: Robinson Rivas. Caracas, Mayo 2011 2 3 4 5 Resumen El sistema automatizado de modelaje meteorológico interactivo (SAMMET-i) permite al usuario visualizar de una manera rápida y sencilla una serie de mapas de predicciones meteorológicas. También se podrán consultar imágenes satelitales, mapas sinópticos y estaciones que reportan el estado del tiempo. Estas variables se muestran de forma de iconos sobre los mapas de manera que el usuario las puede consultar y ver cuáles son las condiciones del tiempo en dicha localidad. Como parte del sistema, se diseñó una Base de Datos para llevar una recopilación histórica de cada estación meteorológica que reporta diariamente, estos registros se guardan cada hora durante el día y posteriormente pueden ser consultados a través de una interfaz web donde el usuario puede verlas en línea o descargar estas consultas en un archivo. Actualmente se cuenta con información de las estaciones meteorológicas de los aeropuertos venezolanos que reportan en un formato METAR las condiciones del tiempo y las estaciones de la red MeteoVen que forman parte del Centro virtual de Meteorología (CvM) en colaboración con la Unidad de Meteorología ubicado en el Instituto Venezolano de Investigaciones Científicas (IVIC). Palabras claves: Sistemas de Predicción Meteorológica, SAMMET, formatos METAR. 6 7 Índice general 1 Capítulo 1: Introducción ...................................................................................... 17 1.1 PLANTEAMIENTO DEL PROBLEMA ..........................................................................................17 1.2 OBJETIVO GENERAL ..............................................................................................................18 1.3 OBJETIVOS ESPECÍFICOS ........................................................................................................18 1.4 JUSTIFICACIÓN ......................................................................................................................19 2 Capitulo 2: Marco Teórico ................................................................................... 21 2.1 TÉRMINOS METEOROLÓGICOS ...............................................................................................21 2.1.1 Temperatura .....................................................................................................................21 2.1.2 Punto de Rocío .................................................................................................................21 2.1.3 Dirección del Viento .........................................................................................................21 2.1.4 Velocidad del Viento ........................................................................................................21 2.1.5 Ráfagas .............................................................................................................................22 2.1.6 Humedad Relativa ............................................................................................................22 2.1.7 Presión Atmosférica .........................................................................................................22 2.1.8 Precipitación ....................................................................................................................22 2.1.9 Índice de Chandler ...........................................................................................................22 2.1.10 CAPE (Convective Available Potencial Energy) ..............................................................23 2.1.11 Cizalladura .......................................................................................................................23 2.1.12 Temperatura del mar ........................................................................................................23 2.1.13 Altura geopotencial ..........................................................................................................23 2.1.14 Presión a nivel del mar ....................................................................................................23 2.2 MAPAS METEOROLÓGICOS.....................................................................................................23 2.2.1 Satelitales .........................................................................................................................24 2.2.1.1 GOES (Geoestacionary Oservational Enviromental Satellite): ..............................................24 2.2.1.2 TRMM (Tropical Rainfall Measuring Mission) .....................................................................26 2.2.1.3 SST (Sea Surface Temperature) .............................................................................................26 2.2.2 Superficies ........................................................................................................................27 2.3 SITIOS WEB DE METEOROLOGÍA ...........................................................................................28 2.3.1 Centro virtual de Meteorología (CvM) ............................................................................28 2.3.2 SAMMET ..........................................................................................................................28 2.3.3 SAMMET-i ........................................................................................................................31 2.3.4 Wunderground ..................................................................................................................32 2.3.5 Weather Channel ..............................................................................................................32 2.3.6 NCEP ................................................................................................................................32 2.4 FORMATO DE DATOS METEOROLÓGICOS ................................................................................33 2.4.1 METARs ...........................................................................................................................33 2.4.2 Archivo Realtime.txt .........................................................................................................35 2.4.3 Archivo Clientraw.txt .......................................................................................................37 2.5 MODELOS METEOROLÓGICOS ................................................................................................37 2.5.1 Modelo WRF ....................................................................................................................39 2.5.2 Modelo GFS .....................................................................................................................40 2.5.3 Modelo BRAMS ................................................................................................................41 2.5.4 Modelo WAM ....................................................................................................................42 8 3 Capitulo 3 - Descripción y Análisis del diseño ................................................... 43 3.1 METODOLOGÍA UTILIZADA ...................................................................................................43 3.1.1 Etapa de Análisis: ............................................................................................................43 3.1.2 Etapa de Diseño: ..............................................................................................................43 3.1.3 Etapa de Implementación: ................................................................................................44 3.1.4 Etapa de Pruebas: ............................................................................................................44 3.2 REQUERIMIENTOS DE LA SOLUCIÓN ......................................................................................44 3.2.1 Requerimiento de Usuario ................................................................................................44 3.2.2 Requerimientos de Hardware ...........................................................................................46 3.2.3 Requerimientos de Software .............................................................................................46 3.3 DISEÑO DE LAS FUNCIONALIDADES PRINCIPALES ..................................................................46 3.3.1 Descripción General de Casos de Usos: ..........................................................................47 3.4 MODELOS DE SECUENCIA ......................................................................................................56 3.4.1 Funcionalidades del Usuario ...........................................................................................56 3.4.2 Funcionalidades del administrador..................................................................................61 3.5 DIAGRAMAS DE FLUJOS .........................................................................................................64 3.5.1 Funcionalidades del robot ................................................................................................64 4 Capitulo 4 - Desarrollo de la solución ................................................................. 67 4.1 DIAGRAMA DE ENTIDAD/RELACIÓN ......................................................................................67 4.2 MÓDULO DE USUARIO ...........................................................................................................69 4.3 MÓDULO DE ADMINISTRADOR ..............................................................................................91 4.4 MODULO DEL ROBOT ............................................................................................................98 5 Resultados, Conclusiones y Trabajos a futuro ................................................... 101 5.1 RESULTADOS .......................................................................................................................101 5.2 CONCLUSIONES ...................................................................................................................101 5.3 LIMITACIONES .....................................................................................................................102 5.4 TRABAJOS FUTUROS ............................................................................................................103 6 Referencias ........................................................................................................ 105 7 Apéndice A – Configuración del cluster de la Unidad de Meteorología ........... 107 9 Índice de figuras Figura 1.1 - SAMMET-i ......................................................................................................... 19 Figura 1.2 - Sistema de Meteompas Interactivos .................................................................... 20 Figura 2.1 - Imagen satelital de nubosidad ............................................................................. 24 Figura 2.2 - Imagen satelital de vapor de agua ....................................................................... 25 Figura 2.3 - Imagen satelital de onda corta ............................................................................. 25 Figura 2.4 - TRMM ................................................................................................................. 26 Figura 2.5 - SST ...................................................................................................................... 27 Figura 2.6 - Mapa de superficie .............................................................................................. 27 Figura 2.7 - Resultados del graficador Grads.......................................................................... 29 Figura 3.1 - Caso de Uso - Nivel 0 ......................................................................................... 47 Figura 3.2 - Caso de uso - Nivel 1 .......................................................................................... 48 Figura 3.3 - Caso de uso - Nivel 2 (Usuario) .......................................................................... 48 Figura 3.4 - Caso de uso – Nivel 2 (Administrador) ............................................................... 51 Figura 3.5 - Caso de uso – Nivel 2 (Robot) ............................................................................ 54 Figura 3.6 - Consultar registros de una estación meteorológica ............................................. 56 Figura 3.7 - Consultar mapas de predicción meteorológica .................................................... 60 Figura 3.8 - Consultar imágenes de mapas ............................................................................. 61 Figura 3.9 - Administrar estaciones meteorológicas ............................................................... 62 Figura 3.10 - Registrar datos meteorológicos ......................................................................... 64 Figura 3.11 - Procesar corte de imágenes ............................................................................... 66 Figura 4.1 - Modelo Entidad/Relación .................................................................................... 67 Figura 4.2 - Pagina inicial del Sistema de Meteomapas Interactivos (SMI) ........................... 69 Figura 4.3 - Solicitud de geolocalización al usuario ............................................................... 70 Figura 4.4 - Código Javascript de geolocalización ................................................................. 70 Figura 4.5 - Código Javascript de carga de inicio del mapa ................................................... 71 Figura 4.6 - Iconos de las estaciones cargadas en el mapa ..................................................... 71 Figura 4.7 - Marco informativo de la condición actual de una estación meteorológica ......... 72 Figura 4.8 - Registro del día de una estación meteorológica .................................................. 73 Figura 4.9 - Registro histórico de una estación meteorológica ............................................... 73 Figura 4.10 - Formato del archivo de descarga ....................................................................... 74 Figura 4.11 - Grafico de temperatura ...................................................................................... 74 Figura 4.12 - Mapa de predicción de temperatura .................................................................. 75 Figura 4.13 - Cambio de la hora de predicción ....................................................................... 76 Figura 4.15 - Mapa de precipitación de Nivel 6 de zoom ....................................................... 77 Figura 4.14 - Mapa de temperatura a un nivel de 500 Hpa ..................................................... 77 Figura 4.17 - Mapa de precipitación de Nivel 4 de zoom ....................................................... 78 Figura 4.16 - Mapa de precipitación de Nivel 6 de zoom ....................................................... 78 Figura 4.18 - Mapa de predicción de viento ........................................................................... 79 Figura 4.19 - Nubosidad sobre el área del Caribe y Centroamérica ....................................... 80 Figura 4.20 - Mapa de predicción del oleaje ........................................................................... 80 file:///E:/tesis-SAMMETI2.docx%23_Toc294523617 file:///E:/tesis-SAMMETI2.docx%23_Toc294523622 file:///E:/tesis-SAMMETI2.docx%23_Toc294523625 file:///E:/tesis-SAMMETI2.docx%23_Toc294523633 file:///E:/tesis-SAMMETI2.docx%23_Toc294523638 file:///E:/tesis-SAMMETI2.docx%23_Toc294523643 file:///E:/tesis-SAMMETI2.docx%23_Toc294523651 file:///E:/tesis-SAMMETI2.docx%23_Toc294523653 10 Figura 4.21 - Descargas eléctricas .......................................................................................... 81 Figura 4.22 - Mapa de predicción de temperatura a nivel del mar ......................................... 82 Figura 4.23 - Mapa de predicción de humedad relativa .......................................................... 82 Figura 4.24 - Mapa de predicción de CAPE ........................................................................... 83 Figura 4.25 - Mapa de predicción de Cizalladura ................................................................... 84 Figura 4.26 - Mapa de predicción de Índice de Chandler ....................................................... 84 Figura 4.27 - Mapa de Altura geopotencial ............................................................................ 85 Figura 4.28 - Mapa de Presión a nivel del mar ....................................................................... 85 Figura 4.29 - Vapor de agua para la región del Caribe ........................................................... 86 Figura 4.30 - Mapa satelital de Onda corta para la región del Caribe..................................... 86 Figura 4.31 - Mapa satelital TRMM ....................................................................................... 87 Figura 4.32 - Mapa Satelitales SST ........................................................................................ 88 Figura 4.33 - Mapa de superficie para las 00:00 horas ........................................................... 88 Figura 4.34 - Mapa de superficie para las 06:00 horas .......................................................... 89 Figura 4.35 - Mapa de superficie para las 12:00 horas ........................................................... 89 Figura 4.36 - Mapa de superficie para las 18:00 horas .......................................................... 90 Figura 4.37 - Mapa de superficie de Temperatura-Viento-Presión ......................................... 90 Figura 4.38 - Mapa de superficie de Precipitación-Humedad Relativa .................................. 91 Figura 4.39 - Interfaz de ingreso ............................................................................................. 92 Figura 4.40 - Interfaz del modulo de administrador ............................................................... 92 Figura 4.41 - Interfaz de administrar regiones ........................................................................ 93 Figura 4.42 - Interfaz de administrar países ............................................................................ 93 Figura 4.43 - Interfaz de administrar países ............................................................................ 94 Figura 4.44 - Interfaz de administrar tipo de fuentes de datos meteorológicas ...................... 95 Figura 4.45 - Interfaz de agregar una estación nueva (I parte) ............................................... 96 Figura 4.46 - Interfaz de agregar una estación nueva (II parte) .............................................. 96 Figura 4.47 - Interfaz de ver detalles de una estación ............................................................. 97 Figura 4.48 - Mensaje de confirmación para eliminar una estación ....................................... 97 Figura 4.49 - Interfaz para editar estación .............................................................................. 98 11 Índice de Tablas Tabla 2.1 - Formato del archivo Realtime.txt ........................................................................ 36 Tabla 2.2 - Formato del archivo Clientraw.txt ....................................................................... 37 12 13 Dedicatoria A mí Mamá y mi Abuela por haberme ayudado todo este tiempo durante la carrera, darme todo el apoyo cuando más lo necesitaba, por todas esas madrugadas, por todos los sacrificios que realizaron para poder llegar a esas instancias. A Dios por haber permitido que mi Abuela siga con nosotros y permitirle que sea testigo de este logro tan importante. 14 15 Agradecimiento A mi Mamá y mi Abuela por estar siempre a mi lado dándome apoyo en toda mi vida, por darme ánimos de nunca rendirme de luchar por lo que siempre he querido. A mi Tutor Robinson Rivas por brindarme sus conocimientos durante el desarrollo de mi carrera y durante la tesis, por todo el ánimo que me ha dado en los momentos más difíciles siempre ha sabido que decirme. A mis Co-Tutores Estatio Gutiérrez y Raúl Padrón por todo su apoyo durante la realización de la tesis a comprender este mundo tan maravilloso que es la meteorología. Al Instituto Venezolano de Investigaciones Científicas por aceptarme como estudiante de Tesista de pregrado, y por todo el apoyo institucional. Al Centro de Estudios Avanzados por otorgarme financiamiento durante la realización de mi tesis, y por toda la orientación recibida por su personal. A todo los muchach@s del CCPD por todos años que hemos compartido y por fin podemos decir que hemos logrado los objetivos que nos planteamos desde que comenzamos la carrera. A mi novia por haberme aguantado todo este tiempo de full estrés, gracias por estar ahí siempre apoyándome y tenerme tanta paciencia. 16 17 1 Capítulo 1: Introducción La humanidad ha realizado un gran esfuerzo por predecir el estado del tiempo y el clima, así como para interpretar las señales visuales, sonoras y de otro tipo que emite la atmósfera. Recientemente se ha avanzado de manera importante en la capacidad de informar los reportes del tiempo, bien sea a través de la televisión, los medios impresos ó el Internet. Gracias a la gran influencia de la Internet sobre estos reportes del tiempo y predicciones meteorológicas es posible ahora consultar estas informaciones en tiempo real. Por estas razones en Venezuela se desarrolló el Sistema Automatizado de Modelaje Meteorológico I-interactivo (SAMMET-i). En este trabajo presentamos una herramienta visual (Meteomapas interactivos) que hemos desarrollado para agregar nuevas funciones al sistema como lo son el almacenamiento y la descarga de datos históricos de las estaciones meteorológicas y la consulta de las predicciones meteorológicas del SAMMET-i, así como algunas informaciones referentes al estado del tiempo actual; y adicionalmente se agregó un menú amigable que permitiese elegir las distintas opciones de los mapas con las predicciones meteorológicas. El sistema está siendo puesto a prueba tomando información de un número superior a 340 estaciones situadas en el área de Venezuela, Colombia, Brasil, Ecuador, Perú, Centroamérica y el Caribe, a través de los datos proporcionados por la National Oceanic and Atmospheric Administration (NOAA) y datos de cinco estaciones venezolanas de la Red MeteoVen. Se presentan el desarrollo preliminar, algunas pantallas del sistema, y una discusión acerca de los alcances futuros de este proyecto. 1.1 Planteamiento del problema La Red de Estaciones Meteorológicas (Red MeteoVen), integrante del Centro virtual de Meteorología (CvM) opera en colaboración con la Unidad de Meteorología ubicado en el Instituto Venezolano de Investigaciones Científicas (IVIC), registrando 18 muy frecuentemente (cada 5 minutos) las condiciones atmosféricas reportadas por las estaciones meteorológicas en distintas zonas del país. Actualmente, la información puede ser consultada en tiempo real a través de su sitio web http://met.ivic.gob.ve/cvm pero los registros históricos no están disponibles al público de una manera práctica y sencilla. La inexistencia de una Base de Datos centralizada así como la manera ineficiente en que se almacenan los datos en la actualidad dificulta y en la práctica imposibilita el acceso a la información a través de la página web del CvM. Por esta razón, fue necesaria la elaboración de un sistema que almacenara los datos generados por las estaciones y permita el acceso a los mismos a través de una interfaz. Además de los datos registrados por la Red MeteoVen, se consideró útil incluir los reportes de las estaciones meteorológicas ubicadas en los distintos aeropuertos de Venezuela y el Caribe, los cuales son transmitidos cada cierto número de horas por cada aeropuerto a través de la Internet usando un formato estandarizado denominado METAR. Por otra parte, los datos disponibles en esta Base de Datos meteorológicos serán utilizados como condiciones iníciales para la ejecución de los distintos modelos meteorológicos de predicción del tiempo del SAMMET-i, como los son los modelos WRF (Weather Research Forecast) , WAM (Wave Analysis Model) , entre otros. 1.2 Objetivo General Diseñar y construir un sistema que permita la recopilación y almacenamiento de los reportes producidos por las estaciones; así como también un sitio web que muestre las predicciones meteorológicas a través de una interfaz de mapas interactivos. 1.3 Objetivos Específicos  Diseñar un modelo de datos que permita almacenar las variables meteorológicas persistentes que contienen los METARs u otros formatos.  Diseñar un modelo de datos específico de la herramienta para el manejo y control de las funcionalidades del sistema. 19  Automatizar el proceso de almacenamiento de los registros que cada estación meteorológica reporta.  Diseñar una interfaz que permita administrar las estaciones meteorológicas para que se puedan integrar al sistema.  Diseñar una interfaz que muestre de forma gráfica las predicciones meteorológicas a través de un mapa interactivo.  Diseñar una interfaz que muestre las condiciones del tiempo actuales de una estación meteorológica.  Colocar a disposición del público los archivos con los datos históricos provenientes de cada estación meteorológica. 1.4 Justificación La ausencia de registros históricos de variables meteorológicas disponibles en Internet para Venezuela y el Caribe hace necesario el desarrollo de una herramienta que ponga a la disposición de cualquier usuario la información meteorológica generada por la red MeteoVen, así como los datos provenientes de los aeropuertos que solo pueden ser consultados en tiempo real. Finalmente actualizar el aspecto del sitio web del Sistema Automatizado de Modelaje Meteorológico Interactivo (SAMMET-i), que se muestra en la Figura 1.1 Figura 1.1 - SAMMET-i 20 Para luego migrarlo a una versión más amigable como el Sistema de Meteomapas Interactivos (SMI), como se muestra en la Figura 1.2, que a su vez permita integrar nuevos modelos de predicción en el futuro. Figura 1.2 - Sistema de Meteompas Interactivos 21 2 Capitulo 2: Marco Teórico Esta sección reúne toda la información documental para confeccionar el diseño de la investigación que proporcionará el conocimiento teórico para el diseño y desarrollo del Sistema Meteomapas Interactivos (SMI). 2.1 Términos Meteorológicos A continuación se explican una serie de términos meteorológicos que más adelante se van a ir explicando. 2.1.1 Temperatura Es el grado de calor y de frío del ambiente, como se indica en una escala determinada. En observaciones de la superficie, se refiere principalmente al aire libre o temperatura ambiental cerca a la superficie de la tierra. Los valores válidos que puede reportar una estación meteorológica están entre -60 ºF (-51 ºC) hasta 130 ºF (54.4 ºC). 2.1.2 Punto de Rocío Es la temperatura a partir de la cual empieza a condensarse el vapor de agua contenido en el aire produciendo rocío, neblina, o en el caso de que la temperatura sea inferior a 0ºC, escarcha. Los valores deberían estar comprendidos entre -90 ºF (-67.7 ºC) hasta 90 ºF (32.2 ºC). 2.1.3 Dirección del Viento La dirección se mide en grados, de la cual el viento sopla con dirección al norte. La dirección del viento será determinada calculando el promedio de la dirección durante un período de 2 minutos. Los valores estarían entre 0º y 359º. 2.1.4 Velocidad del Viento Es el promedio del movimiento del aire durante un período de tiempo preestablecido. Puede medirse en varias unidades por ejemplo: Nudos (kts), kilómetros por hora o en 22 millas por hora. Los valores si están medidos en nudos deberían estar entre 0 kts y 350 kts. Si es en kilómetros por hora, el valor debería estar comprendido entre 0 km/h y 649 km/h y si son millas por hora, el valor sería entre 0 mp/h y 403 mp/h. 2.1.5 Ráfagas La información de la velocidad del viento correspondiente a los últimos 10 minutos se llevará a cabo para evaluar la ocurrencia de ráfagas. Las ráfagas se indican con rápidas fluctuaciones en la velocidad del viento con una variación de 10 nudos o más entre los periodos picos y los periodos calmados. La velocidad de una ráfaga de viento será la velocidad máxima instantánea. 2.1.6 Humedad Relativa Es la humedad que contiene una masa de aire, en relación con la máxima humedad absoluta que podría admitir sin producirse condensación, conservando las mismas condiciones de temperatura y presión atmosférica. Esta es la forma más habitual de expresar la humedad ambiental. Usualmente se expresa en porcentajes. Los valores están comprendidos entre 0 % y 100 %. 2.1.7 Presión Atmosférica Es la presión o el peso por unidad de área que ejerce la atmósfera en un punto determinado. La presión puede expresarse: hectopascales (Hpa), en milibares (mb), pulgadas (in) o milímetros de mercurio (Hg). También se conoce como presión barométrica. Los valores están comprendidos entre 846 mb y 1110 mb. 2.1.8 Precipitación Es una de las formas en la que se presenta el agua, ya sea líquido o sólido, que caen de la atmósfera y llega al suelo. Esto incluye la lluvia, llovizna, llovizna helada, lluvia helada, granizo, hielo granulado, nieve, granizo menudo y bolillas de nieve. 2.1.9 Índice de Chandler Proporciona una medida del efecto de la temperatura, velocidad del viento y humedad promedios en la ocurrencia, intensidad y tasa de propagación de incendios. 23 2.1.10 CAPE (Convective Available Potencial Energy) Representa la cantidad de energía de flotabilidad disponible de una parcela o burbuja de aire que se eleva a cierta distancia vertical a través de la atmósfera. 2.1.11 Cizalladura Es la diferencia en la velocidad del viento o su dirección entre dos puntos en la atmósfera terrestre. Dependiendo de si los dos puntos están a diferentes altitudes o en diferentes localizaciones geográficas, la cizalladura puede ser vertical u horizontal. 2.1.12 Temperatura del mar El agua de los océanos se calienta por la radiación del Sol, pero debido a los distintos ángulos con que el globo terrestre recibe los rayos solares (latitud), la temperatura disminuye desde el ecuador, donde alcanza los 30 ºC, hacia los polos donde tiene sólo -2,2 ºC en promedio. 2.1.13 Altura geopotencial La altura de un punto dado en la atmósfera en unidades es proporcional a la energía potencial de la unidad de masa (geopotencial) a esta altura, en relación con el nivel del mar. 2.1.14 Presión a nivel del mar Es la presión atmosférica a nivel del mar. El cálculo permite comparar la presión de dos sitios con alturas diferentes. 2.2 Mapas meteorológicos Un mapa meteorológico trata de representar sobre una zona de la Tierra los valores de una variable atmosférica, en superficie o en niveles superiores. A veces los mapas describen también la situación de algunos fenómenos atmosféricos de forma tridimensional. Los métodos de representación pueden ser diferentes. A continuación se explican varios tipos de mapas meteorológicos: 24 2.2.1 Satelitales Los mapas satelitales se dividen en varios tipos: 2.2.1.1 GOES (Geoestacionary Oservational Enviromental Satellite): Sistema de satélites geoestacionarios estadounidenses. Se tienen en operación dos satélites a los que se conoce como GOES-East y GOES-West que cubren en sus observaciones. El GOES-East abarca el Atlántico mientras que el GOES-West cubre el área del Pacífico [1]. Estos mapas pueden ser de tipo: - Nubosidad: Muestra características climáticas a nivel mesoescala, como la cobertura de nubosidad, los límites de masa de aire, zonas de convergencia, las tormentas y la cobertura de nieve. En la Figura 2.1 se muestra un ejemplo. Figura 2.1 - Imagen satelital de nubosidad - Vapor de agua: La imagen de vapor d agua se forma por la radiación emitida por las nubes y las grandes cantidades de vapor de agua. Nos muestra la cantidad de vapor de agua. En la Figura 2.2 se muestra un ejemplo. 25 Figura 2.2 - Imagen satelital de vapor de agua - Onda Corta: Las imágenes en esta longitud de onda consisten no sólo de la radiación emitida por el sistema de la atmósfera terrestre, también se refleja la radiación solar. Útil para la niebla y la identificación de agua en la nube, también se observan los cambios de fase de las nubes, y distinción de la cobertura de nubes sobre las zonas con nieve, y pueden detectarse incendios. En la Figura 2.3 se muestra un ejemplo. Figura 2.3 - Imagen satelital de onda corta 26 2.2.1.2 TRMM (Tropical Rainfall Measuring Mission) Se utilizan para investigar la ubicación y la intensidad de la lluvia,. No todas las nubes causan la lluvia, y cuando esta cae, lo hace a través de varias alturas en la atmósfera, pudiendo a veces no alcanzar el suelo en absoluto. TRMM no es utilizado para las mediciones de precipitación diaria en las ciudades, pero es utilizado por científicos de la atmósfera y los meteorólogos para comprender mejor cómo y por qué ocurren las precipitaciones, de esa manera podrán mejorar sus predicciones en el futuro [2]. En la Figura 2.4 se muestra un ejemplo. 2.2.1.3 SST (Sea Surface Temperature) La temperatura superficial del mar (TSM) es la temperatura del agua cercana de la superficie de los océanos. La definición de la superficie varía según el método de medición utilizado, pero es entre un milímetro (0,04 pies) y 20 metros (70 pies) por debajo de la superficie del mar. En la Figura 2.5 se muestra un ejemplo. Figura 2.4 - TRMM 27 Figura 2.5 - SST 2.2.2 Superficies Muestra la sinopsis de la situación meteorológica a nivel de superficie. Por norma internacional el nivel medio del mar es considerado como el nivel superficial, por lo que los observatorios situados a mayor o menor altura deben ajustar sus lecturas por medio de correcciones. En la Figura 2.6 se muestra un ejemplo. Figura 2.6 - Mapa de superficie 28 2.3 Sitios Web de Meteorología 2.3.1 Centro virtual de Meteorología (CvM) El Centro virtual de Meteorología (CvM) ha sido creado por el Ing. Hidrometeorologista Estatio Gutiérrez y el Dr. Raúl Padrón en Febrero del 2008 para apoyar la investigación de la Meteorología en Venezuela y el Caribe. En su sitio en Internet http://met.ivic.gov.ve/cvm se publican una variedad de productos en tiempo real, así como reportes automatizados de las estaciones que colaboran con los varios proyectos que soporta. Las actividades del CvM cuentan con el apoyo institucional del IVIC (Instituto Venezolano de Investigaciones Científicas), a través de su Unidad de Meteorología (UMIVIC), se puede consultar en http://met.ivic.gob.ve El CvM es una organización voluntaria sin fines de lucro, todos los entusiastas de la meteorología y radioaficionados son bienvenidos a participar y colaborar en la medida de sus posibilidades. Actualmente, el CvM lleva a cabo quince proyectos, entre los cuales destacan la Red de Estaciones Meteorológicas de Venezuela (Red MeteoVen), el Sistema Automatizado de Modelado Meteorológico para Venezuela (SAMMET), entre otros que se pueden encontrar en la página web. [5] 2.3.2 SAMMET El Sistema Automatizado de Modelado Meteorológico para Venezuela (SAMMET) que evoluciono rápidamente al SAMMET-i, es una herramienta desarrollada por el CvM, para proporcionar diariamente los resultados de las simulaciones, realizadas a través de varios modelos numéricos como por ejemplo el modelo WRF, de algunas condiciones meteorológicas como el mapa de descargas eléctricas atmosféricas y oceánicas sobre Venezuela y el Caribe. Este tipo de información es de suma utilidad para pronosticadores, investigadores y público en general que desean conocer cuál http://met.ivic.gov.ve/cvm 29 será el posible estado del tiempo en un momento determinado futuro sobre el territorio nacional. El sistema está conformado por una serie de códigos que permiten descargar la información necesaria de Internet, realizar sin intervención de un usuario todo el proceso de ejecución de cada uno de los modelos y finalmente posprocesar las salidas obtenidas utilizando el graficador Grads [6], que es una herramienta interactiva utilizada para la manipulación y visualización de datos científicos, en la Figura 2.7 se muestra un ejemplo de una salida del graficador. El tiempo de cómputo de este tipo de modelos depende directamente de las características del servidor utilizado, las dimensiones del área simulada, su resolución y de las parametrizaciones físicas seleccionadas. Debido a que este proyecto ha sido desarrollado con poco financiamiento existen ciertas limitaciones en cuanto a la capacidad computacional disponible y la elaboración de herramientas que permitan un desempeño más eficiente del sistema. Actualmente, es posible realizar simulaciones de 48 horas de duración para un par de dominios en donde el primero de ellos abarca El Caribe, Venezuela, parte de Colombia y Brasil. El segundo dominio está destinado solo para simular el comportamiento de las variables meteorológicas sobre Venezuela a una resolución mayor. Las limitaciones antes mencionadas traen como consecuencia que se Figura 2.7 - Resultados del graficador Grads 30 presenten algunos errores en la graficación de las salidas en esta primera etapa, como por ejemplo la ausencia de meteogramas y sondeos en la salida del WRF, estas fallas serán solventadas paulatinamente. Además se prevé la instalación de otros modelos tanto meteorológicos como oceánicos. Los modelos BRAMS (Brazilian Regional Atmospheric Modeling System), CATT (Coupled Aerosol and Tracer Transport), WAM (Wave Analysis Model), WRF (Weather Research and Forecasting), MM5 (Mesoscale Model 5) y los códigos que constituyen al sistema son ejecutados en un servidor de 64-bits con procesador Intel Dual-Core de 8 procesadores y compilador Intel, ubicado en la Unidad de Meteorología del Instituto Venezolano de Investigaciones Científicas (IVIC). El inicio de la ejecución de los distintos modelos está pautado a diferentes horas del día debido a la imposibilidad de ejecutar la totalidad de los mismos simultáneamente. Los resultados son publicados en dos grupos, uno en horas de la mañana y otro en horas de la tarde. El GFS (Global Forecast System), es el único modelo que no es ejecutado en el servidor y sus datos son utilizados como condición de borde para el resto. Al momento de analizar este tipo de información es importante tener en cuenta que las salidas de los modelos son una herramienta de pronóstico y dichos resultados deben ser utilizados junto a imágenes de satélite y radar, modelos estadísticos y el conocimiento de un especialista para emitir una predicción. Las gráficas presentadas en esta página ayudan a entender el comportamiento de la atmósfera en las próximas 48 horas con un grado de incertidumbre que no ha sido determinado para el país. Tanto la validación de estos modelos como la elaboración del pronóstico nacional es tarea de los institutos competentes pertenecientes al estado donde el SAMMET no intenta suplantar sus funciones. Este tipo de iniciativas no serían posibles sin la existencia de software con licencia libre que van desde el sistema operativo utilizado (Fedora Core 7) pasando por el compilador, los códigos fuente de cada modelo, los graficadores, etc. Aunado a las herramientas computacionales, la ejecución puede ser realizada gracias a los datos de 31 los modelos globales disponibles en Internet que son publicados cuatro veces al día por distintas instituciones como la NOAA y el Centro de Previsión de Tiempo y Estudios Climáticos (CPTEC). [7] 2.3.3 SAMMET-i Es una herramienta desarrollada para proporcionar diariamente las simulaciones realizadas por modelos numéricos de predicción del tiempo, de las condiciones meteorológicas y oceánicas sobre Venezuela y el Caribe. Los modelos WRF y WAM son corridos para un período de 48 horas en un par de dominios: el primero abarca El Caribe, Centroamérica, Venezuela, Guyana, Surinam, Guayana Francesa, Colombia, Brasil, Perú, Ecuador y parte de Bolivia, y el segundo dominio simula el comportamiento de las variables meteorológicas sobre Venezuela a una resolución mayor (10 km). Los modelos son inicializados con la información proveniente del GFS. Los resultados de las simulaciones son presentados a través de una interfaz Google Maps. El SAMMET-i presenta una serie de mapas meteorológicos de las variables precipitación, temperatura, viento, presión, humedad relativa y CAPE, y están disponibles para cuatro niveles de la tropósfera. Adicionalmente, es posible acceder de manera rápida a imágenes satelitales de Venezuela y el Caribe, mapas sinópticos, mapa de descargas eléctricas atmosféricas de Venezuela, datos de estaciones meteorológicas en tiempo real, webcams, sondeos y meteogramas simulados para cualquier punto sobre el dominio. Los distintos modelos son ejecutados diariamente de manera casi simultánea en el servidor del Centro virtual de Meteorología en horas de la madrugada. La mayoría de los productos están disponibles en las primeras horas de la mañana. Sin embargo, el proceso de creación de las imágenes es lento debido a la gran cantidad de información que se procesa. Por esa razón, los mapas correspondientes al segundo zoom están disponibles apenas en horas de la tarde. [8] 32 2.3.4 Wunderground Weather Underground es una compañía comprometida en ofrecer la información meteorológica más fiable y precisa posible. Los monitores de última generación supervisan y predicen las condiciones meteorológicas para todas las ubicaciones del mundo, por lo que siempre el usuario encontrara la información del tiempo que necesite. Además de ofrecer información del tiempo gratuita en línea a millones de usuario en la Internet, también ofrecen una variedad de servicios de reportes meteorológicos y paquetes del tiempo para la Web. Desde 1995 el sitio web no se ha detenido y nuevas características se han añadido en los últimos años. Cabe destacar que Weather Underground ha desarrollado la mayor red mundial de estaciones meteorológicas personales (casi 19.000 estaciones en los EE.UU y más de 13.000 estaciones en el resto del mundo) que proporciona al usuario las condiciones climáticas lo más cercana posible a donde se encuentre localmente.[9] 2.3.5 Weather Channel Desde su lanzamiento en 2002, weather.com/espanol brinda información meteorológica completa y confiable en toda Norteamérica. Además de incluir todos los códigos postales de los Estados Unidos y miles de ciudades internacionales, weather.com/espanol también brinda información sobre actividades de la vida cotidiana y datos de interés sobre salud, viajes y esparcimiento, entre otros. El sitio pone a disposición del usuario una amplia gama de innovadores mapas meteorológicos que incluyen datos de radar (precipitaciones) y satélite (nubosidad).[10] 2.3.6 NCEP La National Centers for Environmental Prediction (NCEP), una extensión de la NOAA’s National Weather Service (NWS), se compone de 9 centros y una oficina central del director, la cual provee una amplia variedad de servicios meteorológicos nacionales e internacionales de la NWS, organismos gubernamentales, manejo de emergencias, meteorólogos del sector privado y las organizaciones meteorológicas y sociedades a través del mundo. NCEP es un recurso crítico nacional en la predicción 33 meteorológica a nivel nacional e internacional, adicionalmente es el punto de partida para casi todos los pronósticos del tiempo en los Estados Unidos.[11] 2.4 Formato de datos meteorológicos A continuación se da una descripción de los formatos METARs, archivos Clientraw de Weather Display[12] y Realtime de Cumulus[13], y se muestra un ejemplo de cada uno. 2.4.1 METARs Es un formato de presentación de información meteorológica. Un reporte del tiempo METAR es utilizado principalmente por los pilotos en el cumplimiento de una parte de instrucciones pre-vuelo, y por los meteorólogos, que utilizan la información de los METAR para ayudar al pronóstico del tiempo. Están normalizados a través de la International Civil Aviation Organization (ICAO), que permite que se entiendan en la mayor parte del mundo. Los METARs suelen proceder de los aeropuertos o estaciones de observación meteorológica. Los informes son generados normalmente una vez cada hora, si las condiciones cambian significativamente, sin embargo, pueden ser actualizados en los informes especiales, llamados SPECIs. Los METARs contienen un reporte del viento, visibilidad, alcance visual de pista, tiempo presente, cobertura del cielo, temperatura, punto de rocío, y el reglaje de altímetro referidos colectivamente como "el cuerpo del reporte”. Además, es codificada la información que se elabora en un lenguaje claro de los datos del cuerpo del informe puede ser añadidos a los METARs. Ejemplo de un código METAR internacional: 34 El siguiente es un ejemplo METAR del aeropuerto de Burgas, Bulgaria, y fue tomada el 4 de febrero de 2005 a las 16:00 UTC: METAR LBBG 041600Z 12003MPS 310V290 1400 R04/P1500N R22/P1500U M04/M07 Q1020 NOSIG Interpretando cada código:  METAR, indica que lo siguiente es un estándar de observación.  LBBG, es el código del ICAO para aeropuerto de Burgas.  041600Z, indica el tiempo de la observación. El 04 es el día del mes, 1600 es la hora Zulu, que es igual a 16:00 GMT).  12003MPS, indica que la dirección del viento es de 120º al este-sureste a una velocidad de 3 MPS (5,8 KT; 6,7 mph, 11 km/h). Las mediciones de la velocidad puede variar desde nudos (KT), metros por segundo (MPS) ó kilómetros por horas KMH.  310V290, indica la dirección del viento que es variable desde 310º noreste a 290º oeste-noreste.  1400, indica que la visibilidad prevaleciente es de 1.400 m (4.600 pies).  R04/P1500N, indica el alcance visual en pista (RVR) a lo largo de la pista 04 es de 1.500 m (4.900 pies).  R22/P1500U, indica el alcance visual en pista (RVR) a lo largo de la pista 22 es de 1.500 m (4.900 pies).  M04/M07, indica que la temperatura es de -4 ºC (25 ºF) y punto de rocío es de -7 ºC (19 ºF). Una M por delante indica que la temperatura o punto de rocío está por debajo de cero (0) grados Celsius.  Q1020, indica el ajuste actual del altímetro (QNH) es 1.020 hPa (30.12 inHg).  NOSIG, es un ejemplo de un pronóstico de tendencia que se adjunta a los METARs en las estaciones mientras un meteorólogo está de guardia. NOSIG significa que ningún cambio significativo se espera en las condiciones reportadas en las próximas 2 horas.[14] 35 2.4.2 Archivo Realtime.txt Este archivo de Cumulus que es usado por la red MeteoVen sigue el siguiente este formato: Campo Ejemplo Descripción 1 18/10/08 Fecha (dd/mm/yy) 2 16:03:45 Hora (hh:mm:ss) 3 8.4 Temperatura externa 4 84 Humedad relativa 5 5.8 Punto de rocío 6 24.2 Promedio de la velocidad del viento 7 33.0 Última lectura de la velocidad del tiempo 8 261 Dirección del viento (grados) 9 0.0 Tasa de lluvia actual 10 1.0 Lluvia actual 11 999.7 Barómetro 12 W Dirección del viento 13 6 Velocidad del viento 14 Mph Unidades del viento 15 C Unidades de temperatura 16 Mb Unidades de presión 17 Mm Unidades de la lluvia 18 146.6 Viento de lluvia 19 +0.1 Tendencia del valor de la presión 36 Campo Ejemplo Descripción 20 85.2 Precipitación mensual 21 588.4 Precipitación anual 22 11.6 Precipitaciones del día de ayer 26 -0.7 Tendencia de la temperatura 27 10.9 Temperatura más alta del día 28 12:00 Hora de la temperatura más alta de hoy (hh:mm) 29 7.8 Temperatura más baja del día 30 14:41 Hora de la temperatura más baja de hoy (hh:mm) 31 37.4 Velocidad del viento más alta de hoy (promedio) 32 14:38 Hora de la velocidad del viento más alta de hoy (promedio) (hh:mm) 35 999.8 Presión más alta de hoy 36 16:01 Hora de la presión más alta de hoy 37 998.4 Presión más baja de hoy 38 12:06 Hora de la presión más baja de hoy 39 10.3 Índice de calor 40 10.5 Humedad 41 13 Índice de UV Tabla 2.1 - Formato del archivo Realtime.txt 37 2.4.3 Archivo Clientraw.txt A continuación se muestran el formato de este archivo de Weather Display de la red MeteoVen: Campo Ejemplo Descripción 1 12345 Código del archivo 2 6.1 Promedio de la velocidad del tiempo 3 8.5 Ráfagas 4 235 Dirección del viento 5 16.3 Temperatura (ºC) 6 79 Humedad externa (%) 7 1010.0 Presión atmosférica (hpa) 8 0.0 Precipitación diaria 9 0.0 Tasa de lluvia (mm/min) 11 15.9 Temperatura del suelo (ºC) Tabla 2.2 - Formato del archivo Clientraw.txt 2.5 Modelos meteorológicos Son programas informáticos que producen información meteorológica correspondiente a un momento en el futuro para determinados puntos del planeta y ciertas altitudes. En el plano horizontal, un modelo puede ser global y cubrir la totalidad de la Tierra, o bien regional, en ese caso abarca solo una parte de la Tierra. Los modelos regionales también son conocidos como "modelos de área limitada". Los pronósticos se calculan utilizando las ecuaciones matemáticas para la física y la dinámica de la atmósfera. Estas ecuaciones son no lineales y son imposibles de 38 resolver con exactitud. Por consiguiente, los métodos numéricos solo permiten obtener soluciones aproximadas. Los distintos modelos usan diferentes métodos de solución. Algunos modelos globales emplean métodos espectrales para las dimensiones horizontales y métodos de diferencias finitas para el plano vertical, mientras que los modelos regionales y otros modelos globales suelen utilizar métodos de diferencias finitas para las tres dimensiones. Asimismo, los modelos regionales también pueden emplear mallas más reducidas para analizar fenómenos meteorológicos de menor escala, ya que no tienen que resolver ecuaciones para el mundo entero. Los modelos se inicializan utilizando datos observados a partir de diversas fuentes por ejemplo: radiosondas, satélites meteorológicos, aeronaves y observaciones meteorológicas en tierra. Las observaciones que están distribuidas de forma irregular se procesan por asimilación de datos y métodos de análisis objetivos que realizan un control de calidad y obtienen valores en los lugares utilizables por los algoritmos matemáticos de los modelos numéricos (generalmente dispuestos en una malla uniformemente espaciada). A continuación estos datos se usan en el modelo como punto de partida para el pronóstico. Comúnmente, el conjunto de ecuaciones usadas se conocen con el nombre de "ecuaciones primitivas". Los cálculos realizados con estas ecuaciones comienzan utilizando datos meteorológicos disponibles y determinan las tasas de cambio de las distintas variables atmosféricas. Las tasas de cambio predicen el estado de la atmósfera dentro de un breve lapso de tiempo en el futuro. A continuación se aplican las ecuaciones a este nuevo estado de la atmósfera para calcular nuevas tasas de cambio, y estas nuevas tasas de cambio predicen el estado de la atmósfera a un tiempo más distante aún en el futuro. Este procedimiento de avance mediante pequeños incrementos en el tiempo se repite de forma continua hasta que la solución alcance la predicción deseada. El lapso de tiempo de cada incremento se relaciona con la distancia entre los puntos de la malla computacional. Los pasos de tiempo en los modelos climáticos globales pueden ser 39 del orden de decenas de minutos, mientras que los pasos de tiempo utilizados en los modelos regionales pueden variar entre unos pocos segundos a varios minutos. [15] Existen varias tipos de modelos meteorológicos que se explicarán a continuación: 2.5.1 Modelo WRF El Modelo WRF (Weather Research and Forecasting) es un modelo de predicción numérica del tiempo a mesoescala diseñado para servir tanto a la predicción operativa y las necesidades de la investigación atmosférica. Cuenta con múltiples núcleos dinámicos, un sistema de asimilación de datos variacional de 3 dimensiones (3DVAR) y una arquitectura de software que permite el paralelismo computacional y la extensibilidad del sistema. WRF es adecuado para un amplio espectro de aplicaciones a través de un rango de escalas que van desde metros hasta miles de kilómetros, incluyendo: - Simulaciones idealizadas (ejemplo: LES, convecciones, ondas baroclinicas) - Aplicaciones a nivel regional y global. - Investigación parametrizada. - Investigación de datos asimilados. - Investigación de predicciones. - Tiempo real de NWP (Numerical Weather Prediction). - Investigación de Huracanes. - Aplicaciones de modelos acoplados. - Enseñanza. El esfuerzo para desarrollar WRF ha sido una asociación de cooperación, principalmente entre el National Center Atmospheric Research (NCAR), el National Centers para Environmental Prediction (NCEP) y el Forecast Systems Laboratory 40 (FSL), la Air Force Weather Agency (AFWA), la Naval Research Laboratory, la University de Oklahoma, y la Federal Aviation Administration (FAA). WRF permite a los investigadores la capacidad de realizar simulaciones que reflejan tanto la data real o configuraciones idealizadas. WRF provee un modelo de pronóstico operativo que sea flexible y eficiente computacionalmente, ofreciendo al mismo tiempo los avances en la física, avances numéricos, y la asimilación de los datos aportados por la comunidad científica. WRF cuenta con una comunidad de rápido crecimiento de usuarios, talleres y tutoriales que se llevan a cabo cada año en el NCAR. WRF se encuentra actualmente en uso operacional por la NCEP, AFWA y otros centros. [16] 2.5.2 Modelo GFS El Global Forecast System (GFS) es un modelo numérico global de predicción meteorológica a cargo de la National Oceanic y Atmospheric Administration (NOAA). Este modelo matemático se ejecuta cuatro veces al día y produce pronósticos hasta 16 días de antelación, pero con una disminución de la resolución espacial y temporal del tiempo. Luego de 7 días el pronóstico es muy general por lo que no es muy exacto, por eso la mayoría de los organismos no gubernamentales rara vez utilizan los resultados que arroja el modelo que estén más allá de los 10 días. El modelo se ejecuta en dos partes: La primera parte tiene una resolución más alta e incluye las primeras 180 horas (7 días) futuras, y la segunda parte incluye las 180 horas hasta 384 horas (16 días) en una resolución más baja. La resolución varía en cada parte del modelo: horizontalmente, se divide la superficie de la tierra en 35 o 70 kilómetros cuadrados; verticalmente, se divide la atmósfera en 64 capas y temporalmente se produce una predicción por cada 3 horas para las primeras 180 horas. 41 El GFS también es utilizado para producir estadísticas del modelo, tanto en un rango breve (cada 3 horas hasta 72 horas) como para un rango extendido (cada 12 horas hasta 8 días). Este es el único modelo mundial para el que toda la producción está disponible, gratuitamente, a través de Internet (como resultado de la ley EE.UU). [17] 2.5.3 Modelo BRAMS BRAMS (Brazilian Regional Atmospheric Modeling System) es un proyecto conjunto de Atmospheric Meteorogical y Enviroment Technologies (ATMET), Instituto de Matemática y Estadística de la Universidad de Sao Paulo (IME/USP), IAG/USP y CPTEC/INPE (Centro de Predicción del Tiempo y Estudios Climatológicos), fundado por FINEP (Financiadora de Estudios y Proyectos), que tiene como finalidad producir una nueva versión del modelo Regional Atmospheric Modeling System (RAMS) adaptado al trópico. El objetivo principal es proveer de un solo modelo a todos los centros regionales brasileros de pronóstico del tiempo. El BRAMS/RAMS es un modelo de predicción numérica diseñado para simular las circulaciones atmosféricas desde escalas hemisféricas hasta simulaciones de remolinos en la capa límite planetaria. El modelo está equipado con un esquema múltiple de mallas anidadas, el cual permite que las ecuaciones de modelo sean resueltas simultáneamente para cualquier número de mallas computacionales de diferente resolución espacial en interacción. Posee numerosas funcionalidades nuevas y parametrizaciones especializadas para los trópicos y sub-trópicos. BRAMS es un modelo de mesoescala, en estos modelos de predicción numérica del tiempo, la resolución horizontal y vertical es suficiente para pronosticar fenómenos meteorológicos de mesoescala. Dichos fenómenos, que a menudo son producto del forzamiento de la topografía, o están relacionados con la convección, presentan algunos de los mayores retos a la hora de hacer el pronóstico. Los fenómenos climáticos severos, incluidos los tornados. La visibilidad, la 42 turbulencia, el tiempo que percibimos y el estado del mar pueden variar enormemente en distancias de pocos kilómetros y sus repercusiones pueden ser enormes. Las leyes físicas del movimiento y conservación de la energía rigen el desarrollo de las condiciones atmosféricas. Dichas leyes pueden expresarse por medio de una serie de ecuaciones matemáticas complejas que componen el núcleo de lo que denominamos predicción numérica del tiempo. Debido a que se utilizan para predecir lo que sucederá en el futuro, estas ecuaciones se conocen como ecuaciones de pronóstico. Las variables de las ecuaciones representan distintos aspectos del tiempo (por ejemplo, viento, presión, etc.). Como estas ecuaciones determinan la manera en que las variables cambian con el tiempo, si conocemos el estado inicial de la atmósfera podemos resolver las ecuaciones para un momento en el futuro y obtener valores nuevos para esas variables. [18] 2.5.4 Modelo WAM El Modelo Wave Analysis Model (WAM) de generación de oleaje describe básicamente la evolución del espectro bi-dimesional de una onda oceánica. El WAM es capaz de realizar simulaciones en aguas profundas y así como en las zonas marítimas cercanas a las costas tomando en cuenta que los mejores resultados son obtenidos en áreas oceánicas con profundidades mayores a los 20 metros. Como condición de borde el modelo utiliza datos de viento provenientes de modelos meteorológicos como el GFS, MM5, WRF etc. [19] 43 3 Capitulo 3 - Descripción y Análisis del diseño En este Capítulo se detalla el diseño del Sistema de Meteomapas Interactivos (SMI). Se ofrece una visión acerca de los lineamientos seguidos para el diseño de la aplicación; desde la metodología utilizada, los requerimientos de la solución, definición y descripción de las funcionalidades principales con sus respectivos casos de usos y diagramas de secuencias. 3.1 Metodología Utilizada Para el desarrollo del Sistema de Meteomapas Interactivos (SMI), se definieron 4 etapas básicas, las cuales se describen a continuación: 3.1.1 Etapa de Análisis: Consistió en definir precisamente el objetivo general del proyecto, objetivos específicos, y cada una de las funcionalidades que se querían implementar, para lo cual se realizó un análisis del sistema SAMMET y otras páginas webs meteorológicas como la de Wunderground y WeatherChannel sacando las funciones más resaltantes de cada una para dar como resultado una interfaz que fuera lo más amigable para el usuario final. 3.1.2 Etapa de Diseño: El diseño interno del Sistema de Meteomapas Interactivos (SMI), siguió el Modelo Modelo-Vista-Controlador (MVC), para tener separadas la vistas (Interfaces Graficas de Usuario) con el núcleo de la aplicación a través de clases controladoras, con el fin de cumplir con el objetivo de proveer de una aplicación que pueda ser extendida en un futuro con facilidad, sin hacer grandes cambios a la misma. Se utilizaron diagramas de casos de uso y de secuencia para mostrar las funcionalidades del sistema. 44 3.1.3 Etapa de Implementación: La implementación se desarrolló mediante PHP[20] que es un lenguaje de programación web, utilizando el framework PHPCake[21], lo cual permitió seguir el Modelo Vista Controlador. Se utilizo PostgreSQL[22] como Base de Datos y lenguaje PERL[23] para el desarrollo del Robot. 3.1.4 Etapa de Pruebas: Las pruebas son primordiales en el desarrollo ya que permiten la validación para garantizar una aplicación correcta, eficiente, usable, etc. Esta etapa estuvo ligada a la implementación lo que facilitó la validación de cada una de las funcionalidades del sistema. 3.2 Requerimientos de la Solución Como parte fundamental del proceso de diseño de la aplicación, se incluyen a continuación una serie de requerimientos que constituyen la base del desarrollo del sistema final. Estos requerimientos se encuentran divididos en dos categorías: 3.2.1 Requerimiento de Usuario Los requerimientos se dividen en 3 módulos:  Módulo Usuario: - Consultar predicciones meteorológicas como lo son: temperatura, precipitación, dirección y velocidad del viento, humedad, temperatura del mar, oleaje, cizalladura, CAPE, índice Chandler, Altura Geopotencial, Presión a nivel del mar. - Consultar mapas satelitales como por ejemplo: nubosidad, región del Caribe, entre otros. - Consultar mapas de superficies con varias horas de predicción por ejemplo: a las 00:00, 06:00, 12:00, 18:00, y dos mapa son calculados por el CvM que se actualiza cada 45 min. 45 - Cargar todas las estaciones que están registradas en la base de datos como iconos en el mapa interactivo. - Cada estación debe mostrar las condiciones meteorológicas actuales o las últimas reportadas. - Todas estas consultas se mostrarán a través de una interfaz de Google Maps. - Consulta de los registros históricos de cada una de las estaciones meteorológicas, estos resultados se pueden mostrar en tablas como se puede mostrar en modo gráfico.  Módulo Administrador: - Manejar un registro de regiones que pueden representar a un conjunto de países. - Manejar un registro de países que pueden representar a un conjunto de estaciones meteorológicas. - Manejar un registro de estaciones meteorológicas, estas se pueden editar o eliminar posteriormente. Cada estación va a tener asociado un tipo de fuente de datos en particular. - Manera un registro de tipo de fuentes de datos nuevas, las cuales se pueden editar o eliminar.  Módulo Robot - Llevar un registro automatizado diario de cada estación meteorológica, esto se realiza cada hora diariamente. - Hacer un procesamiento en paralelo de las imágenes de predicción meteorológica que luego van a ser mostradas a través de un mapa interactivo 46 3.2.2 Requerimientos de Hardware El sistema fue desarrollado utilizando un cluster compuesto por dos maquinas cada una con Procesador Quad Core. En la primera fue utilizada como servidor web y las dos utilizadas en conjunto para la operación de tratamientos de imágenes. 3.2.3 Requerimientos de Software El sistema fue desarrollado utilizando tecnologías de uso moderno como las siguientes:  PHP 5.3, como lenguaje de programación web.  CakePHP 1.3.8, como framework de soporte para PHP.  PostgreSQL 9.0.4, como manejador de Base de Datos.  API de Google Maps V2, para la generación de mapas geográficos.[24]  Perl 5.1, como lenguaje de programación para la elaboración del robot de descarga e interpretación de datos meteorológicos.  MPICH2.0, para la ejecución en paralelo que realizará el corte de imágenes.[25]  GoogleTileCutter-0.11, script para realizar el corte de imágenes para su posterior carga en la interfaz de Google Maps.[26]  Jpgraph-3.5, para mostrar los resultados históricos de las estaciones de manera gráfica.[27]  Geo-Metar-1.15, librería para la interpretación de los METARs.[28]  Jquery-1.5, como framework de javascript para realizar cargas de páginas de manera dinámica. [29] 3.3 Diseño de las funcionalidades principales En esta Sección se explican de forma general los diagramas de Casos de Uso y Secuencia de las funcionalidades principales. 47 3.3.1 Descripción General de Casos de Usos: En la Figura 3.1 se muestra el Caso de Uso que corresponde a una visión general del Sistema de Meteomapas Interactivos (SMI). Figura 3.1 - Caso de Uso - Nivel 0 - Descripción del Sistema de Meteomapas Interactivos (SMI): Es un sistema que permite ver predicciones meteorológicas a través de la interfaz de Google Maps y consultar datos históricos de las estaciones meteorológicas. - Descripción de los actores:  Usuario: Es el usuario final que interactúa con el sistema consultando las predicciones meteorológicas.  Administrador: Es el usuario que administra las estaciones meteorológicas que se agregan a la Base de Datos y los usuarios administradores que se agregan al sistema.  Robot: Es el sistema que se encarga de registrar los datos meteorológicos que reportan las estaciones y realiza el procesamiento de imágenes para mostrar en las predicciones. En la Figura 3.2 se muestra el caso de uso (Nivel 1) exponiendo las funcionalidades macro para cada actor en el sistema. 48 Figura 3.2 - Caso de uso - Nivel 1 En la Figura 3.3 se muestra el caso de uso (Nivel 2) de las funcionalidades del usuario. Figura 3.3 - Caso de uso - Nivel 2 (Usuario) 49 A continuación se explica en detalle cada funcionalidad del Usuario: Nombre: Consultar registros de una estación meteorológica Código: 1.1 Actor: Usuario Descripción: El usuario podrá consultar las condiciones meteorológicas actuales o históricas de una estación. Precondición: El usuario tiene que haber seleccionado una estación. Postcondición: Se muestran los datos meteorológicos actuales de una estación seleccionada Flujo principal: 1. Usuario: selecciona una estación cualquiera. 2. Sistema: muestra los últimos datos meteorológicos que ha registrado la estación. 3. Usuario: puede seleccionar para ver en detalle todos los datos meteorológicos que ha registrado la estación en el día. 4. Sistema: muestra todos los datos meteorológicos registrados en el día. 5. Usuario: puede descargar estos datos en un formato csv (comma-separated values). 6. Sistema: se da la opción al usuario para descargar el archivo. 7. Usuario: se cambia el formato de resultados a un modo gráfico. 8. Sistema: muestra los resultados de manera grafica donde se pueda estudiar el comportamiento de una variable meteorológica en particular. Flujo alterno 5.1) Usuario: puede hacer una consulta de registros históricos de una estación seleccionando la fecha inicial y final que desee. 6.1) Sistema: se mostraran los resultados de los registros históricos de la estación seleccionada. 7.1) Usuario: el usuario puede descargar los datos en un formato csv. 50 Nombre: Consultar mapa de predicciones meteorológicas. Actor: Usuario Código: 1.2 Descripción: El usuario podrá consultar las predicciones meteorológicas en una región que abarca toda Centroamérica, Caribe y parte de Suramérica. Las variables que se pueden consultar son: Temperatura, Precipitación, Velocidad y dirección del Viento, Humedad, Temperatura del mar, Oleaje, Altura Geopotencial, Índice Chandler, Cizalladura, CAPE, y Presión del mar. Precondición: El usuario tiene que haber cargado la interfaz del mapa interactivo Postcondición: Dependiendo de la opción seleccionada se cargara el mapa sobre la interfaz de Google Maps y se habilitará la barra de predicción para poder observar el comportamiento del clima a futuro y dependiendo de la opción se habilitará también la opción de seleccionar el nivel de altitud del mapa. Flujo principal: 1. Usuario: selecciona una variable cualquiera de las mencionadas anteriormente. 2. Sistema: muestra la predicción meteorológicos de acuerdo a la variable seleccionada. 3. Usuario: puede cambiar la hora de la predicción a futuro a un máximo de 2 días en intervalos de 3 horas. 4. Sistema: cambia la predicción de acuerdo a la que el usuario va seleccionando. 5. Usuario: puede cambiar el nivel de altitud del mapa; en la única variable que no se encuentra habilitado esta opción es en precipitación. 6. Sistema: cambia el tipo de mapa de acuerdo a la que el usuario va seleccionando. 7. Usuario: puede cambiar el nivel de zoom hasta 3 niveles. 51 8. Sistema: el mapa se va actualizando a la medida que el usuario va cambiando. Nombre: Consultar imágenes de mapas (Satelitales, Superficies ó Descargas Eléctricas). Actor: Usuario Código: 1.3 Descripción: El usuario podrá consultar mapas satelitales como nubosidad, vapor de agua y onda corta de la región del Caribe, mapas de superficies y descargas eléctricas. Precondición: El usuario tiene que haber cargado la interfaz del mapa interactivo. Postcondición: Dependiendo de la opción seleccionada se cargara una imagen sobre la interfaz de Google Maps. Flujo principal: 1. Usuario: selecciona una variable cualquiera de las mencionadas anteriormente. 2. Sistema: carga la imagen satelital sobre el mapa. En la Figura 3.4 se muestra el caso de uso (Nivel 2) de las funcionalidades del Administrador. Figura 3.4 - Caso de uso – Nivel 2 (Administrador) 52 A continuación se explica en detalle cada funcionalidad del Administrador: Nombre: Administrar regiones Actor: Administrador Código: 2.1 Descripción: El administrador podrá consultar, crear y editar regiones. Precondición: El administrador deberá estar previamente autenticado. Postcondición: Dependiendo de la opción que consulte el administrador el sistema procederá a ejecutar la acción. Flujo principal: 1. Administrador: crea una región. 2. Sistema: almacena los datos de la nueva región y le da un mensaje al administrador que la región fue creada. Nombre: Administrar países Actor: Administrador Código: 2.2 Descripción: El administrador podrá consultar, crear y editar países. Precondición: El administrador deberá estar previamente autenticado y tiene que haber al menos una región. Cada país debe pertenecer a una región. Postcondición: Dependiendo de la opción que consulte el administrador el sistema procederá a ejecutar la acción. Flujo principal: 1. Administrador: crea un nuevo país. 2. Sistema: almacena los datos del nuevo país y le da un mensaje al administrador que el país fue creada. Flujo alterno: 1.2 Administrador: consulta un nuevo país. 2.2 Sistema: muestra los datos del país. 1.3 Administrador: selecciona un país para editar. 2.3 Sistema: carga los datos de ese país para su edición. 3.3 Administrador: realiza los cambios y procede a guardar. 4.3 Sistema: almacena los cambios realizados. 53 Nombre: Administrar estaciones Actor: Administrador Código: 2.3 Descripción: El administrador podrá consultar, crear, editar y eliminar estaciones. Precondición: El administrador deberá estar previamente autenticado y se tiene que haber creado al menos una región, un país y un tipo de formato de fuente. Cada estación debe pertenecer a un país y tener asociado un tipo de formato de fuente. Postcondición: Dependiendo de la opción que consulte el administrador el sistema procederá a ejecutar la acción. Flujo principal: 1. Administrador: crea una nueva estación. 2. Sistema: almacena los datos de la nueva estación y le da un mensaje al administrador que la estación fue creada. Flujo alterno: 1.2 Administrador: consulta una estación. 2.2 Sistema: muestra los datos de la estación. 1.3 Administrador: selecciona una estación para editar. 2.3 Sistema: carga los datos de esa estación para su edición. 3.3 Administrador: realiza los cambios y procede a guardar. 4.3 Sistema: almacena los cambios realizados. Nombre: Administrar tipo de formatos de fuentes Actor: Administrador Código: 2.4 Descripción: El administrador podrá consultar, crear, editar y eliminar tipo de formatos. Precondición: El administrador deberá estar previamente autenticado. Postcondición: Dependiendo de la opción que consulte el administrador el sistema procederá a ejecutar la acción. 54 Flujo principal: 1. Administrador: crea una tipo de formato de fuente. 2. Sistema: almacena los datos del nuevo tipo de formato de fuente y le da un mensaje al administrador que fue creado. Flujo alterno: 1.2 Administrador: consulta un tipo de formato de fuente. 2.2 Sistema: muestra los resultados. 1.3 Administrador: selecciona un tipo de formato de fuente para aaa editar. 2.3 Sistema: carga los datos para su edición. 3.3 Administrador: realiza los cambios y procede a guardar. 4.3 Sistema: almacena los cambios realizados. En la Figura 3.5 se muestra el caso de uso (Nivel 2) de las funcionalidades del robot. Figura 3.5 - Caso de uso – Nivel 2 (Robot) A continuación se explica en detalle cada funcionalidad del Robot: Nombre: Registrar datos meteorológicos Actor: Robot Código: 3.1 Descripción: El robot interpretará los datos meteorológicos que provienen de cada estación registrada en la base de datos y procederá almacenar estos datos. Esto se realizará periódicamente cada hora. Precondición: Se tiene que haber registrado al menos una estación. 55 Postcondición: Se almacenarán los datos que provienen de cada estación en caso de que se repitan el robot puede ignorarlos de tal forma de no repetir datos. Flujo principal: 1. Robot: descarga los datos meteorológicos y procede a interpretarlos. 2. Sistema: almacena estos datos meteorológicos asociados a una estación. Nombre: Procesar corte de imágenes Actor: Robot Código: 3.2 Descripción: El robot realizará un corte de las imágenes de las predicciones meteorológica asociada a cada variable para que puedan ser interpretadas por la interfaz de Google Maps. Esto se realizará después de las 12 de la noche todos los días. Precondición: Se tiene que haber descargado las imágenes de las respectivas predicciones meteorológicas de cada variable en el servidor local. Postcondición: Se procesa las imágenes y se realizan los respectivos cortes para su posterior interpretación Flujo principal: 1. Robot: ordena las imágenes provenientes de varios directorios en único directorio 2. Robot: Realiza un procesamiento y corte de las imágenes. 3. Sistema: elimina las imágenes procesadas en el día anterior y procede a almacenar las nuevas imágenes cortadas. 56 3.4 Modelos de Secuencia 3.4.1 Funcionalidades del Usuario A continuación se presentan los modelos de secuencia de las funcionalidades del usuario. En la Figura 3.6 se muestra la funcionalidad de consulta de registros de una estación meteorológica. Figura 3.6 - Consultar registros de una estación meteorológica 57 Figura 3.1 - Consultar registros de una estación meteorológica. 1. index(): el usuario inicia la carga del mapa. 2. returnMapa(): el controlador meteomapa devuelve el mapa. 3. activarEstaciones(): el usuario habilitará el menú de estaciones y cargará toda las estaciones con su respectiva información y últimos registros meteorológicos reportados por cada estación. 4. cargarListaPaises(): el controlador meteomapa cargara la lista de países almacenado en la base de datos. 5. cargarEstaciones(): el controlador meteomapa cargará todas las estaciones almacenadas en la bases de datos. 6. cargarRegistrosEstaciones(): el controlador meteomapa cargará todos los registros meteorológicos de cada estación almacenadas en la base de datos. 7. cargarModelo(): el controlador países carga el modelo países. 8. cargarModelo(): el controlador estaciones carga el modelo estaciones. 9. cargarModelo(): el controlador registros carga el modelo registros. 10. returnModelo(): el modelo estaciones devuelve el modelo al controlador estaciones. 58 11. returnModelo(): el modelo países devuelve el modelo al controlador países. 12. returnModelo(): el modelo registros devuelve el modelo al controlador registros. 13. returnRegistrosEstación(): el controlador registros devuelve la lista de estaciones con sus registros meteorológicos al controlador meteomapa. 14. returnEstaciones(): el controlador estaciones devuelve la lista de estaciones con su respectiva información al controlador meteomapa. 15. returnPaises(): el contralador paises devuelve la lista al controlador meteomapa. 16. returnRegistrosEstación(): el controlador meteomapa devuelve la lista de estaciones con sus registros meteorológicos a la interfaz de usuario. 17. returnEstaciones(): el controlador meteomapa devuelve la lista de estaciones con su respectiva información a la interfaz de usuario. 18. returnPaises(): el controlador meteomapa devuelve la lista de países a la interfaz de usuario. 19. seleccionaPaís(id): el usuario selecciona un país pasando como argumento el identificador del país. 20. cargarListaEstaciones(id): el controlador meteomapa cargará la lista de estaciones que se encuentren en un país pasando como el identificador del país. 21. cargarModelo(): el controlador estaciones carga el modelo estaciones. 22. returnModelo(): se devuelve el modelo estaciones al controlador estaciones. 23. returnListaEstaciones(): se devuelve la lista de estaciones al controlador meteomapa. 24. returnListaEstaciones(): se devuelve la lista de estaciones a la interfaz de usuario. 25. seleccionaEstación(id): el usuario selecciona una estación pasando como argumento el identificador de la estación. 26. returnEstacion(): devuelve los datos informativos de la estación. 59 27. returnRegistrosEstacion(): se devuelve los últimos datos meteorológicos de la estación seleccionada. 28. consultarDetallesRegistros(id): el usuario selecciona consultar detalles de una estación meteorológica pasando como argumento el identificador de la estación. 29. cargarModelo(): el controlador registros carga el modelo registros. 30. returnModelo(): devuelve el modelo registros al controlador registros. 31. returnDetallesRegistros(): devuelve todos los registros de una estación meteorológica que se han almacenado en el día actual. 32. descargarRegistros(): el usuario selecciona descargar registros de una estación meteorológica y se crea un archivo con todos los registros de la consulta que el usuario hizo previamente. 33. cargarModelo(): el controlador registros carga el modelo registros. 34. returnModelo(): devuelve el modelo registros al controlador registros. 35. returnArchivo(): el controlador registros devuelve un archivo en formato CSV a la interfaz de usuario para su posterior descarga. 36. activarModoGrafico(): el usuario cambia el modo como se ven los resultados a un modo gráfico para observar el comportamiento de una variable. 37. cargarModelo(): el controlador registros carga el modelo registros. 38. returnModelo(): devuelve el modelo registros al controlador registros. 39. returnGraficos(): el controlador registros devuelve la consulta realizada anteriormente en forma de gráfico. 40. consultarRegistrosHistoricos(fechaInicio, fechaFinal): el usuario selecciona una fecha de inicio y una fecha final para hacer una consulta histórica de los registros de una estación. 41. cargarModelo(): el controlador registros carga el modelo registros. 42. returnModelo(): devuelve el modelo registros al controlador modelo. 43. returnRegistrosHistoricos(): devuelve el listado desde la fecha de inicio hasta la fecha final de los registros meteorológicos que se ha almacenado en la base de datos. 60 A continuación en la Figura 3.7 se muestra el modelo de secuencia de consultar mapas de predicción meteorológica: Figura 3.7 - Consultar mapas de predicción meteorológica 1. index(): el usuario inicia la carga del mapa. 2. returnMapa(): el controlador meteomapa devuelve el mapa a la interfaz de usuario. 3. consultarMapaPredicción(var): el usuario selecciona una variable que puede ser: Temperatura, precipitación, viento, oleaje, humedad relativa, cizalladura, CAPE, índice Chandler y temperatura del mar. Se pasa como argumento el valor de la variable. 4. returnMapaPredicción(): el controlador meteomapa devuelve el mapa de acuerdo a la opción seleccionada. 5. cambiarHoraPredicción(t): el usuario puede cambiar la hora de predicción a futuro, esta predicción será en intervalos de 3 horas y puede ser hasta 2 días a partir del día inicial que se hizo el cálculo. Se pasa como argumento el valor de la hora de la predicción. 61 6. returnMapa(): el controlador meteomapa devuelve el mapa de acuerdo a la opción seleccionada. 7. cambiarNivelAltitudMapa(alt): el usuario puede cambiar el nivel de altitud del mapa, se presentan 4 valores: SFC que es a nivel de superficie, 850 hPa que es a unos 1500 metros de altura, 500 hPa que es a unos 5000 metros de altura y 250 hPa que es a uno 10300 metros de altura. Se pasa como argumento el valor de la altitud seleccionada. Esta opción no se encontrará habilitada para la variable Precipitación. 8. returnMapa(): el controlador meteomapa devuelve el mapa de acuerdo a la opción seleccionada. A continuación en la Figura 3.8 se muestra el modelo de secuencia de consultar mapas satelitales: 1. index(): el usuario inicia la carga del mapa. 2. returnMapa(): el controlador meteomapa devuelve el mapa a la interfaz de usuario. 3. consultarMapaSatelital(var): el usuario selecciona una mapa satelital que puede ser de tipo 3.4.2 Funcionalidades del administrador A continuación en la Figura 3.9, se presentan el modelo de secuencia de la funcionalidad del administrador más representativa. Figura 3.8 - Consultar imágenes de mapas 62 Figura 3.9 - Administrar estaciones meteorológicas 1. Autenticar(): el usuario se autentica en el sistema. 2. cargarModelo(): el controlador usuario carga el modelo usuario. 3. returnModelo(): devuelve el modelo usuario al controlador usuario. 4. validarUsuario(): el controlador usuario valida que los datos sean los correctos. 5. returnUsuario(): si el usuario es válido, se dará un mensaje de bienvenida y entrará al modulo de administrador, si el usuario es incorrecto se le denegará el acceso. 63 6. crearEstación(): el usuario llena un formulario para agregar una estación nueva al sistema. 7. cargarModelo(): el controlador estaciones carga el modelo de estaciones. 8. returnModelo(): devuelve el modelo estaciones al controlador estaciones. 9. guardarEstación(): si todos los datos son correctos el controlador estaciones guarda la nueva estación. 10. returnOk(): el controlador estaciones devuelve un mensaje que se guardo la nueva estación. 11. consultarEstación(id): el usuario consulta la información de una estación almacenada. Se pasa como argumento el identificador de la estación. 12. cargarModelo(): el controlador estaciones carga el modelo de estaciones. 13. returnModelo(): devuelve el modelo estaciones al controlador estaciones. 14. returnEstación(): el controlador estaciones devuelve toda la información de la estación consultada a la interfaz de usuario. 15. editarEstación(id): el usuario selecciona una estación para editar pasando como argumento el identificador de la estación. 16. cargarModelo(): el controlador estaciones carga el modelo de estaciones. 17. returnModelo(): devuelve el modelo estaciones al controlador estaciones. 18. returnEstación(): el controlador estaciones devuelve los datos de la estación a editar a la interfaz de usuario. 19. guardarEstación(): el usuario realiza los cambios necesarios y selecciona guardar estación. 20. cargarModelo(): el controlador estaciones carga el modelo de estaciones. 21. returnModelo(): devuelve el modelo estaciones al controlador estaciones. 22. guardarCambios(): el controlador estaciones guarda los cambios de la estación. 23. returnOk(): el controlador estaciones devuelve un mensaje de que los cambios se realizaron de manera correctamente. 24. borrarEstación(id): el usuario selecciona una estación para eliminarla de la base de datos, se pasa como argumento el identificador de la estación. 25. cargarModelo(): el controlador estaciones carga el modelo de estaciones. 26. returnModelo(): devuelve el modelo estaciones al controlador estaciones. 27. returnOk(): devuelve un mensaje al usuario que la estación fue borrada correctamente. 64 3.5 Diagramas de flujos A continuación se explican las funcionalidades del robot a través de diagramas de flujos. 3.5.1 Funcionalidades del robot En la Figura 3.10 se presenta un diagrama de flujo del proceso de registrar datos meteorológicos. Figura 3.10 - Registrar datos meteorológicos El proceso de registrar datos meteorológicos se ejecuta cada media hora en el servidor y pasa por los siguientes pasos. Buy SmartDraw!- purchased copies print this document without a watermark . Visit www.smartdraw.com or call 1-800-768-3729. 65 1. Consultar listas de estaciones: se hace una consulta a la base de datos de todas las estaciones registradas y solo se van a tomar las que se encuentren con estatus “activo”, es decir, que la estación se encuentre operativa. En esta consulta solo se va a tomar el url de la ubicación web o la dirección del directorio local donde la estación este publicando sus resultados meteorológicos. 2. Descargar datos meteorológicos: teniendo la lista de estaciones meteorológicas se procede hacer un ciclo donde se va consultando la ubicación de cada estación para la descarga de los datos meteorológicos. Esta ubicación puede ser vía Web o local en el servidor donde se está ejecutando el robot. 3. Interpretar datos: una vez descargados los datos meteorológicos ya sea en un formato como METARs o un archivo del tipo ClientRaw o Realtime se procede a interpretar cada campo y se obtienen los valores de las variables meteorológicas persistentes, por ejemplo: variables de temperatura, punto de rocío, dirección del viento, velocidad del viento, humedad relativa, presión atmosférica, la hora y fecha local, entre otros. Antes de pasar al siguiente paso se verifica la hora y fecha reportada con la última registrada por parte de la estación, si estas dos son iguales entonces se procede a ignorar el registro y se pasa a la siguiente estación. Sí son diferentes se pasa al siguiente paso. 4. Almacenar datos meteorológicos: luego que se han interpretado los datos de los archivos o de los METARs, se procede a almacenar en la base de datos asociado a una estación meteorológica. Posteriormente se verifica si hay mas estaciones por revisar, sí todavía quedan se repite el ciclo. Si no el robot termina sus operaciones. En la Figura 3.11 se presenta un diagrama de flujo del proceso de corte de imágenes de predicción meteorológica. 66 Figura 3.11 - Procesar corte de imágenes El proceso de corte imágenes se ejecuta 24 horas a las 12 de la noche en el servidor y pasa por los siguientes pasos. 1. Organizar imágenes de predicción: Se seleccionan todas las imágenes de predicción meteorológica descargadas que se encuentran en diferentes directorios en el servidor local y se copian en un único directorio. 2. Realizar corte de imágenes: Se calcula cuántas imágenes hay en el directorio y teniendo el número total de imágenes, se distribuyen en el número de máquinas que se encuentren disponibles, en este caso solo se cuenta con dos servidores para ejecutar el robot en paralelo. Luego que cada máquina tiene el número de imágenes que le corresponde, cada una va a ejecutar el script GoogleTileCutter para hacer el corte de imágenes a cada una. 3. Almacenar imágenes resultantes: Luego que cada uno ha realizado el corte a cada imagen que le ha correspondido, se copiarán las imágenes resultantes en otro directorio donde posteriormente serán accedidas por el servidor cuando sea consultado a través del mapa interactivo cierta variable como: Temperatura, precipitación, viento, humedad relativa, oleaje, cizalladura, Índice Chandler y CAPE. Luego que se termine este proceso con todas las imágenes de predicción se dará por finalizado la ejecución del robot. Buy SmartDraw!- purchased copies print this document without a watermark . Visit www.smartdraw.com or call 1-800-768-3729. 67 4 Capitulo 4 - Desarrollo de la solución A continuación se presenta la solución del Sistema de Meteomapas Interactivos, en una primera parte el modelo Entidad/Relación de la Base de datos que se implementó para llevar el registro de datos meteorológicos provenientes de las estaciones meteorológicas y cada unos de los módulos que componen el sistema. 4.1 Diagrama de Entidad/Relación A continuación en la Figura 4.1 se presenta el diagrama de Entidad/Relación de la Base de Datos. Figura 4.1 - Modelo Entidad/Relación 68 En el modelo Entidad/Relación, tenemos una tabla llamada regiones donde se almacena el nombre y la descripción, una región puede tener un conjunto de países, en la tabla países se almacena también el nombre y una breve descripción. Adicionalmente cada país puede contener un conjunto de estaciones meteorológicas, donde en la tabla estaciones será necesario guardar la fecha cuando se guardo la estación, el nombre, la localidad, el estado y el país donde se encuentre ubicada esta estación; un código sinóptico particular de cada estación, no todas lo tienen; un código METAR que identifica a cada estación en el mundo que este reportando en formato METAR, sino reporta en este tipo de formato se deja vacío; la latitud y longitud para su posterior ubicación en el mapa geográfico; la altura sobre el nivel del mar, un estatus para indicar si la estación esta activa o inactiva, una ruta de acceso a los datos, está puede ser un url a un recurso Web o una dirección a un directorio en el servidor local; un tipo de fuente que puede ser formato METAR ó archivos del tipo ClientRaw.txt o Realtime.txt; comentarios que se quieran añadir a la estación; la zona horaria en donde se encuentra la estación y por último el identificador del usuario en el sistema que la agrego a la base de datos. Se tiene una tabla llamada “registros” y “registros de los archivos”, que va a estar asociada a la tabla de estación, la única diferencia entre estas dos tablas es que la segunda va a almacenar, la temperatura del suelo, la cantidad de lluvia diaria y la tasa de lluvia en el día, de resto se guardan la fecha y hora que reportó la estación en su respectivo formato; la fecha y hora del momento en la que se está creando el registro; adicionalmente se guardan una serie de datos meteorológicos que no necesariamente se tienen que tener todos los valores, entre ellos tenemos: Temperatura y punto de rocío tanto en grados Celsius como en Fahrenheit; dirección del viento expresado en grados como en letra; velocidad del viento que puede ser consultado en nudos, millas por hora o en kilómetros por hora; humedad relativa que está expresada en porcentaje; presión atmosférica que está en milibares o en hectopascales; ráfagas que son almacenadas en nudos; y por último la condición del tiempo que expresa una breve descripción de cómo está el tiempo actual. Cada registro que se ingresa a la 69 Base de Datos va a tener asociado a un registro de la tabla de “datos sólidos” y “datos sólidos de los archivos” donde se va almacenar el METAR ó el archivo ClientRaw.txt ó Realtime.txt sin interpretar, es decir los datos tal cual como se descargaron en el servidor. Además se tiene una tabla llamada “últimos registros” y “últimos registros de los archivos”, como su nombre lo indican llevará el registro del último reporte que haya transmitido una estación, esto va a ser muy útil para cuando se haga la consulta de cuáles son las condiciones actuales de una estación meteorológica. Aunque las dos tablas de “registros” y “registros de los archivos” sólo difieren en pocos campos, se prefirió separarse porque se iban a presentar muchos campos vacios ya que unos no se encuentran en un formato con respecto al otro. De esta forma si se agrega un nuevo formato de archivo con nuevas variables no se tendría que alterar las tablas ya creadas sino que se crearía una tabla nueva para ese formato en particular. 4.2 Módulo de Usuario El usuario accede al Sistema de Meteomapas Interactivos (SMI) a través del siguiente url: http://met.ivic.gob.ve/sammeti/meteomapa, y se carga la siguiente página como se muestra en la Figura 4.2. Imagen 4.1 - Pagina inicial del Sistema de Meteomapas Interactivos (SMI) Figura 4.2 - Pagina inicial del Sistema de Meteomapas Interactivos (SMI) http://met.ivic.gob.ve/sammeti/meteomapa 70 Cabe destacar que cuando el usuario carga la pagina principal, el navegador le va a pedir un permiso al usuario si quiere que se registre la geolocalización que consiste en rastrear la ubicación de donde se está conectando el usuario como se muestra en la Figura 4.3. Figura 4.3 - Solicitud de geolocalización al usuario Se utilizó la geolocalización para cargar el mapa lo más cercano de donde se encuentre la persona. Se obtienen la latitud y longitud, en la Figura 4.4, se puede observar el código que realiza esta función. Figura 4.4 - Código Javascript de geolocalización Luego con los valores obtenidos anteriormente, pueden ser usadas para cargar donde se va a iniciar el mapa. En la Figura 4.5 se puede observar el código que carga el mapa. 71 Figura 4.5 - Código Javascript de carga de inicio del mapa Continuamos con el mapa, en la parte superior se tiene un menú con una serie de opciones, comenzaremos con la opción de “estaciones”. Luego que el usuario la active, automáticamente se cargarán todas las estaciones que se encuentran en la base de datos, de forma de iconos, donde cada uno va a tener un color y un número que va a variar de acuerdo a la temperatura que este registrando esa estación en ese momento. En la Figura 4.6 se muestra una porción del mapa con las estaciones cargadas en esa región. Adicionalmente se habilita un menú para poder hacer la consulta de las estaciones por país. Figura 4.6 - Iconos de las estaciones cargadas en el mapa 72 Luego se puede seleccionar un país del menú que se tiene en la parte inferior derecha y automáticamente se carga una lista de estaciones asociadas a ese país y se muestra un marco informativo que contiene las condiciones del tiempo actuales al momento de seleccionar un estación o dando click sobre un icono. En la Figura 4.7 se muestra un ejemplo. En este cuadro informativo se muestran los datos de la estación como el nombre y el estado donde se encuentra, así como la ultima que esta realizo un reporte, entre los datos se consiguen, la hora y fecha, temperatura, punto de rocío, dirección del viento, velocidad del viento, humedad relativa y presión atmosférica. En el nombre de la estación se tiene un enlace para consultar los datos meteorológicos que ha reportado en más detalle, es decir, muestra todos los datos que ha reportado en el día. En la Figura 4.8 se muestra un ejemplo. Figura 4.7 - Marco informativo de la condición actual de una estación meteorológica 73 Figura 4.8 - Registro del día de una estación meteorológica En esta pantalla el usuario puede consultar los datos históricos de una estación desde que se empezó almacenar en el servidor hasta la fecha actual, por ejemplo se puede consultar desde una fecha inicial hasta una fecha final y se cargan los resultados después de dar click sobre el botón mostrar cómo se muestran en la Figura 4.9. Figura 4.9 - Registro histórico de una estación meteorológica 74 Se pueden hacer descargar de las consultas realizadas mostrándolo en un formato csv como se muestra en la Figura 4.10. Figura 4.10 - Formato del archivo de descarga Adicionalmente se pueden ver los resultados en un modo gráfico como se ve en la Figura 4.11. Figura 4.11 - Grafico de temperatura De manera predeterminada se muestra el gráfico de la temperatura pero adicionalmente se pueden observar las variables de punto de rocío, viento, humedad relativa y presión atmosférica. Para la realización de estos gráficos fue necesario el uso de las librerías de Jpgraph-3.5. 75 Volviendo al mapa principal, en el menú que se tiene en la parte superior, el usuario puede seleccionar cualquier predicción meteorológica entre ellas se tienen: temperatura, precipitación, viento, oleaje, temperatura del mar, humedad relativa, CAPE y cizalladura, todas estas predicciones fueron calculadas previamente por el modelo meteorológico GFS, con un tiempo de predicción a 2 días. Si selecciona la opción “temperatura” automáticamente se cargará un mapa de predicción sobre la interfaz de Google Maps y se mostrará como en la Figura 4.12. Figura 4.12 - Mapa de predicción de temperatura Podemos observar que se carga el mapa de predicción para la temperatura, además de una barra para cambiar la hora de predicción que irá cambiando en intervalos de 3 horas hasta un máximo de dos días, una caja de selección para cambiar el nivel de altitud, una barra para cambiar el contraste del mapa y una barra de tonalidades de colores que nos indica que la temperatura puede variar en esta región desde los 15 grados Celsius hasta 33 grados Celsius. 76 Cuando se inicia el día, se toma como el tiempo 0, las 8:30am del día 0. A partir de esta hora se puede consultar la predicción hasta las 8:30am del día 2. A la medida que el día este transcurriendo se mostrará la predicción más cercana a la hora en que se esté consultando, por ejemplo: sí son las 14:00 se mostrará la predicción de las 11:30, ahora sí son las 15:00 se cargará el mapa de predicción de las 14:30 y así sucesivamente. En el momento en que sean las 8:30 del día 1, el mapa de predicción habrá cambiado a uno nuevo porque en el servidor ya se ha realizado una nueva predicción por lo tanto las nuevas imágenes se sustituyen por las viejas. Se puede decir que el día se vuelve a reiniciar al día 0. El usuario puede cambiar la hora de predicción como se muestra en la Figura 4.13. Figura 4.13 - Cambio de la hora de predicción El usuario puede quitar la opción de estaciones dando click de nuevo sobre la opción de estaciones, posteriormente todos los iconos agregados previamente se vuelven a quitar. Ente los niveles de altitud que se pueden cambiar son: a nivel de superficie, 850 Hpa, 500 Hpa y 250 Hpa. Por ejemplo seleccionamos 500 Hpa y cambia automáticamente el tipo de mapa como la barra de mediciones como se muestra en la Figura 4.14. 77 Siguiendo con la interfaz de usuario se puede seleccionar la opción de Precipitación que a continuación se cargará la predicción meteorológica como se muestra en la Figura 4.15, en esta opción se habilitará solo la barra de predicción, no se encuentran disponibles mapas de varios niveles de altitud, el mapa que se carga es de nivel de superficie. Figura 4.15 - Mapa de precipitación de Nivel 6 de zoom Figura 4.14 - Mapa de temperatura a un nivel de 500 Hpa 78 El usuario puede disminuir el nivel de zoom a 5, cargando el siguiente mapa que se muestra en la Figura 4.16. Se puede continuar disminuyendo el nivel de zoom hasta el nivel 4 como se muestra en la Figura 4.17, si se continúa disminuyendo el nivel de zoom menor a 4 ya no cargará mas imágenes, igualmente si el zoom se aumenta a un valor mayor a 6 tampoco se cargarán imágenes ya que no se encuentran disponibles para ese nivel de zoom. Figura 4.17 - Mapa de precipitación de Nivel 4 de zoom Figura 4.16 - Mapa de precipitación de Nivel 6 de zoom 79 Siguiendo en la interfaz de usuario, el usuario puede seleccionar la opción de viento, a medida que el usuario va cambiando de variable se desactiva la anterior para que así de esta manera no haya un solapamiento de imágenes. En la Figura 4.18, se muestra el mapa de predicción del viento. Figura 4.18 - Mapa de predicción de viento En este mapa se tiene la barra de predicción, la opción para cambiar los niveles de altitud entre las opciones que se tienen son: a nivel de superficie (SFC), 850 Hpa, 500 Hpa y 250 Hpa, la barra de colores que indica las métricas para este mapa y los vecotores que indican la dirección del viento. Continuando con las opciones, el usuario puede cargar una imagen de satélite que representa la nubosidad que se encuentra actualmente en la región del Caribe y Centroamerica, esta imagen es cargada directamente desde la página http://www.ssd.noaa.gov/goes/east/tatl/vis.jpg, esta imagen es actualizada cada 5 minutos. En la Figura 4.19, se muestra un ejemplo luego de que se selecciona esta opción. http://www.ssd.noaa.gov/goes/east/tatl/vis.jpg 80 Figura 4.19 - Nubosidad sobre el área del Caribe y Centroamérica Siguiendo con la interfaz de usuario, se puede seleccionar la opción de oleaje donde se cargará el siguiente mapa que se muestra en la Figura 4.20. Este mapa de predicción fue generado en base del modelo WAM. Figura 4.20 - Mapa de predicción del oleaje 81 En este mapa se habilitará la barra de predicción junto con la barra de colores que indica las métricas asociadas a este mapa y los vectores que indican la dirección del oleaje, no se encuentra habilitado la opción de cambio de niveles de altitud de este mapa. En la siguiente opción de descargas eléctricas permitirá visualizar una imagen de las descargas eléctricas originadas sobre el área de los Altos Mirandinos y sus adyacencias como se muestra en la Figura 4.21. Es importante destacar que esta imagen es generada por el CvM cada 45 minutos. Esta imagen se puede descargar de la siguiente dirección: http://met.ivic.gob.ve/pipe/nxscreen.jpg. Figura 4.21 - Descargas eléctricas Continuando con la interfaz de usuario se tienen más opciones que están de manera oculta, si se da click sobre la opción “más (9)…”, el nueve (9) indica que hay 9 opciones adicionales, entre las primeras opciones tenemos: temperatura a nivel del mar, humedad relativa, CAPE, Cizalladura, Indice de Chandler, Altura Geopotencial y Presión a nivel del mar. Sí se selecciona la opción de temperatura a nivel del mar se podrá visualizar el siguiente mapa de predicción como se muestra en la Figura 4.22. http://met.ivic.gob.ve/pipe/nxscreen.jpg 82 Figura 4.22 - Mapa de predicción de temperatura a nivel del mar Continuando con las opciones adicionales, se puede seleccionar la opción de humedad como se muestra en la Figura 4.23. Figura 4.23 - Mapa de predicción de humedad relativa 83 Al seleccionar humedad, se encuentra habilitado la barra de predicción y las opciones para cambiar el nivel de altitud del mapa, así como la barra de colores de métricas. Continuando, si se selecciona la opción de CAPE, se puede visualizar el siguiente mapa de predicción como se muestra en la Figura 4.24. Figura 4.24 - Mapa de predicción de CAPE En este mapa se encuentra habilitada las mismas opciones de los anteriores exceptuando la opción para cambiar el nivel de altitud del mapa. Siguiendo con la siguiente opción de Cizalladura, se podrá visualizar el siguiente mapa que se muestra en la Figura 4.25, entre las opciones que se tienen son la barra de predicción y la opción para cambiar el nivel de altitud pero a diferencia de las opciones anteriores sólo está disponible: 850 Hpa, 500 Hpa y 250 Hpa. 84 Figura 4.25 - Mapa de predicción de Cizalladura Luego, sí se cambia de opción a Índice de Chandler se cargará el siguiente mapa de predicción meteorológica, que se muestra en la Figura 4.26. Figura 4.26 - Mapa de predicción de Índice de Chandler 85 La opción de Índice de Chandler no tendrá habilitado la opción para cambiar los niveles de altitud. Luego, sí se cambia de opción a Altura geopotencial, se cargara el siguiente mapa, que se muestra en la Figura 4.27. Figura 4.27 - Mapa de Altura geopotencial Posteriormente, sí se cambia de opción a Presión a nivel del mar, se cargará el siguiente mapa, que se muestra en la Figura 4.28. Figura 4.28 - Mapa de Presión a nivel del mar 86 En la sección de mapas de satelitales, se encuentran disponibles 4 opciones adicionales, una de ella es la opción del mapa Vapor de agua para la región del Caribe, este mapa es descargado desde el siguiente enlace http://www.ssd.noaa.gov/goes/east/tatl/wv.jpg, este mapa es actualizado cada 5 minutos por la NOAA. En la Figura 4.29, se muestra un ejemplo. Figura 4.29 - Vapor de agua para la región del Caribe La siguiente opción de mapa satelital de Onda corta para la región del Caribe, se muestra en la siguiente Figura 4.30. Figura 4.30 - Mapa satelital de Onda corta para la región del Caribe http://www.ssd.noaa.gov/goes/east/tatl/wv.jpg 87 Este mapa satelital de onda corta puede ser descargado desde el siguiente enlace: http://www.ssd.noaa.gov/goes/east/tatl/ir2.jpg. Al momento de seleccionar el mapa TRMM que corresponde a la Misión de Medición de Lluvias tropicales, este mapa muestra las mediciones de las últimas 3 horas. Como se muestra en la Figura 4.31. Este mapa puede ser descargado desde el siguiente enlace: http://trmm.gsfc.nasa.gov/trmm_rain/americas/americas_3hrly_zoom.gif Figura 4.31 - Mapa satelital TRMM En la siguiente opción se puede seleccionar el mapa satelital SST, que permitirá visualizar las temperaturas superficiales del mar, como se muestra en la Figura 4.32. Este mapa es descargado desde el siguiente enlace: http://www.ssec.wisc.edu/data/sst/latest_sst_nomap.gif http://www.ssd.noaa.gov/goes/east/tatl/ir2.jpg http://trmm.gsfc.nasa.gov/trmm_rain/americas/americas_3hrly_zoom.gif http://www.ssec.wisc.edu/data/sst/latest_sst_nomap.gif 88 Figura 4.32 - Mapa Satelitales SST Siguiendo con la siguiente sección de mapas de superficies, se encuentran disponibles 6 opciones adicionales. Los primeros 4 mapas de superficies son predicciones que hace la NOAA para el día que comienza, el primero para las 00:00 horas como se muestra en la Figura 4.33. Este mapa puede ser descargado del siguiente enlace: http://www.nhc.noaa.gov/tafb/ATSA_00Z.gif Figura 4.33 - Mapa de superficie para las 00:00 horas http://www.nhc.noaa.gov/tafb/ATSA_00Z.gif 89 Se puede seleccionar el mapa de superficie para las 06:00 horas, como se muestra en la Figura 4.34, esta imagen es descargada del siguiente enlace: http://www.nhc.noaa.gov/tafb/ATSA_06Z.gif. Figura 4.34 - Mapa de superficie para las 06:00 horas El siguiente mapa de superficie correspondiente para las 12:00 horas, como se muestra en la Figura 4.35, esta imagen es descargada del siguiente enlace: http://www.nhc.noaa.gov/tafb/ATSA_12Z.gif. Figura 4.35 - Mapa de superficie para las 12:00 horas http://www.nhc.noaa.gov/tafb/ATSA_06Z.gif http://www.nhc.noaa.gov/tafb/ATSA_12Z.gif 90 El siguiente mapa de superficie correspondiente para las 18:00 horas, como se muestra en la Figura 4.36, esta imagen es descargada del siguiente enlace: http://www.nhc.noaa.gov/tafb/ATSA_18Z.gif. Figura 4.36 - Mapa de superficie para las 18:00 horas La siguiente opción del mapa de superficie con las variables de Temperatura-Viento- Presión, este mapa es generado por el CvM, como se muestra en la Figura 4.37. Figura 4.37 - Mapa de superficie de Temperatura-Viento-Presión http://www.nhc.noaa.gov/tafb/ATSA_18Z.gif 91 Y por último la opción de mapa de superficie con las variables de Precipitación- Humedad Relativa, este mapa también es generado por el CvM, como se muestra en la Figura 4.38. Figura 4.38 - Mapa de superficie de Precipitación-Humedad Relativa 4.3 Módulo de Administrador El modulo de administración del Sistema de Meteomapas Interactivos (SMI), permitirá llevar un registro de las nuevas estaciones meteorológicas que se agreguen a la Base de Datos, donde cada estación debe pertenecer a un país y a su vez un país debe pertenecer a una región. Adicionalmente cada estación tendrá asociado un tipo de fuente de donde se va a descargar los datos meteorológicos. Para poder realizar todas estas funcionalidades es necesario que el usuario este autenticado y autorizado por la Unidad de Meteorología y el CvM. El usuario puede acceder a la interfaz de ingreso a través del siguiente link http://met.ivic.gob.ve/sammeti/users como se muestra en la Figura 4.39: http://met.ivic.gob.ve/sammeti/users 92 Figura 4.39 - Interfaz de ingreso Luego que se ha autenticado el usuario, ingresa al modulo de administración del Sistema de Meteomapas interactivos donde podrá administrar regiones, países, estaciones y tipo de fuentes. Se le dará un mensaje de bienvenida y un link para cerrar la sesión, como se muestra en la Figura 4.40. Figura 4.40 - Interfaz del modulo de administrador Luego el usuario puede seleccionar la funcionalidad de administrar regiones, donde le aparecerán todas las regiones agregadas en la Base de Datos, con su respectivo ID, 93 Nombre, Descripción y las acciones que puede crear, editar o eliminar esta región. Cabe resaltar que una región puede contener varios países. En la Figura 4.41 se muestra un ejemplo de esta funcionalidad. Figura 4.41 - Interfaz de administrar regiones Posteriormente, el usuario puede seleccionar la funcionalidad de administrar países donde puede crear, editar o eliminar países, como se muestra en la Figura 4.42. Figura 4.42 - Interfaz de administrar países 94 En la funcionalidad de administrar estaciones, el usuario puede agregar, consultar detalles, editar o eliminar estaciones, actualmente se tienen almacenadas 346 estaciones por lo que se todas se muestran en forma paginada, se puede cambiar de páginas desde la primera hasta la última con las flechas que se tienen en la parte inferior, como también se pueden ordenar todas las estaciones de acuerdo al ID, nombre, localidad, estado o país. En la Figura 4.43 se muestra un ejemplo de esta funcionalidad. Figura 4.43 - Interfaz de administrar países Además el usuario puede administrar los tipos de fuentes de datos meteorológicas donde posteriormente se va a consultar los datos que reportan las estaciones meteorológicas, cada estación va a estar asociada a un tipo de fuente de datos. En la Figura 4.44, se muestra esta funcionalidad. 95 Figura 4.44 - Interfaz de administrar tipo de fuentes de datos meteorológicas Volviendo a la funcionalidad de Administrar estaciones, el usuario puede agregar una estación nueva a la Base de Datos, le da click sobre el botón de crear estación y se mostrará una ventana como se muestra en la Figura 4.45 y Figura 4.46, donde se solicitan los datos de la estación como: - Nombre, - Localidad donde se encuentre ubicada, - Estado, - País, - El indicativo sinóptico que también es opcional, - Código METAR en caso que la estación reporte en forma METAR si es otro tipo de estación se puede omitir este campo, - Latitud, - Longitud, - Altura sobre el nivel mar, - Estatus en el que se encuentra actualmente esa estación, 96 - La ruta de la fuente de datos que puede ser un url a una dirección web o una ruta a un directorio del servidor local, - El tipo de fuente si son METARs, archivos Realtime ó Clientraw, - Comentarios, pueden ser opcionales. - Zona horaria. Figura 4.45 - Interfaz de agregar una estación nueva (I parte) Figura 4.46 - Interfaz de agregar una estación nueva (II parte) 97 Adicionalmente se pueden consultar los detalles de cada estación, por cuestiones de espacio, inicialmente solo se muestra el ID, nombre, localidad, estado y país, si se da click sobre el ID de la estación se cargan todos los datos referentes a esa estación en un ventana emergente como se muestra en la Figura 4.47. Figura 4.47 - Interfaz de ver detalles de una estación Entre las acciones adicionales que se tienen se puede editar o eliminar una estación, si selecciona la opción eliminar se muestra un mensaje de confirmación como en la Figura 4.48. Figura 4.48 - Mensaje de confirmación para eliminar una estación 98 El administrador puede editar una estación cambiando cualquier campo que desee, se mostrara una ventana con todos los datos de la estación cargados en un formulario, como se muestra en la Figura 4.49. Figura 4.49 - Interfaz para editar estación Las opciones de agregar, editar o eliminar, se aplican en las 4 funcionalidades de Administrar regiones, países, estaciones y tipo de fuentes. 4.4 Modulo del Robot El modulo de Robot del Sistema de Meteomapas Interactivos (SMI), consiste en dos procesos, el primer proceso es el encargado de llevar el registro de los reportes de las estaciones meteorológicas provenientes de los aeropuertos y de la red MeteoVen. Una subproceso se ejecuta cada media hora y extrae desde la Base de Datos la lista de estaciones meteorológicas que reportan en formato METAR, de esta lista se toma el url que va a ser http://weather.noaa.gov/mgetmetar.php?cccc=<code_metar>, donde el code_metar es el identificador, se hace una consulta http a la página de la NOAA y http://weather.noaa.gov/mgetmetar.php?cccc=%3ccode_metar 99 se descarga todo el html, este es procesado y solo se extrae el formato del METAR, luego usando las librerías de GeoMetar, se obtienen los datos meteorológicos que reportó esta estación para su posterior almacenamiento en la Base de Datos, adicionalmente se guarda los datos crudos que sería el formato sin interpretar como se transmitió y se actualiza una tabla que guardará los últimos datos reportados por una estación. Esto será de mucha ayuda para mostrar el estado del tiempo de una estación en particular en la interfaz de Google Maps. Antes de guardar un reporte se verificará si anteriormente ya fue almacenado de esta manera se evitarán datos repetidos. En el caso de las estaciones de la red MeteoVen que reportan en un formato distinto al METAR, se lee un archivo que puede ser de tipo Clientraw o Realtime con los datos meteorológicos y solo se toman los datos necesarios para su posterior almacenamiento, se repite el mismo procedimiento que el anterior. El segundo proceso del robot, es el encargado de realizar el corte de imágenes, luego de que todas las imágenes resultantes del modelo meteorológico GFS son descargadas en el servidor, se procede a agrupar todas las imágenes en un solo directorio, se hace un cálculo de cuántas imágenes se encuentran en el directorio y se hace una distribución equitativa entre todos los nodos que se encuentren disponible en el cluster. Cada nodo ejecutará el script GoogleTileCutter que es el encargado de realizar el corte a cada imagen para luego ser copiadas a un solo directorio las imágenes resultantes para que queden preparadas para su posterior carga a través de la interfaz de Google Maps. 100 101 5 Resultados, Conclusiones y Trabajos a futuro 5.1 Resultados A continuación se presentan los resultados logrados en este trabajo especial de grado: - Se construyó un modelo de datos que permite almacenar los datos provenientes de las estaciones meteorológicas, interpretando el formato METARs, archivos Clientraw y Realtime. - Se construyó un modelo de datos que permite llevar una administración de las estaciones que se van añadiendo a la Base de Datos. - Se automatizó el proceso de almacenamiento de los reportes que genera cada estación meteorológica. - Se elaboró una interfaz que permita al usuario visualizar las predicciones meteorológicas a través de un mapa interactivo. - Se elaboró una interfaz que permita a un usuario previamente autenticado poder administrar las estaciones que se agregan a la Base de Datos. - Se elaboró una interfaz donde se pueda visualizar las condiciones del tiempo actuales e históricas de una estación en particular. - Se colocó a disposición del público general la descarga de los archivos históricos provenientes de cada estación meteorológica. 5.2 Conclusiones La implementación del nuevo sitio basado en MeteoMapas, obtiene información en formato METAR directamente de la NOAA, de más de 340 estaciones en el área norte de Suramérica, el Caribe y Brasil. Desde finales de 2010, se han capturado más de 750.000 registros METAR de la NOAA y 12.000 de las estaciones MeteoVen que se traducen en 300mb en almacenamiento. Hasta el momento, se ha incorporado información de más de 340 estaciones, información que se toma directamente del sitio de la NOAA. Con esta información 102 más las estaciones pertenecientes a la red MeteoVen, pueden hacerse predicciones meteorológicas adecuadas hasta un máximo de 48 horas. A nivel de las interfaces de usuario, se simplificó de forma sustancial el aspecto del SAMMET, debido a lo dificultoso de su uso en la versión original. Sin embargo, el procesamiento que hay que hacer a las imágenes para que la precisión y el acercamiento sean más detallados consume mucho tiempo de cómputo. En las primeras versiones desarrolladas, se ha logrado reducir el tiempo de procesamiento de las imágenes de 3 horas a una hora y media, sin embargo estos tiempos pueden mejorarse incorporando más nodos de cómputo en la Unidad de Meteorología del IVIC. Esto traería dos consecuencias positivas: en primer lugar, podrían ejecutarse más operaciones de proceso de imágenes mejorando la escala en que se pueden visualizar los datos. Y por el otro lado, podrían añadirse nuevas regiones geográficas al análisis que se realiza. Actualmente el sistema permite a los usuarios obtener información histórica de eventos meteorológicos, de una forma y en una escala que no se había tenido antes en Venezuela. Estos datos servirán para mejorar los modelos, hacer análisis de estadísticas ambientales, y en general para conocer las variaciones de las variables atmosféricas a lo largo de períodos determinados de tiempo. 5.3 Limitaciones Entre las limitaciones que se hallaron durante el desarrollo de este Trabajo se encuentren:  Algunas funcionalidades del meteomapa no son compatibles con el navegador de Internet Explorer de las versión 8 hacia atrás.  Los datos provenientes de los METARs dependen de la NOAA, si hay algún cambio en la página se tendría que cambiar el robot.  Los reportes de los METARs están sujetos a errores por lo que son tratados por humanos y está el factor de error. 103  Si el usuario posee una conexión de internet muy baja, el rendimiento del mapa será muy pobre. 5.4 Trabajos Futuros Para las siguientes etapas de este trabajo se plantea:  Incorporar nuevos modelos de predicción al sistema.  Aumentar el número de imágenes a procesar. Para lograr esto, es necesario tener una mejor infraestructura de cluster y ancho de banda.  Se plantea enriquecer las interfaces incorporando nuevas variables, aunque manteniendo la apariencia sencilla y clara de los mapas.  Incorporar más estaciones meteorológicas a la red MeteoVen, se tiene estimado en una primera etapa incorporar una estación por estado y en una segunda etapa agregar una estación por municipio. 104 105 6 Referencias [1] Space Science and Engineering Center. University of Wisconsin-Madison. Extraido en abril 2010 desde http://www.ssec.wisc.edu/faq.html [2] Tropical Rainfall Measuring Mission. Extraído en abril 2010 desde http://kids.earth.nasa.gov/trmm/ [3] Dr. Barbara J. Munn ‘s Homa Page. California State University, Sacramento. Extraído en mayo 2010 desde http://www.csus.edu/indiv/m/munnb/Oceanography/Lectures/Oceans6d_Seaw ater.html [4] Tutiempo Network, S.L. España. Extraído en mayo 2010 desde http://www.tutiempo.net/diccionario/mapa_de_superficie.html [5] Centro virtual de Meteorología (CvM). Extraído en mayo 2010 desde http://met.ivic.gob.ve/cvm.htm [6] Graficador GRADS (Grid Analyis and Display System). http://www.cmc.org.ve/mediawiki/index.php?title=Guia_GrADS [7] Sistema Automatizado de Modelado Meteorológico para Venezuela (SAMMET). Extraído en mayo 2010 desde http://met.ivic.gob.ve/SAMMET/descripcion.html [8] Proyecto SAMMET-i del Centro virtual de Meteorología. Extraído en mayo 2010 desde http://www.yv5fih.org.ve/sammet/ayuda/descripcion.html [9] Weather Underground. Extraído en mayo 2010 desde http://www.wunderground.com [10] The Weather Channel. Extraído en mayo 2010 desde http://espanol.weather.com/ [11] National Weather Service National Centers for Environmental Prediction. Extraído en mayo 2010 desde http://www.ncep.noaa.gov/ [12] Weather Display – the Weather Station Software. Extraído en mayo 2010 desde http://www.weather-display.com/index.php [13] Sandaysoft - Cumulus Weather Station Software. Extraído en mayo 2010 desde http://sandaysoft.com/products/cumulus http://www.ssec.wisc.edu/faq.html http://kids.earth.nasa.gov/trmm/ http://www.csus.edu/indiv/m/munnb/Oceanography/Lectures/Oceans6d_Seawater.html http://www.csus.edu/indiv/m/munnb/Oceanography/Lectures/Oceans6d_Seawater.html http://met.ivic.gob.ve/cvm.htm http://www.cmc.org.ve/mediawiki/index.php?title=Guia_GrADS http://met.ivic.gob.ve/SAMMET/descripcion.html http://www.yv5fih.org.ve/sammet/ayuda/descripcion.html http://www.wunderground.com/ http://espanol.weather.com/ http://www.ncep.noaa.gov/ http://www.weather-display.com/index.php http://sandaysoft.com/products/cumulus 106 [14] Aviation Routing Weather Report. Extraído en mayo 2010 desde http://www.met.tamu.edu/class/METAR/metar.html [15] Numerical weather prediction. Extraído en mayo 2010 desde http://en.wikipedia.org/wiki/Numerical_weather_prediction [16] The Weather Research Foracasting Model Website. Extraído en mayo 2010 desde http://www.wrf-model.org/index.php [17] Global Forecast System. Extraído en mayo 2010 desde http://en.wikipedia.org/wiki/Global_Forecast_System [18] Brazilian developments on the Regional Atmospheric Modelling System. Extraído en mayo 2010 desde http://brams.cptec.inpe.br/ [19] European Centre for Medium-Range Weather Forecasts. Model WAM. Extraído en mayo 2010 desde http://www.ecmwf.int/newsevents/training/rcourse_notes/numerical_methods/ wave_model/Wave_model2.html [20] PHP: Hypertext Preprocessor. http://www.php.net/ [21] CakePHP: The rapid development PHP framework. http://www.cakephp.org [22] PostgresSQL. http://www.postgresql.org/ [23] The Perl Programming Language. http://www.perl.org/ [24] API Google Maps. http://code.google.com/intl/es- ES/apis/maps/index.html [25] MPICH2: High-performance and Widely Portable MPI. www.mcs.anl.gov/mpi/mpich/. [26] GoogleTileCutter: Unix command-line tile cutter for Google Maps. . http://code.google.com/p/googletilecutter/ [27] Jpgraph – Most powerful PHP-driven charts. http://jpgraph.net/ [28] GeoMetar: A Perl module for accessing aviation weather information. http://jeremy.zawodny.com/perl/Geo-METAR/ [29] Jquery: JavaScript Library. http://jquery.com/ http://www.met.tamu.edu/class/METAR/metar.html http://en.wikipedia.org/wiki/Numerical_weather_prediction http://www.wrf-model.org/index.php http://en.wikipedia.org/wiki/Global_Forecast_System http://brams.cptec.inpe.br/ http://www.ecmwf.int/newsevents/training/rcourse_notes/numerical_methods/wave_model/Wave_model2.html http://www.ecmwf.int/newsevents/training/rcourse_notes/numerical_methods/wave_model/Wave_model2.html http://www.php.net/ http://www.cakephp.org/ http://www.postgresql.org/ http://www.perl.org/ http://code.google.com/intl/es-ES/apis/maps/index.html http://code.google.com/intl/es-ES/apis/maps/index.html http://www.mcs.anl.gov/mpi/mpich/ http://code.google.com/p/googletilecutter/ http://jpgraph.net/ http://jeremy.zawodny.com/perl/Geo-METAR/ http://jquery.com/ 107 7 Apéndice A – Configuración del cluster de la Unidad de Meteorología En la Unidad de Meteorología se encontraban 2 servidores operando de manera independiente. Para que el robot pudiera hacer el procesamiento de las imágenes en paralelo fue necesario agrupar los dos servidores en un cluster. A continuación se explica los pasos que se aplicaron: 1. Configurar NFS (Network File System) en el nodo maestro: a) Editar el archivo /etc/hosts agregando (esto se hace en todos los nodos): 190.170.146.237 UM met.ivic.gob.ve 192.168.1.70 met met.ivic.gob.ve 192.168.1.71 nodo1 nodo1.ivic.gob.ve Nota: En los hosts esclavos hay que dejar: 127.0.0.1 localhost b) Editar el archivo /etc/exports agregando: /home 192.168.1.70/255.255.0.0(rw,sync,no_root_squash) /usr/local/ 192.168.1.70/255.255.0.0(rw,sync,no_root_squash /var/www/ 192.168.1.70/255.255.0.0(rw,sync,no_root_squash c) Ejecutamos: exportfs –ra d) Agregar una directiva al firewall: iptables -A INPUT -p tcp --dport 32771, 111 and 2049 -j ACCEPT e) Reiniciamos el servicio nfs: service nfs restart 108 f) Para que el servicio de nfs se inicie siempre cuando la maquina se enciende, ejecutamos: chkconfig nfs on 2. Configurar NFS en el nodo esclavo: a) Editar el arhivo /etc/fstab agregando: 192.168.1.70:/usr/local/ /usr/local/ nfs defaults 0 0 192.168.1.70:/home /home nfs defaults 0 0 192.168.1.70:/var/www /var/www nfs defaults 0 0 b) Ejecutamos: mount -t nfs –a c) Reiniciamos el servicio: service nfs restart d) Para que el servicio se inicie siempre luego de reiniciar ejecutamos: chkconfig nfs on Nota: Para verificar que NFS esta funcionando creamos una carpeta en /home y vemos que este replicada en todos los nodos. 3. Configurar NIS (Network Information Service) en el nodo maestro a) Indicar el NIS DOMAIN NAME nisdomainname ivic.gob.ve b) Editar el archivo /etc/sysconfig/network, agregando: NISDOMAIN="met.ivic.gob.ve" c) Reiniciar la interfaz de red: 109 service network restart Nota: Asegurarme que portmapper este corriendo con: rpcinfo -p localhost d) Creamos el archivo en /var/yp/ que se llame securenets agregando: 255.0.0.0 127.0.0.0 255.255.255.0 192.168.1.0 e) Descargar el paquete RPM ypserv desde aca: http://dir.filewatcher.com/d/RedHat/9/i386/System%20Environment/Daemon s/ypserv-2.6-2.i386.rpm.119917.html f) Instalamos el paquete: rpm -ivh ypserv-2.6-2.i386.rpm g) Editamos el archivo /etc/yp.conf agregamos: ypserv 127.0.0.1 h) Inicializamos los servicios: service yppasswdd start service ypserv start chkconfig yppasswdd on chkconfig ypserv on i) Ejecutamos: /usr/lib/yp/ypinit –m y agregamos cada uno de los host que nos va pidiendo. 4. Configurar NIS en el nodo esclavo: http://dir.filewatcher.com/d/RedHat/9/i386/System%20Environment/Daemons/ypserv-2.6-2.i386.rpm.119917.html http://dir.filewatcher.com/d/RedHat/9/i386/System%20Environment/Daemons/ypserv-2.6-2.i386.rpm.119917.html 110 a) Indicar el NIS DOMAIN NAME nisdomainname met.ivic.gob.ve b) Editar el archivo /etc/sysconfig/network agregando: NISDOMAIN="met.ivic.gob.ve" c) Reiniciar la interfaz de red service network restart d) Editamos el archivo /etc/yp.conf agregamos: domain met.ivic.gob.ve server 192.168.1.70 e) Iniciamos el servicio service ypbind start chkconfig ypbind on f) Verificamos que este corriendo: rpcinfo -u localhost ypbind g) Creamos el archivo hosts.conf en /etc/nsswitch y agregamos: order hosts, nis, bind h) Editamos el archivo /etc/nsswitch.conf passwd: files nis shadow: files nis group: files nis hosts: files dns netgroup: files nis automount: files nis aliases: files nis 5) Configurar SSH (Secure Shell) a) Creamos una carpeta que se llame .ssh en /etc/skel mkdir .ssh cd .ssh b) Ejecutamos: ssh-keygen -t rsa -f id_rsa Nota: Nos va a pedir que introduzcamos una palabra la dejamos en blanco. c) Copiamos. 111 cat id_rsa.pub >> authorized_keys d) Por último ejecutamos: chmod 600 * 6) Instalar MPICH a) Descomprimir el archivo comprimido con: tar xvzf mpich2-0.1.tar b) Creamos una carpeta para mpich: mkdir mpich2 c) Entramos en la carpeta /usr/local/mpich2 y ejecutamos: ./configure --prefix=/usr/local/mpich2 Make Make install d) Creamos el archivo mpd.hosts en la carpeta /etc/skel y añadimos: node01 ... nodeNN e) Creamos el archivo .mpd.conf (solo con permiso 600) en la carpeta /etc/skel y añadimos: MPD_SECRET=cluster f) Setear las variables de entorno source .bash_profile g) Para probar mpich: o Levantamos el proceso mpd: mpd& o Ejecutamos: mpdboot -n <nro nodos> o Para verificar si los nodos estan activos: mpdtrace o Para bajar todos los nodos mpdallexitUniversidad Central de Venezuela Facultad de Ciencias Escuela de Computación Centro de Computación Paralela y Distribuida Diseño e implementación de un Sistema Automatizado de Modelaje Meteorológico Interactivo Trabajo Especial de Grado Presentado ante la Ilustre Universidad Central de Venezuela Por el Bachiller: Jonathan E, Urrea F Para optar al Título de: Licenciado en Computación. Profesor Tutor: Robinson Rivas. Caracas, Mayo 2011 2 3 4 5 Resumen El sistema automatizado de modelaje meteorológico interactivo (SAMMET-i) permite al usuario visualizar de una manera rápida y sencilla una serie de mapas de predicciones meteorológicas. También se podrán consultar imágenes satelitales, mapas sinópticos y estaciones que reportan el estado del tiempo. Estas variables se muestran de forma de iconos sobre los mapas de manera que el usuario las puede consultar y ver cuáles son las condiciones del tiempo en dicha localidad. Como parte del sistema, se diseñó una Base de Datos para llevar una recopilación histórica de cada estación meteorológica que reporta diariamente, estos registros se guardan cada hora durante el día y posteriormente pueden ser consultados a través de una interfaz web donde el usuario puede verlas en línea o descargar estas consultas en un archivo. Actualmente se cuenta con información de las estaciones meteorológicas de los aeropuertos venezolanos que reportan en un formato METAR las condiciones del tiempo y las estaciones de la red MeteoVen que forman parte del Centro virtual de Meteorología (CvM) en colaboración con la Unidad de Meteorología ubicado en el Instituto Venezolano de Investigaciones Científicas (IVIC). Palabras claves: Sistemas de Predicción Meteorológica, SAMMET, formatos METAR. 6 7 Índice general 1 Capítulo 1: Introducción ...................................................................................... 17 1.1 PLANTEAMIENTO DEL PROBLEMA ..........................................................................................17 1.2 OBJETIVO GENERAL ..............................................................................................................18 1.3 OBJETIVOS ESPECÍFICOS ........................................................................................................18 1.4 JUSTIFICACIÓN ......................................................................................................................19 2 Capitulo 2: Marco Teórico ................................................................................... 21 2.1 TÉRMINOS METEOROLÓGICOS ...............................................................................................21 2.1.1 Temperatura .....................................................................................................................21 2.1.2 Punto de Rocío .................................................................................................................21 2.1.3 Dirección del Viento .........................................................................................................21 2.1.4 Velocidad del Viento ........................................................................................................21 2.1.5 Ráfagas .............................................................................................................................22 2.1.6 Humedad Relativa ............................................................................................................22 2.1.7 Presión Atmosférica .........................................................................................................22 2.1.8 Precipitación ....................................................................................................................22 2.1.9 Índice de Chandler ...........................................................................................................22 2.1.10 CAPE (Convective Available Potencial Energy) ..............................................................23 2.1.11 Cizalladura .......................................................................................................................23 2.1.12 Temperatura del mar ........................................................................................................23 2.1.13 Altura geopotencial ..........................................................................................................23 2.1.14 Presión a nivel del mar ....................................................................................................23 2.2 MAPAS METEOROLÓGICOS.....................................................................................................23 2.2.1 Satelitales .........................................................................................................................24 2.2.1.1 GOES (Geoestacionary Oservational Enviromental Satellite): ..............................................24 2.2.1.2 TRMM (Tropical Rainfall Measuring Mission) .....................................................................26 2.2.1.3 SST (Sea Surface Temperature) .............................................................................................26 2.2.2 Superficies ........................................................................................................................27 2.3 SITIOS WEB DE METEOROLOGÍA ...........................................................................................28 2.3.1 Centro virtual de Meteorología (CvM) ............................................................................28 2.3.2 SAMMET ..........................................................................................................................28 2.3.3 SAMMET-i ........................................................................................................................31 2.3.4 Wunderground ..................................................................................................................32 2.3.5 Weather Channel ..............................................................................................................32 2.3.6 NCEP ................................................................................................................................32 2.4 FORMATO DE DATOS METEOROLÓGICOS ................................................................................33 2.4.1 METARs ...........................................................................................................................33 2.4.2 Archivo Realtime.txt .........................................................................................................35 2.4.3 Archivo Clientraw.txt .......................................................................................................37 2.5 MODELOS METEOROLÓGICOS ................................................................................................37 2.5.1 Modelo WRF ....................................................................................................................39 2.5.2 Modelo GFS .....................................................................................................................40 2.5.3 Modelo BRAMS ................................................................................................................41 2.5.4 Modelo WAM ....................................................................................................................42 8 3 Capitulo 3 - Descripción y Análisis del diseño ................................................... 43 3.1 METODOLOGÍA UTILIZADA ...................................................................................................43 3.1.1 Etapa de Análisis: ............................................................................................................43 3.1.2 Etapa de Diseño: ..............................................................................................................43 3.1.3 Etapa de Implementación: ................................................................................................44 3.1.4 Etapa de Pruebas: ............................................................................................................44 3.2 REQUERIMIENTOS DE LA SOLUCIÓN ......................................................................................44 3.2.1 Requerimiento de Usuario ................................................................................................44 3.2.2 Requerimientos de Hardware ...........................................................................................46 3.2.3 Requerimientos de Software .............................................................................................46 3.3 DISEÑO DE LAS FUNCIONALIDADES PRINCIPALES ..................................................................46 3.3.1 Descripción General de Casos de Usos: ..........................................................................47 3.4 MODELOS DE SECUENCIA ......................................................................................................56 3.4.1 Funcionalidades del Usuario ...........................................................................................56 3.4.2 Funcionalidades del administrador..................................................................................61 3.5 DIAGRAMAS DE FLUJOS .........................................................................................................64 3.5.1 Funcionalidades del robot ................................................................................................64 4 Capitulo 4 - Desarrollo de la solución ................................................................. 67 4.1 DIAGRAMA DE ENTIDAD/RELACIÓN ......................................................................................67 4.2 MÓDULO DE USUARIO ...........................................................................................................69 4.3 MÓDULO DE ADMINISTRADOR ..............................................................................................91 4.4 MODULO DEL ROBOT ............................................................................................................98 5 Resultados, Conclusiones y Trabajos a futuro ................................................... 101 5.1 RESULTADOS .......................................................................................................................101 5.2 CONCLUSIONES ...................................................................................................................101 5.3 LIMITACIONES .....................................................................................................................102 5.4 TRABAJOS FUTUROS ............................................................................................................103 6 Referencias ........................................................................................................ 105 7 Apéndice A – Configuración del cluster de la Unidad de Meteorología ........... 107 9 Índice de figuras Figura 1.1 - SAMMET-i ......................................................................................................... 19 Figura 1.2 - Sistema de Meteompas Interactivos .................................................................... 20 Figura 2.1 - Imagen satelital de nubosidad ............................................................................. 24 Figura 2.2 - Imagen satelital de vapor de agua ....................................................................... 25 Figura 2.3 - Imagen satelital de onda corta ............................................................................. 25 Figura 2.4 - TRMM ................................................................................................................. 26 Figura 2.5 - SST ...................................................................................................................... 27 Figura 2.6 - Mapa de superficie .............................................................................................. 27 Figura 2.7 - Resultados del graficador Grads.......................................................................... 29 Figura 3.1 - Caso de Uso - Nivel 0 ......................................................................................... 47 Figura 3.2 - Caso de uso - Nivel 1 .......................................................................................... 48 Figura 3.3 - Caso de uso - Nivel 2 (Usuario) .......................................................................... 48 Figura 3.4 - Caso de uso – Nivel 2 (Administrador) ............................................................... 51 Figura 3.5 - Caso de uso – Nivel 2 (Robot) ............................................................................ 54 Figura 3.6 - Consultar registros de una estación meteorológica ............................................. 56 Figura 3.7 - Consultar mapas de predicción meteorológica .................................................... 60 Figura 3.8 - Consultar imágenes de mapas ............................................................................. 61 Figura 3.9 - Administrar estaciones meteorológicas ............................................................... 62 Figura 3.10 - Registrar datos meteorológicos ......................................................................... 64 Figura 3.11 - Procesar corte de imágenes ............................................................................... 66 Figura 4.1 - Modelo Entidad/Relación .................................................................................... 67 Figura 4.2 - Pagina inicial del Sistema de Meteomapas Interactivos (SMI) ........................... 69 Figura 4.3 - Solicitud de geolocalización al usuario ............................................................... 70 Figura 4.4 - Código Javascript de geolocalización ................................................................. 70 Figura 4.5 - Código Javascript de carga de inicio del mapa ................................................... 71 Figura 4.6 - Iconos de las estaciones cargadas en el mapa ..................................................... 71 Figura 4.7 - Marco informativo de la condición actual de una estación meteorológica ......... 72 Figura 4.8 - Registro del día de una estación meteorológica .................................................. 73 Figura 4.9 - Registro histórico de una estación meteorológica ............................................... 73 Figura 4.10 - Formato del archivo de descarga ....................................................................... 74 Figura 4.11 - Grafico de temperatura ...................................................................................... 74 Figura 4.12 - Mapa de predicción de temperatura .................................................................. 75 Figura 4.13 - Cambio de la hora de predicción ....................................................................... 76 Figura 4.15 - Mapa de precipitación de Nivel 6 de zoom ....................................................... 77 Figura 4.14 - Mapa de temperatura a un nivel de 500 Hpa ..................................................... 77 Figura 4.17 - Mapa de precipitación de Nivel 4 de zoom ....................................................... 78 Figura 4.16 - Mapa de precipitación de Nivel 6 de zoom ....................................................... 78 Figura 4.18 - Mapa de predicción de viento ........................................................................... 79 Figura 4.19 - Nubosidad sobre el área del Caribe y Centroamérica ....................................... 80 Figura 4.20 - Mapa de predicción del oleaje ........................................................................... 80 file:///E:/tesis-SAMMETI2.docx%23_Toc294523617 file:///E:/tesis-SAMMETI2.docx%23_Toc294523622 file:///E:/tesis-SAMMETI2.docx%23_Toc294523625 file:///E:/tesis-SAMMETI2.docx%23_Toc294523633 file:///E:/tesis-SAMMETI2.docx%23_Toc294523638 file:///E:/tesis-SAMMETI2.docx%23_Toc294523643 file:///E:/tesis-SAMMETI2.docx%23_Toc294523651 file:///E:/tesis-SAMMETI2.docx%23_Toc294523653 10 Figura 4.21 - Descargas eléctricas .......................................................................................... 81 Figura 4.22 - Mapa de predicción de temperatura a nivel del mar ......................................... 82 Figura 4.23 - Mapa de predicción de humedad relativa .......................................................... 82 Figura 4.24 - Mapa de predicción de CAPE ........................................................................... 83 Figura 4.25 - Mapa de predicción de Cizalladura ................................................................... 84 Figura 4.26 - Mapa de predicción de Índice de Chandler ....................................................... 84 Figura 4.27 - Mapa de Altura geopotencial ............................................................................ 85 Figura 4.28 - Mapa de Presión a nivel del mar ....................................................................... 85 Figura 4.29 - Vapor de agua para la región del Caribe ........................................................... 86 Figura 4.30 - Mapa satelital de Onda corta para la región del Caribe..................................... 86 Figura 4.31 - Mapa satelital TRMM ....................................................................................... 87 Figura 4.32 - Mapa Satelitales SST ........................................................................................ 88 Figura 4.33 - Mapa de superficie para las 00:00 horas ........................................................... 88 Figura 4.34 - Mapa de superficie para las 06:00 horas .......................................................... 89 Figura 4.35 - Mapa de superficie para las 12:00 horas ........................................................... 89 Figura 4.36 - Mapa de superficie para las 18:00 horas .......................................................... 90 Figura 4.37 - Mapa de superficie de Temperatura-Viento-Presión ......................................... 90 Figura 4.38 - Mapa de superficie de Precipitación-Humedad Relativa .................................. 91 Figura 4.39 - Interfaz de ingreso ............................................................................................. 92 Figura 4.40 - Interfaz del modulo de administrador ............................................................... 92 Figura 4.41 - Interfaz de administrar regiones ........................................................................ 93 Figura 4.42 - Interfaz de administrar países ............................................................................ 93 Figura 4.43 - Interfaz de administrar países ............................................................................ 94 Figura 4.44 - Interfaz de administrar tipo de fuentes de datos meteorológicas ...................... 95 Figura 4.45 - Interfaz de agregar una estación nueva (I parte) ............................................... 96 Figura 4.46 - Interfaz de agregar una estación nueva (II parte) .............................................. 96 Figura 4.47 - Interfaz de ver detalles de una estación ............................................................. 97 Figura 4.48 - Mensaje de confirmación para eliminar una estación ....................................... 97 Figura 4.49 - Interfaz para editar estación .............................................................................. 98 11 Índice de Tablas Tabla 2.1 - Formato del archivo Realtime.txt ........................................................................ 36 Tabla 2.2 - Formato del archivo Clientraw.txt ....................................................................... 37 12 13 Dedicatoria A mí Mamá y mi Abuela por haberme ayudado todo este tiempo durante la carrera, darme todo el apoyo cuando más lo necesitaba, por todas esas madrugadas, por todos los sacrificios que realizaron para poder llegar a esas instancias. A Dios por haber permitido que mi Abuela siga con nosotros y permitirle que sea testigo de este logro tan importante. 14 15 Agradecimiento A mi Mamá y mi Abuela por estar siempre a mi lado dándome apoyo en toda mi vida, por darme ánimos de nunca rendirme de luchar por lo que siempre he querido. A mi Tutor Robinson Rivas por brindarme sus conocimientos durante el desarrollo de mi carrera y durante la tesis, por todo el ánimo que me ha dado en los momentos más difíciles siempre ha sabido que decirme. A mis Co-Tutores Estatio Gutiérrez y Raúl Padrón por todo su apoyo durante la realización de la tesis a comprender este mundo tan maravilloso que es la meteorología. Al Instituto Venezolano de Investigaciones Científicas por aceptarme como estudiante de Tesista de pregrado, y por todo el apoyo institucional. Al Centro de Estudios Avanzados por otorgarme financiamiento durante la realización de mi tesis, y por toda la orientación recibida por su personal. A todo los muchach@s del CCPD por todos años que hemos compartido y por fin podemos decir que hemos logrado los objetivos que nos planteamos desde que comenzamos la carrera. A mi novia por haberme aguantado todo este tiempo de full estrés, gracias por estar ahí siempre apoyándome y tenerme tanta paciencia. 16 17 1 Capítulo 1: Introducción La humanidad ha realizado un gran esfuerzo por predecir el estado del tiempo y el clima, así como para interpretar las señales visuales, sonoras y de otro tipo que emite la atmósfera. Recientemente se ha avanzado de manera importante en la capacidad de informar los reportes del tiempo, bien sea a través de la televisión, los medios impresos ó el Internet. Gracias a la gran influencia de la Internet sobre estos reportes del tiempo y predicciones meteorológicas es posible ahora consultar estas informaciones en tiempo real. Por estas razones en Venezuela se desarrolló el Sistema Automatizado de Modelaje Meteorológico I-interactivo (SAMMET-i). En este trabajo presentamos una herramienta visual (Meteomapas interactivos) que hemos desarrollado para agregar nuevas funciones al sistema como lo son el almacenamiento y la descarga de datos históricos de las estaciones meteorológicas y la consulta de las predicciones meteorológicas del SAMMET-i, así como algunas informaciones referentes al estado del tiempo actual; y adicionalmente se agregó un menú amigable que permitiese elegir las distintas opciones de los mapas con las predicciones meteorológicas. El sistema está siendo puesto a prueba tomando información de un número superior a 340 estaciones situadas en el área de Venezuela, Colombia, Brasil, Ecuador, Perú, Centroamérica y el Caribe, a través de los datos proporcionados por la National Oceanic and Atmospheric Administration (NOAA) y datos de cinco estaciones venezolanas de la Red MeteoVen. Se presentan el desarrollo preliminar, algunas pantallas del sistema, y una discusión acerca de los alcances futuros de este proyecto. 1.1 Planteamiento del problema La Red de Estaciones Meteorológicas (Red MeteoVen), integrante del Centro virtual de Meteorología (CvM) opera en colaboración con la Unidad de Meteorología ubicado en el Instituto Venezolano de Investigaciones Científicas (IVIC), registrando 18 muy frecuentemente (cada 5 minutos) las condiciones atmosféricas reportadas por las estaciones meteorológicas en distintas zonas del país. Actualmente, la información puede ser consultada en tiempo real a través de su sitio web http://met.ivic.gob.ve/cvm pero los registros históricos no están disponibles al público de una manera práctica y sencilla. La inexistencia de una Base de Datos centralizada así como la manera ineficiente en que se almacenan los datos en la actualidad dificulta y en la práctica imposibilita el acceso a la información a través de la página web del CvM. Por esta razón, fue necesaria la elaboración de un sistema que almacenara los datos generados por las estaciones y permita el acceso a los mismos a través de una interfaz. Además de los datos registrados por la Red MeteoVen, se consideró útil incluir los reportes de las estaciones meteorológicas ubicadas en los distintos aeropuertos de Venezuela y el Caribe, los cuales son transmitidos cada cierto número de horas por cada aeropuerto a través de la Internet usando un formato estandarizado denominado METAR. Por otra parte, los datos disponibles en esta Base de Datos meteorológicos serán utilizados como condiciones iníciales para la ejecución de los distintos modelos meteorológicos de predicción del tiempo del SAMMET-i, como los son los modelos WRF (Weather Research Forecast) , WAM (Wave Analysis Model) , entre otros. 1.2 Objetivo General Diseñar y construir un sistema que permita la recopilación y almacenamiento de los reportes producidos por las estaciones; así como también un sitio web que muestre las predicciones meteorológicas a través de una interfaz de mapas interactivos. 1.3 Objetivos Específicos  Diseñar un modelo de datos que permita almacenar las variables meteorológicas persistentes que contienen los METARs u otros formatos.  Diseñar un modelo de datos específico de la herramienta para el manejo y control de las funcionalidades del sistema. 19  Automatizar el proceso de almacenamiento de los registros que cada estación meteorológica reporta.  Diseñar una interfaz que permita administrar las estaciones meteorológicas para que se puedan integrar al sistema.  Diseñar una interfaz que muestre de forma gráfica las predicciones meteorológicas a través de un mapa interactivo.  Diseñar una interfaz que muestre las condiciones del tiempo actuales de una estación meteorológica.  Colocar a disposición del público los archivos con los datos históricos provenientes de cada estación meteorológica. 1.4 Justificación La ausencia de registros históricos de variables meteorológicas disponibles en Internet para Venezuela y el Caribe hace necesario el desarrollo de una herramienta que ponga a la disposición de cualquier usuario la información meteorológica generada por la red MeteoVen, así como los datos provenientes de los aeropuertos que solo pueden ser consultados en tiempo real. Finalmente actualizar el aspecto del sitio web del Sistema Automatizado de Modelaje Meteorológico Interactivo (SAMMET-i), que se muestra en la Figura 1.1 Figura 1.1 - SAMMET-i 20 Para luego migrarlo a una versión más amigable como el Sistema de Meteomapas Interactivos (SMI), como se muestra en la Figura 1.2, que a su vez permita integrar nuevos modelos de predicción en el futuro. Figura 1.2 - Sistema de Meteompas Interactivos 21 2 Capitulo 2: Marco Teórico Esta sección reúne toda la información documental para confeccionar el diseño de la investigación que proporcionará el conocimiento teórico para el diseño y desarrollo del Sistema Meteomapas Interactivos (SMI). 2.1 Términos Meteorológicos A continuación se explican una serie de términos meteorológicos que más adelante se van a ir explicando. 2.1.1 Temperatura Es el grado de calor y de frío del ambiente, como se indica en una escala determinada. En observaciones de la superficie, se refiere principalmente al aire libre o temperatura ambiental cerca a la superficie de la tierra. Los valores válidos que puede reportar una estación meteorológica están entre -60 ºF (-51 ºC) hasta 130 ºF (54.4 ºC). 2.1.2 Punto de Rocío Es la temperatura a partir de la cual empieza a condensarse el vapor de agua contenido en el aire produciendo rocío, neblina, o en el caso de que la temperatura sea inferior a 0ºC, escarcha. Los valores deberían estar comprendidos entre -90 ºF (-67.7 ºC) hasta 90 ºF (32.2 ºC). 2.1.3 Dirección del Viento La dirección se mide en grados, de la cual el viento sopla con dirección al norte. La dirección del viento será determinada calculando el promedio de la dirección durante un período de 2 minutos. Los valores estarían entre 0º y 359º. 2.1.4 Velocidad del Viento Es el promedio del movimiento del aire durante un período de tiempo preestablecido. Puede medirse en varias unidades por ejemplo: Nudos (kts), kilómetros por hora o en 22 millas por hora. Los valores si están medidos en nudos deberían estar entre 0 kts y 350 kts. Si es en kilómetros por hora, el valor debería estar comprendido entre 0 km/h y 649 km/h y si son millas por hora, el valor sería entre 0 mp/h y 403 mp/h. 2.1.5 Ráfagas La información de la velocidad del viento correspondiente a los últimos 10 minutos se llevará a cabo para evaluar la ocurrencia de ráfagas. Las ráfagas se indican con rápidas fluctuaciones en la velocidad del viento con una variación de 10 nudos o más entre los periodos picos y los periodos calmados. La velocidad de una ráfaga de viento será la velocidad máxima instantánea. 2.1.6 Humedad Relativa Es la humedad que contiene una masa de aire, en relación con la máxima humedad absoluta que podría admitir sin producirse condensación, conservando las mismas condiciones de temperatura y presión atmosférica. Esta es la forma más habitual de expresar la humedad ambiental. Usualmente se expresa en porcentajes. Los valores están comprendidos entre 0 % y 100 %. 2.1.7 Presión Atmosférica Es la presión o el peso por unidad de área que ejerce la atmósfera en un punto determinado. La presión puede expresarse: hectopascales (Hpa), en milibares (mb), pulgadas (in) o milímetros de mercurio (Hg). También se conoce como presión barométrica. Los valores están comprendidos entre 846 mb y 1110 mb. 2.1.8 Precipitación Es una de las formas en la que se presenta el agua, ya sea líquido o sólido, que caen de la atmósfera y llega al suelo. Esto incluye la lluvia, llovizna, llovizna helada, lluvia helada, granizo, hielo granulado, nieve, granizo menudo y bolillas de nieve. 2.1.9 Índice de Chandler Proporciona una medida del efecto de la temperatura, velocidad del viento y humedad promedios en la ocurrencia, intensidad y tasa de propagación de incendios. 23 2.1.10 CAPE (Convective Available Potencial Energy) Representa la cantidad de energía de flotabilidad disponible de una parcela o burbuja de aire que se eleva a cierta distancia vertical a través de la atmósfera. 2.1.11 Cizalladura Es la diferencia en la velocidad del viento o su dirección entre dos puntos en la atmósfera terrestre. Dependiendo de si los dos puntos están a diferentes altitudes o en diferentes localizaciones geográficas, la cizalladura puede ser vertical u horizontal. 2.1.12 Temperatura del mar El agua de los océanos se calienta por la radiación del Sol, pero debido a los distintos ángulos con que el globo terrestre recibe los rayos solares (latitud), la temperatura disminuye desde el ecuador, donde alcanza los 30 ºC, hacia los polos donde tiene sólo -2,2 ºC en promedio. 2.1.13 Altura geopotencial La altura de un punto dado en la atmósfera en unidades es proporcional a la energía potencial de la unidad de masa (geopotencial) a esta altura, en relación con el nivel del mar. 2.1.14 Presión a nivel del mar Es la presión atmosférica a nivel del mar. El cálculo permite comparar la presión de dos sitios con alturas diferentes. 2.2 Mapas meteorológicos Un mapa meteorológico trata de representar sobre una zona de la Tierra los valores de una variable atmosférica, en superficie o en niveles superiores. A veces los mapas describen también la situación de algunos fenómenos atmosféricos de forma tridimensional. Los métodos de representación pueden ser diferentes. A continuación se explican varios tipos de mapas meteorológicos: 24 2.2.1 Satelitales Los mapas satelitales se dividen en varios tipos: 2.2.1.1 GOES (Geoestacionary Oservational Enviromental Satellite): Sistema de satélites geoestacionarios estadounidenses. Se tienen en operación dos satélites a los que se conoce como GOES-East y GOES-West que cubren en sus observaciones. El GOES-East abarca el Atlántico mientras que el GOES-West cubre el área del Pacífico [1]. Estos mapas pueden ser de tipo: - Nubosidad: Muestra características climáticas a nivel mesoescala, como la cobertura de nubosidad, los límites de masa de aire, zonas de convergencia, las tormentas y la cobertura de nieve. En la Figura 2.1 se muestra un ejemplo. Figura 2.1 - Imagen satelital de nubosidad - Vapor de agua: La imagen de vapor d agua se forma por la radiación emitida por las nubes y las grandes cantidades de vapor de agua. Nos muestra la cantidad de vapor de agua. En la Figura 2.2 se muestra un ejemplo. 25 Figura 2.2 - Imagen satelital de vapor de agua - Onda Corta: Las imágenes en esta longitud de onda consisten no sólo de la radiación emitida por el sistema de la atmósfera terrestre, también se refleja la radiación solar. Útil para la niebla y la identificación de agua en la nube, también se observan los cambios de fase de las nubes, y distinción de la cobertura de nubes sobre las zonas con nieve, y pueden detectarse incendios. En la Figura 2.3 se muestra un ejemplo. Figura 2.3 - Imagen satelital de onda corta 26 2.2.1.2 TRMM (Tropical Rainfall Measuring Mission) Se utilizan para investigar la ubicación y la intensidad de la lluvia,. No todas las nubes causan la lluvia, y cuando esta cae, lo hace a través de varias alturas en la atmósfera, pudiendo a veces no alcanzar el suelo en absoluto. TRMM no es utilizado para las mediciones de precipitación diaria en las ciudades, pero es utilizado por científicos de la atmósfera y los meteorólogos para comprender mejor cómo y por qué ocurren las precipitaciones, de esa manera podrán mejorar sus predicciones en el futuro [2]. En la Figura 2.4 se muestra un ejemplo. 2.2.1.3 SST (Sea Surface Temperature) La temperatura superficial del mar (TSM) es la temperatura del agua cercana de la superficie de los océanos. La definición de la superficie varía según el método de medición utilizado, pero es entre un milímetro (0,04 pies) y 20 metros (70 pies) por debajo de la superficie del mar. En la Figura 2.5 se muestra un ejemplo. Figura 2.4 - TRMM 27 Figura 2.5 - SST 2.2.2 Superficies Muestra la sinopsis de la situación meteorológica a nivel de superficie. Por norma internacional el nivel medio del mar es considerado como el nivel superficial, por lo que los observatorios situados a mayor o menor altura deben ajustar sus lecturas por medio de correcciones. En la Figura 2.6 se muestra un ejemplo. Figura 2.6 - Mapa de superficie 28 2.3 Sitios Web de Meteorología 2.3.1 Centro virtual de Meteorología (CvM) El Centro virtual de Meteorología (CvM) ha sido creado por el Ing. Hidrometeorologista Estatio Gutiérrez y el Dr. Raúl Padrón en Febrero del 2008 para apoyar la investigación de la Meteorología en Venezuela y el Caribe. En su sitio en Internet http://met.ivic.gov.ve/cvm se publican una variedad de productos en tiempo real, así como reportes automatizados de las estaciones que colaboran con los varios proyectos que soporta. Las actividades del CvM cuentan con el apoyo institucional del IVIC (Instituto Venezolano de Investigaciones Científicas), a través de su Unidad de Meteorología (UMIVIC), se puede consultar en http://met.ivic.gob.ve El CvM es una organización voluntaria sin fines de lucro, todos los entusiastas de la meteorología y radioaficionados son bienvenidos a participar y colaborar en la medida de sus posibilidades. Actualmente, el CvM lleva a cabo quince proyectos, entre los cuales destacan la Red de Estaciones Meteorológicas de Venezuela (Red MeteoVen), el Sistema Automatizado de Modelado Meteorológico para Venezuela (SAMMET), entre otros que se pueden encontrar en la página web. [5] 2.3.2 SAMMET El Sistema Automatizado de Modelado Meteorológico para Venezuela (SAMMET) que evoluciono rápidamente al SAMMET-i, es una herramienta desarrollada por el CvM, para proporcionar diariamente los resultados de las simulaciones, realizadas a través de varios modelos numéricos como por ejemplo el modelo WRF, de algunas condiciones meteorológicas como el mapa de descargas eléctricas atmosféricas y oceánicas sobre Venezuela y el Caribe. Este tipo de información es de suma utilidad para pronosticadores, investigadores y público en general que desean conocer cuál http://met.ivic.gov.ve/cvm 29 será el posible estado del tiempo en un momento determinado futuro sobre el territorio nacional. El sistema está conformado por una serie de códigos que permiten descargar la información necesaria de Internet, realizar sin intervención de un usuario todo el proceso de ejecución de cada uno de los modelos y finalmente posprocesar las salidas obtenidas utilizando el graficador Grads [6], que es una herramienta interactiva utilizada para la manipulación y visualización de datos científicos, en la Figura 2.7 se muestra un ejemplo de una salida del graficador. El tiempo de cómputo de este tipo de modelos depende directamente de las características del servidor utilizado, las dimensiones del área simulada, su resolución y de las parametrizaciones físicas seleccionadas. Debido a que este proyecto ha sido desarrollado con poco financiamiento existen ciertas limitaciones en cuanto a la capacidad computacional disponible y la elaboración de herramientas que permitan un desempeño más eficiente del sistema. Actualmente, es posible realizar simulaciones de 48 horas de duración para un par de dominios en donde el primero de ellos abarca El Caribe, Venezuela, parte de Colombia y Brasil. El segundo dominio está destinado solo para simular el comportamiento de las variables meteorológicas sobre Venezuela a una resolución mayor. Las limitaciones antes mencionadas traen como consecuencia que se Figura 2.7 - Resultados del graficador Grads 30 presenten algunos errores en la graficación de las salidas en esta primera etapa, como por ejemplo la ausencia de meteogramas y sondeos en la salida del WRF, estas fallas serán solventadas paulatinamente. Además se prevé la instalación de otros modelos tanto meteorológicos como oceánicos. Los modelos BRAMS (Brazilian Regional Atmospheric Modeling System), CATT (Coupled Aerosol and Tracer Transport), WAM (Wave Analysis Model), WRF (Weather Research and Forecasting), MM5 (Mesoscale Model 5) y los códigos que constituyen al sistema son ejecutados en un servidor de 64-bits con procesador Intel Dual-Core de 8 procesadores y compilador Intel, ubicado en la Unidad de Meteorología del Instituto Venezolano de Investigaciones Científicas (IVIC). El inicio de la ejecución de los distintos modelos está pautado a diferentes horas del día debido a la imposibilidad de ejecutar la totalidad de los mismos simultáneamente. Los resultados son publicados en dos grupos, uno en horas de la mañana y otro en horas de la tarde. El GFS (Global Forecast System), es el único modelo que no es ejecutado en el servidor y sus datos son utilizados como condición de borde para el resto. Al momento de analizar este tipo de información es importante tener en cuenta que las salidas de los modelos son una herramienta de pronóstico y dichos resultados deben ser utilizados junto a imágenes de satélite y radar, modelos estadísticos y el conocimiento de un especialista para emitir una predicción. Las gráficas presentadas en esta página ayudan a entender el comportamiento de la atmósfera en las próximas 48 horas con un grado de incertidumbre que no ha sido determinado para el país. Tanto la validación de estos modelos como la elaboración del pronóstico nacional es tarea de los institutos competentes pertenecientes al estado donde el SAMMET no intenta suplantar sus funciones. Este tipo de iniciativas no serían posibles sin la existencia de software con licencia libre que van desde el sistema operativo utilizado (Fedora Core 7) pasando por el compilador, los códigos fuente de cada modelo, los graficadores, etc. Aunado a las herramientas computacionales, la ejecución puede ser realizada gracias a los datos de 31 los modelos globales disponibles en Internet que son publicados cuatro veces al día por distintas instituciones como la NOAA y el Centro de Previsión de Tiempo y Estudios Climáticos (CPTEC). [7] 2.3.3 SAMMET-i Es una herramienta desarrollada para proporcionar diariamente las simulaciones realizadas por modelos numéricos de predicción del tiempo, de las condiciones meteorológicas y oceánicas sobre Venezuela y el Caribe. Los modelos WRF y WAM son corridos para un período de 48 horas en un par de dominios: el primero abarca El Caribe, Centroamérica, Venezuela, Guyana, Surinam, Guayana Francesa, Colombia, Brasil, Perú, Ecuador y parte de Bolivia, y el segundo dominio simula el comportamiento de las variables meteorológicas sobre Venezuela a una resolución mayor (10 km). Los modelos son inicializados con la información proveniente del GFS. Los resultados de las simulaciones son presentados a través de una interfaz Google Maps. El SAMMET-i presenta una serie de mapas meteorológicos de las variables precipitación, temperatura, viento, presión, humedad relativa y CAPE, y están disponibles para cuatro niveles de la tropósfera. Adicionalmente, es posible acceder de manera rápida a imágenes satelitales de Venezuela y el Caribe, mapas sinópticos, mapa de descargas eléctricas atmosféricas de Venezuela, datos de estaciones meteorológicas en tiempo real, webcams, sondeos y meteogramas simulados para cualquier punto sobre el dominio. Los distintos modelos son ejecutados diariamente de manera casi simultánea en el servidor del Centro virtual de Meteorología en horas de la madrugada. La mayoría de los productos están disponibles en las primeras horas de la mañana. Sin embargo, el proceso de creación de las imágenes es lento debido a la gran cantidad de información que se procesa. Por esa razón, los mapas correspondientes al segundo zoom están disponibles apenas en horas de la tarde. [8] 32 2.3.4 Wunderground Weather Underground es una compañía comprometida en ofrecer la información meteorológica más fiable y precisa posible. Los monitores de última generación supervisan y predicen las condiciones meteorológicas para todas las ubicaciones del mundo, por lo que siempre el usuario encontrara la información del tiempo que necesite. Además de ofrecer información del tiempo gratuita en línea a millones de usuario en la Internet, también ofrecen una variedad de servicios de reportes meteorológicos y paquetes del tiempo para la Web. Desde 1995 el sitio web no se ha detenido y nuevas características se han añadido en los últimos años. Cabe destacar que Weather Underground ha desarrollado la mayor red mundial de estaciones meteorológicas personales (casi 19.000 estaciones en los EE.UU y más de 13.000 estaciones en el resto del mundo) que proporciona al usuario las condiciones climáticas lo más cercana posible a donde se encuentre localmente.[9] 2.3.5 Weather Channel Desde su lanzamiento en 2002, weather.com/espanol brinda información meteorológica completa y confiable en toda Norteamérica. Además de incluir todos los códigos postales de los Estados Unidos y miles de ciudades internacionales, weather.com/espanol también brinda información sobre actividades de la vida cotidiana y datos de interés sobre salud, viajes y esparcimiento, entre otros. El sitio pone a disposición del usuario una amplia gama de innovadores mapas meteorológicos que incluyen datos de radar (precipitaciones) y satélite (nubosidad).[10] 2.3.6 NCEP La National Centers for Environmental Prediction (NCEP), una extensión de la NOAA’s National Weather Service (NWS), se compone de 9 centros y una oficina central del director, la cual provee una amplia variedad de servicios meteorológicos nacionales e internacionales de la NWS, organismos gubernamentales, manejo de emergencias, meteorólogos del sector privado y las organizaciones meteorológicas y sociedades a través del mundo. NCEP es un recurso crítico nacional en la predicción 33 meteorológica a nivel nacional e internacional, adicionalmente es el punto de partida para casi todos los pronósticos del tiempo en los Estados Unidos.[11] 2.4 Formato de datos meteorológicos A continuación se da una descripción de los formatos METARs, archivos Clientraw de Weather Display[12] y Realtime de Cumulus[13], y se muestra un ejemplo de cada uno. 2.4.1 METARs Es un formato de presentación de información meteorológica. Un reporte del tiempo METAR es utilizado principalmente por los pilotos en el cumplimiento de una parte de instrucciones pre-vuelo, y por los meteorólogos, que utilizan la información de los METAR para ayudar al pronóstico del tiempo. Están normalizados a través de la International Civil Aviation Organization (ICAO), que permite que se entiendan en la mayor parte del mundo. Los METARs suelen proceder de los aeropuertos o estaciones de observación meteorológica. Los informes son generados normalmente una vez cada hora, si las condiciones cambian significativamente, sin embargo, pueden ser actualizados en los informes especiales, llamados SPECIs. Los METARs contienen un reporte del viento, visibilidad, alcance visual de pista, tiempo presente, cobertura del cielo, temperatura, punto de rocío, y el reglaje de altímetro referidos colectivamente como "el cuerpo del reporte”. Además, es codificada la información que se elabora en un lenguaje claro de los datos del cuerpo del informe puede ser añadidos a los METARs. Ejemplo de un código METAR internacional: 34 El siguiente es un ejemplo METAR del aeropuerto de Burgas, Bulgaria, y fue tomada el 4 de febrero de 2005 a las 16:00 UTC: METAR LBBG 041600Z 12003MPS 310V290 1400 R04/P1500N R22/P1500U M04/M07 Q1020 NOSIG Interpretando cada código:  METAR, indica que lo siguiente es un estándar de observación.  LBBG, es el código del ICAO para aeropuerto de Burgas.  041600Z, indica el tiempo de la observación. El 04 es el día del mes, 1600 es la hora Zulu, que es igual a 16:00 GMT).  12003MPS, indica que la dirección del viento es de 120º al este-sureste a una velocidad de 3 MPS (5,8 KT; 6,7 mph, 11 km/h). Las mediciones de la velocidad puede variar desde nudos (KT), metros por segundo (MPS) ó kilómetros por horas KMH.  310V290, indica la dirección del viento que es variable desde 310º noreste a 290º oeste-noreste.  1400, indica que la visibilidad prevaleciente es de 1.400 m (4.600 pies).  R04/P1500N, indica el alcance visual en pista (RVR) a lo largo de la pista 04 es de 1.500 m (4.900 pies).  R22/P1500U, indica el alcance visual en pista (RVR) a lo largo de la pista 22 es de 1.500 m (4.900 pies).  M04/M07, indica que la temperatura es de -4 ºC (25 ºF) y punto de rocío es de -7 ºC (19 ºF). Una M por delante indica que la temperatura o punto de rocío está por debajo de cero (0) grados Celsius.  Q1020, indica el ajuste actual del altímetro (QNH) es 1.020 hPa (30.12 inHg).  NOSIG, es un ejemplo de un pronóstico de tendencia que se adjunta a los METARs en las estaciones mientras un meteorólogo está de guardia. NOSIG significa que ningún cambio significativo se espera en las condiciones reportadas en las próximas 2 horas.[14] 35 2.4.2 Archivo Realtime.txt Este archivo de Cumulus que es usado por la red MeteoVen sigue el siguiente este formato: Campo Ejemplo Descripción 1 18/10/08 Fecha (dd/mm/yy) 2 16:03:45 Hora (hh:mm:ss) 3 8.4 Temperatura externa 4 84 Humedad relativa 5 5.8 Punto de rocío 6 24.2 Promedio de la velocidad del viento 7 33.0 Última lectura de la velocidad del tiempo 8 261 Dirección del viento (grados) 9 0.0 Tasa de lluvia actual 10 1.0 Lluvia actual 11 999.7 Barómetro 12 W Dirección del viento 13 6 Velocidad del viento 14 Mph Unidades del viento 15 C Unidades de temperatura 16 Mb Unidades de presión 17 Mm Unidades de la lluvia 18 146.6 Viento de lluvia 19 +0.1 Tendencia del valor de la presión 36 Campo Ejemplo Descripción 20 85.2 Precipitación mensual 21 588.4 Precipitación anual 22 11.6 Precipitaciones del día de ayer 26 -0.7 Tendencia de la temperatura 27 10.9 Temperatura más alta del día 28 12:00 Hora de la temperatura más alta de hoy (hh:mm) 29 7.8 Temperatura más baja del día 30 14:41 Hora de la temperatura más baja de hoy (hh:mm) 31 37.4 Velocidad del viento más alta de hoy (promedio) 32 14:38 Hora de la velocidad del viento más alta de hoy (promedio) (hh:mm) 35 999.8 Presión más alta de hoy 36 16:01 Hora de la presión más alta de hoy 37 998.4 Presión más baja de hoy 38 12:06 Hora de la presión más baja de hoy 39 10.3 Índice de calor 40 10.5 Humedad 41 13 Índice de UV Tabla 2.1 - Formato del archivo Realtime.txt 37 2.4.3 Archivo Clientraw.txt A continuación se muestran el formato de este archivo de Weather Display de la red MeteoVen: Campo Ejemplo Descripción 1 12345 Código del archivo 2 6.1 Promedio de la velocidad del tiempo 3 8.5 Ráfagas 4 235 Dirección del viento 5 16.3 Temperatura (ºC) 6 79 Humedad externa (%) 7 1010.0 Presión atmosférica (hpa) 8 0.0 Precipitación diaria 9 0.0 Tasa de lluvia (mm/min) 11 15.9 Temperatura del suelo (ºC) Tabla 2.2 - Formato del archivo Clientraw.txt 2.5 Modelos meteorológicos Son programas informáticos que producen información meteorológica correspondiente a un momento en el futuro para determinados puntos del planeta y ciertas altitudes. En el plano horizontal, un modelo puede ser global y cubrir la totalidad de la Tierra, o bien regional, en ese caso abarca solo una parte de la Tierra. Los modelos regionales también son conocidos como "modelos de área limitada". Los pronósticos se calculan utilizando las ecuaciones matemáticas para la física y la dinámica de la atmósfera. Estas ecuaciones son no lineales y son imposibles de 38 resolver con exactitud. Por consiguiente, los métodos numéricos solo permiten obtener soluciones aproximadas. Los distintos modelos usan diferentes métodos de solución. Algunos modelos globales emplean métodos espectrales para las dimensiones horizontales y métodos de diferencias finitas para el plano vertical, mientras que los modelos regionales y otros modelos globales suelen utilizar métodos de diferencias finitas para las tres dimensiones. Asimismo, los modelos regionales también pueden emplear mallas más reducidas para analizar fenómenos meteorológicos de menor escala, ya que no tienen que resolver ecuaciones para el mundo entero. Los modelos se inicializan utilizando datos observados a partir de diversas fuentes por ejemplo: radiosondas, satélites meteorológicos, aeronaves y observaciones meteorológicas en tierra. Las observaciones que están distribuidas de forma irregular se procesan por asimilación de datos y métodos de análisis objetivos que realizan un control de calidad y obtienen valores en los lugares utilizables por los algoritmos matemáticos de los modelos numéricos (generalmente dispuestos en una malla uniformemente espaciada). A continuación estos datos se usan en el modelo como punto de partida para el pronóstico. Comúnmente, el conjunto de ecuaciones usadas se conocen con el nombre de "ecuaciones primitivas". Los cálculos realizados con estas ecuaciones comienzan utilizando datos meteorológicos disponibles y determinan las tasas de cambio de las distintas variables atmosféricas. Las tasas de cambio predicen el estado de la atmósfera dentro de un breve lapso de tiempo en el futuro. A continuación se aplican las ecuaciones a este nuevo estado de la atmósfera para calcular nuevas tasas de cambio, y estas nuevas tasas de cambio predicen el estado de la atmósfera a un tiempo más distante aún en el futuro. Este procedimiento de avance mediante pequeños incrementos en el tiempo se repite de forma continua hasta que la solución alcance la predicción deseada. El lapso de tiempo de cada incremento se relaciona con la distancia entre los puntos de la malla computacional. Los pasos de tiempo en los modelos climáticos globales pueden ser 39 del orden de decenas de minutos, mientras que los pasos de tiempo utilizados en los modelos regionales pueden variar entre unos pocos segundos a varios minutos. [15] Existen varias tipos de modelos meteorológicos que se explicarán a continuación: 2.5.1 Modelo WRF El Modelo WRF (Weather Research and Forecasting) es un modelo de predicción numérica del tiempo a mesoescala diseñado para servir tanto a la predicción operativa y las necesidades de la investigación atmosférica. Cuenta con múltiples núcleos dinámicos, un sistema de asimilación de datos variacional de 3 dimensiones (3DVAR) y una arquitectura de software que permite el paralelismo computacional y la extensibilidad del sistema. WRF es adecuado para un amplio espectro de aplicaciones a través de un rango de escalas que van desde metros hasta miles de kilómetros, incluyendo: - Simulaciones idealizadas (ejemplo: LES, convecciones, ondas baroclinicas) - Aplicaciones a nivel regional y global. - Investigación parametrizada. - Investigación de datos asimilados. - Investigación de predicciones. - Tiempo real de NWP (Numerical Weather Prediction). - Investigación de Huracanes. - Aplicaciones de modelos acoplados. - Enseñanza. El esfuerzo para desarrollar WRF ha sido una asociación de cooperación, principalmente entre el National Center Atmospheric Research (NCAR), el National Centers para Environmental Prediction (NCEP) y el Forecast Systems Laboratory 40 (FSL), la Air Force Weather Agency (AFWA), la Naval Research Laboratory, la University de Oklahoma, y la Federal Aviation Administration (FAA). WRF permite a los investigadores la capacidad de realizar simulaciones que reflejan tanto la data real o configuraciones idealizadas. WRF provee un modelo de pronóstico operativo que sea flexible y eficiente computacionalmente, ofreciendo al mismo tiempo los avances en la física, avances numéricos, y la asimilación de los datos aportados por la comunidad científica. WRF cuenta con una comunidad de rápido crecimiento de usuarios, talleres y tutoriales que se llevan a cabo cada año en el NCAR. WRF se encuentra actualmente en uso operacional por la NCEP, AFWA y otros centros. [16] 2.5.2 Modelo GFS El Global Forecast System (GFS) es un modelo numérico global de predicción meteorológica a cargo de la National Oceanic y Atmospheric Administration (NOAA). Este modelo matemático se ejecuta cuatro veces al día y produce pronósticos hasta 16 días de antelación, pero con una disminución de la resolución espacial y temporal del tiempo. Luego de 7 días el pronóstico es muy general por lo que no es muy exacto, por eso la mayoría de los organismos no gubernamentales rara vez utilizan los resultados que arroja el modelo que estén más allá de los 10 días. El modelo se ejecuta en dos partes: La primera parte tiene una resolución más alta e incluye las primeras 180 horas (7 días) futuras, y la segunda parte incluye las 180 horas hasta 384 horas (16 días) en una resolución más baja. La resolución varía en cada parte del modelo: horizontalmente, se divide la superficie de la tierra en 35 o 70 kilómetros cuadrados; verticalmente, se divide la atmósfera en 64 capas y temporalmente se produce una predicción por cada 3 horas para las primeras 180 horas. 41 El GFS también es utilizado para producir estadísticas del modelo, tanto en un rango breve (cada 3 horas hasta 72 horas) como para un rango extendido (cada 12 horas hasta 8 días). Este es el único modelo mundial para el que toda la producción está disponible, gratuitamente, a través de Internet (como resultado de la ley EE.UU). [17] 2.5.3 Modelo BRAMS BRAMS (Brazilian Regional Atmospheric Modeling System) es un proyecto conjunto de Atmospheric Meteorogical y Enviroment Technologies (ATMET), Instituto de Matemática y Estadística de la Universidad de Sao Paulo (IME/USP), IAG/USP y CPTEC/INPE (Centro de Predicción del Tiempo y Estudios Climatológicos), fundado por FINEP (Financiadora de Estudios y Proyectos), que tiene como finalidad producir una nueva versión del modelo Regional Atmospheric Modeling System (RAMS) adaptado al trópico. El objetivo principal es proveer de un solo modelo a todos los centros regionales brasileros de pronóstico del tiempo. El BRAMS/RAMS es un modelo de predicción numérica diseñado para simular las circulaciones atmosféricas desde escalas hemisféricas hasta simulaciones de remolinos en la capa límite planetaria. El modelo está equipado con un esquema múltiple de mallas anidadas, el cual permite que las ecuaciones de modelo sean resueltas simultáneamente para cualquier número de mallas computacionales de diferente resolución espacial en interacción. Posee numerosas funcionalidades nuevas y parametrizaciones especializadas para los trópicos y sub-trópicos. BRAMS es un modelo de mesoescala, en estos modelos de predicción numérica del tiempo, la resolución horizontal y vertical es suficiente para pronosticar fenómenos meteorológicos de mesoescala. Dichos fenómenos, que a menudo son producto del forzamiento de la topografía, o están relacionados con la convección, presentan algunos de los mayores retos a la hora de hacer el pronóstico. Los fenómenos climáticos severos, incluidos los tornados. La visibilidad, la 42 turbulencia, el tiempo que percibimos y el estado del mar pueden variar enormemente en distancias de pocos kilómetros y sus repercusiones pueden ser enormes. Las leyes físicas del movimiento y conservación de la energía rigen el desarrollo de las condiciones atmosféricas. Dichas leyes pueden expresarse por medio de una serie de ecuaciones matemáticas complejas que componen el núcleo de lo que denominamos predicción numérica del tiempo. Debido a que se utilizan para predecir lo que sucederá en el futuro, estas ecuaciones se conocen como ecuaciones de pronóstico. Las variables de las ecuaciones representan distintos aspectos del tiempo (por ejemplo, viento, presión, etc.). Como estas ecuaciones determinan la manera en que las variables cambian con el tiempo, si conocemos el estado inicial de la atmósfera podemos resolver las ecuaciones para un momento en el futuro y obtener valores nuevos para esas variables. [18] 2.5.4 Modelo WAM El Modelo Wave Analysis Model (WAM) de generación de oleaje describe básicamente la evolución del espectro bi-dimesional de una onda oceánica. El WAM es capaz de realizar simulaciones en aguas profundas y así como en las zonas marítimas cercanas a las costas tomando en cuenta que los mejores resultados son obtenidos en áreas oceánicas con profundidades mayores a los 20 metros. Como condición de borde el modelo utiliza datos de viento provenientes de modelos meteorológicos como el GFS, MM5, WRF etc. [19] 43 3 Capitulo 3 - Descripción y Análisis del diseño En este Capítulo se detalla el diseño del Sistema de Meteomapas Interactivos (SMI). Se ofrece una visión acerca de los lineamientos seguidos para el diseño de la aplicación; desde la metodología utilizada, los requerimientos de la solución, definición y descripción de las funcionalidades principales con sus respectivos casos de usos y diagramas de secuencias. 3.1 Metodología Utilizada Para el desarrollo del Sistema de Meteomapas Interactivos (SMI), se definieron 4 etapas básicas, las cuales se describen a continuación: 3.1.1 Etapa de Análisis: Consistió en definir precisamente el objetivo general del proyecto, objetivos específicos, y cada una de las funcionalidades que se querían implementar, para lo cual se realizó un análisis del sistema SAMMET y otras páginas webs meteorológicas como la de Wunderground y WeatherChannel sacando las funciones más resaltantes de cada una para dar como resultado una interfaz que fuera lo más amigable para el usuario final. 3.1.2 Etapa de Diseño: El diseño interno del Sistema de Meteomapas Interactivos (SMI), siguió el Modelo Modelo-Vista-Controlador (MVC), para tener separadas la vistas (Interfaces Graficas de Usuario) con el núcleo de la aplicación a través de clases controladoras, con el fin de cumplir con el objetivo de proveer de una aplicación que pueda ser extendida en un futuro con facilidad, sin hacer grandes cambios a la misma. Se utilizaron diagramas de casos de uso y de secuencia para mostrar las funcionalidades del sistema. 44 3.1.3 Etapa de Implementación: La implementación se desarrolló mediante PHP[20] que es un lenguaje de programación web, utilizando el framework PHPCake[21], lo cual permitió seguir el Modelo Vista Controlador. Se utilizo PostgreSQL[22] como Base de Datos y lenguaje PERL[23] para el desarrollo del Robot. 3.1.4 Etapa de Pruebas: Las pruebas son primordiales en el desarrollo ya que permiten la validación para garantizar una aplicación correcta, eficiente, usable, etc. Esta etapa estuvo ligada a la implementación lo que facilitó la validación de cada una de las funcionalidades del sistema. 3.2 Requerimientos de la Solución Como parte fundamental del proceso de diseño de la aplicación, se incluyen a continuación una serie de requerimientos que constituyen la base del desarrollo del sistema final. Estos requerimientos se encuentran divididos en dos categorías: 3.2.1 Requerimiento de Usuario Los requerimientos se dividen en 3 módulos:  Módulo Usuario: - Consultar predicciones meteorológicas como lo son: temperatura, precipitación, dirección y velocidad del viento, humedad, temperatura del mar, oleaje, cizalladura, CAPE, índice Chandler, Altura Geopotencial, Presión a nivel del mar. - Consultar mapas satelitales como por ejemplo: nubosidad, región del Caribe, entre otros. - Consultar mapas de superficies con varias horas de predicción por ejemplo: a las 00:00, 06:00, 12:00, 18:00, y dos mapa son calculados por el CvM que se actualiza cada 45 min. 45 - Cargar todas las estaciones que están registradas en la base de datos como iconos en el mapa interactivo. - Cada estación debe mostrar las condiciones meteorológicas actuales o las últimas reportadas. - Todas estas consultas se mostrarán a través de una interfaz de Google Maps. - Consulta de los registros históricos de cada una de las estaciones meteorológicas, estos resultados se pueden mostrar en tablas como se puede mostrar en modo gráfico.  Módulo Administrador: - Manejar un registro de regiones que pueden representar a un conjunto de países. - Manejar un registro de países que pueden representar a un conjunto de estaciones meteorológicas. - Manejar un registro de estaciones meteorológicas, estas se pueden editar o eliminar posteriormente. Cada estación va a tener asociado un tipo de fuente de datos en particular. - Manera un registro de tipo de fuentes de datos nuevas, las cuales se pueden editar o eliminar.  Módulo Robot - Llevar un registro automatizado diario de cada estación meteorológica, esto se realiza cada hora diariamente. - Hacer un procesamiento en paralelo de las imágenes de predicción meteorológica que luego van a ser mostradas a través de un mapa interactivo 46 3.2.2 Requerimientos de Hardware El sistema fue desarrollado utilizando un cluster compuesto por dos maquinas cada una con Procesador Quad Core. En la primera fue utilizada como servidor web y las dos utilizadas en conjunto para la operación de tratamientos de imágenes. 3.2.3 Requerimientos de Software El sistema fue desarrollado utilizando tecnologías de uso moderno como las siguientes:  PHP 5.3, como lenguaje de programación web.  CakePHP 1.3.8, como framework de soporte para PHP.  PostgreSQL 9.0.4, como manejador de Base de Datos.  API de Google Maps V2, para la generación de mapas geográficos.[24]  Perl 5.1, como lenguaje de programación para la elaboración del robot de descarga e interpretación de datos meteorológicos.  MPICH2.0, para la ejecución en paralelo que realizará el corte de imágenes.[25]  GoogleTileCutter-0.11, script para realizar el corte de imágenes para su posterior carga en la interfaz de Google Maps.[26]  Jpgraph-3.5, para mostrar los resultados históricos de las estaciones de manera gráfica.[27]  Geo-Metar-1.15, librería para la interpretación de los METARs.[28]  Jquery-1.5, como framework de javascript para realizar cargas de páginas de manera dinámica. [29] 3.3 Diseño de las funcionalidades principales En esta Sección se explican de forma general los diagramas de Casos de Uso y Secuencia de las funcionalidades principales. 47 3.3.1 Descripción General de Casos de Usos: En la Figura 3.1 se muestra el Caso de Uso que corresponde a una visión general del Sistema de Meteomapas Interactivos (SMI). Figura 3.1 - Caso de Uso - Nivel 0 - Descripción del Sistema de Meteomapas Interactivos (SMI): Es un sistema que permite ver predicciones meteorológicas a través de la interfaz de Google Maps y consultar datos históricos de las estaciones meteorológicas. - Descripción de los actores:  Usuario: Es el usuario final que interactúa con el sistema consultando las predicciones meteorológicas.  Administrador: Es el usuario que administra las estaciones meteorológicas que se agregan a la Base de Datos y los usuarios administradores que se agregan al sistema.  Robot: Es el sistema que se encarga de registrar los datos meteorológicos que reportan las estaciones y realiza el procesamiento de imágenes para mostrar en las predicciones. En la Figura 3.2 se muestra el caso de uso (Nivel 1) exponiendo las funcionalidades macro para cada actor en el sistema. 48 Figura 3.2 - Caso de uso - Nivel 1 En la Figura 3.3 se muestra el caso de uso (Nivel 2) de las funcionalidades del usuario. Figura 3.3 - Caso de uso - Nivel 2 (Usuario) 49 A continuación se explica en detalle cada funcionalidad del Usuario: Nombre: Consultar registros de una estación meteorológica Código: 1.1 Actor: Usuario Descripción: El usuario podrá consultar las condiciones meteorológicas actuales o históricas de una estación. Precondición: El usuario tiene que haber seleccionado una estación. Postcondición: Se muestran los datos meteorológicos actuales de una estación seleccionada Flujo principal: 1. Usuario: selecciona una estación cualquiera. 2. Sistema: muestra los últimos datos meteorológicos que ha registrado la estación. 3. Usuario: puede seleccionar para ver en detalle todos los datos meteorológicos que ha registrado la estación en el día. 4. Sistema: muestra todos los datos meteorológicos registrados en el día. 5. Usuario: puede descargar estos datos en un formato csv (comma-separated values). 6. Sistema: se da la opción al usuario para descargar el archivo. 7. Usuario: se cambia el formato de resultados a un modo gráfico. 8. Sistema: muestra los resultados de manera grafica donde se pueda estudiar el comportamiento de una variable meteorológica en particular. Flujo alterno 5.1) Usuario: puede hacer una consulta de registros históricos de una estación seleccionando la fecha inicial y final que desee. 6.1) Sistema: se mostraran los resultados de los registros históricos de la estación seleccionada. 7.1) Usuario: el usuario puede descargar los datos en un formato csv. 50 Nombre: Consultar mapa de predicciones meteorológicas. Actor: Usuario Código: 1.2 Descripción: El usuario podrá consultar las predicciones meteorológicas en una región que abarca toda Centroamérica, Caribe y parte de Suramérica. Las variables que se pueden consultar son: Temperatura, Precipitación, Velocidad y dirección del Viento, Humedad, Temperatura del mar, Oleaje, Altura Geopotencial, Índice Chandler, Cizalladura, CAPE, y Presión del mar. Precondición: El usuario tiene que haber cargado la interfaz del mapa interactivo Postcondición: Dependiendo de la opción seleccionada se cargara el mapa sobre la interfaz de Google Maps y se habilitará la barra de predicción para poder observar el comportamiento del clima a futuro y dependiendo de la opción se habilitará también la opción de seleccionar el nivel de altitud del mapa. Flujo principal: 1. Usuario: selecciona una variable cualquiera de las mencionadas anteriormente. 2. Sistema: muestra la predicción meteorológicos de acuerdo a la variable seleccionada. 3. Usuario: puede cambiar la hora de la predicción a futuro a un máximo de 2 días en intervalos de 3 horas. 4. Sistema: cambia la predicción de acuerdo a la que el usuario va seleccionando. 5. Usuario: puede cambiar el nivel de altitud del mapa; en la única variable que no se encuentra habilitado esta opción es en precipitación. 6. Sistema: cambia el tipo de mapa de acuerdo a la que el usuario va seleccionando. 7. Usuario: puede cambiar el nivel de zoom hasta 3 niveles. 51 8. Sistema: el mapa se va actualizando a la medida que el usuario va cambiando. Nombre: Consultar imágenes de mapas (Satelitales, Superficies ó Descargas Eléctricas). Actor: Usuario Código: 1.3 Descripción: El usuario podrá consultar mapas satelitales como nubosidad, vapor de agua y onda corta de la región del Caribe, mapas de superficies y descargas eléctricas. Precondición: El usuario tiene que haber cargado la interfaz del mapa interactivo. Postcondición: Dependiendo de la opción seleccionada se cargara una imagen sobre la interfaz de Google Maps. Flujo principal: 1. Usuario: selecciona una variable cualquiera de las mencionadas anteriormente. 2. Sistema: carga la imagen satelital sobre el mapa. En la Figura 3.4 se muestra el caso de uso (Nivel 2) de las funcionalidades del Administrador. Figura 3.4 - Caso de uso – Nivel 2 (Administrador) 52 A continuación se explica en detalle cada funcionalidad del Administrador: Nombre: Administrar regiones Actor: Administrador Código: 2.1 Descripción: El administrador podrá consultar, crear y editar regiones. Precondición: El administrador deberá estar previamente autenticado. Postcondición: Dependiendo de la opción que consulte el administrador el sistema procederá a ejecutar la acción. Flujo principal: 1. Administrador: crea una región. 2. Sistema: almacena los datos de la nueva región y le da un mensaje al administrador que la región fue creada. Nombre: Administrar países Actor: Administrador Código: 2.2 Descripción: El administrador podrá consultar, crear y editar países. Precondición: El administrador deberá estar previamente autenticado y tiene que haber al menos una región. Cada país debe pertenecer a una región. Postcondición: Dependiendo de la opción que consulte el administrador el sistema procederá a ejecutar la acción. Flujo principal: 1. Administrador: crea un nuevo país. 2. Sistema: almacena los datos del nuevo país y le da un mensaje al administrador que el país fue creada. Flujo alterno: 1.2 Administrador: consulta un nuevo país. 2.2 Sistema: muestra los datos del país. 1.3 Administrador: selecciona un país para editar. 2.3 Sistema: carga los datos de ese país para su edición. 3.3 Administrador: realiza los cambios y procede a guardar. 4.3 Sistema: almacena los cambios realizados. 53 Nombre: Administrar estaciones Actor: Administrador Código: 2.3 Descripción: El administrador podrá consultar, crear, editar y eliminar estaciones. Precondición: El administrador deberá estar previamente autenticado y se tiene que haber creado al menos una región, un país y un tipo de formato de fuente. Cada estación debe pertenecer a un país y tener asociado un tipo de formato de fuente. Postcondición: Dependiendo de la opción que consulte el administrador el sistema procederá a ejecutar la acción. Flujo principal: 1. Administrador: crea una nueva estación. 2. Sistema: almacena los datos de la nueva estación y le da un mensaje al administrador que la estación fue creada. Flujo alterno: 1.2 Administrador: consulta una estación. 2.2 Sistema: muestra los datos de la estación. 1.3 Administrador: selecciona una estación para editar. 2.3 Sistema: carga los datos de esa estación para su edición. 3.3 Administrador: realiza los cambios y procede a guardar. 4.3 Sistema: almacena los cambios realizados. Nombre: Administrar tipo de formatos de fuentes Actor: Administrador Código: 2.4 Descripción: El administrador podrá consultar, crear, editar y eliminar tipo de formatos. Precondición: El administrador deberá estar previamente autenticado. Postcondición: Dependiendo de la opción que consulte el administrador el sistema procederá a ejecutar la acción. 54 Flujo principal: 1. Administrador: crea una tipo de formato de fuente. 2. Sistema: almacena los datos del nuevo tipo de formato de fuente y le da un mensaje al administrador que fue creado. Flujo alterno: 1.2 Administrador: consulta un tipo de formato de fuente. 2.2 Sistema: muestra los resultados. 1.3 Administrador: selecciona un tipo de formato de fuente para aaa editar. 2.3 Sistema: carga los datos para su edición. 3.3 Administrador: realiza los cambios y procede a guardar. 4.3 Sistema: almacena los cambios realizados. En la Figura 3.5 se muestra el caso de uso (Nivel 2) de las funcionalidades del robot. Figura 3.5 - Caso de uso – Nivel 2 (Robot) A continuación se explica en detalle cada funcionalidad del Robot: Nombre: Registrar datos meteorológicos Actor: Robot Código: 3.1 Descripción: El robot interpretará los datos meteorológicos que provienen de cada estación registrada en la base de datos y procederá almacenar estos datos. Esto se realizará periódicamente cada hora. Precondición: Se tiene que haber registrado al menos una estación. 55 Postcondición: Se almacenarán los datos que provienen de cada estación en caso de que se repitan el robot puede ignorarlos de tal forma de no repetir datos. Flujo principal: 1. Robot: descarga los datos meteorológicos y procede a interpretarlos. 2. Sistema: almacena estos datos meteorológicos asociados a una estación. Nombre: Procesar corte de imágenes Actor: Robot Código: 3.2 Descripción: El robot realizará un corte de las imágenes de las predicciones meteorológica asociada a cada variable para que puedan ser interpretadas por la interfaz de Google Maps. Esto se realizará después de las 12 de la noche todos los días. Precondición: Se tiene que haber descargado las imágenes de las respectivas predicciones meteorológicas de cada variable en el servidor local. Postcondición: Se procesa las imágenes y se realizan los respectivos cortes para su posterior interpretación Flujo principal: 1. Robot: ordena las imágenes provenientes de varios directorios en único directorio 2. Robot: Realiza un procesamiento y corte de las imágenes. 3. Sistema: elimina las imágenes procesadas en el día anterior y procede a almacenar las nuevas imágenes cortadas. 56 3.4 Modelos de Secuencia 3.4.1 Funcionalidades del Usuario A continuación se presentan los modelos de secuencia de las funcionalidades del usuario. En la Figura 3.6 se muestra la funcionalidad de consulta de registros de una estación meteorológica. Figura 3.6 - Consultar registros de una estación meteorológica 57 Figura 3.1 - Consultar registros de una estación meteorológica. 1. index(): el usuario inicia la carga del mapa. 2. returnMapa(): el controlador meteomapa devuelve el mapa. 3. activarEstaciones(): el usuario habilitará el menú de estaciones y cargará toda las estaciones con su respectiva información y últimos registros meteorológicos reportados por cada estación. 4. cargarListaPaises(): el controlador meteomapa cargara la lista de países almacenado en la base de datos. 5. cargarEstaciones(): el controlador meteomapa cargará todas las estaciones almacenadas en la bases de datos. 6. cargarRegistrosEstaciones(): el controlador meteomapa cargará todos los registros meteorológicos de cada estación almacenadas en la base de datos. 7. cargarModelo(): el controlador países carga el modelo países. 8. cargarModelo(): el controlador estaciones carga el modelo estaciones. 9. cargarModelo(): el controlador registros carga el modelo registros. 10. returnModelo(): el modelo estaciones devuelve el modelo al controlador estaciones. 58 11. returnModelo(): el modelo países devuelve el modelo al controlador países. 12. returnModelo(): el modelo registros devuelve el modelo al controlador registros. 13. returnRegistrosEstación(): el controlador registros devuelve la lista de estaciones con sus registros meteorológicos al controlador meteomapa. 14. returnEstaciones(): el controlador estaciones devuelve la lista de estaciones con su respectiva información al controlador meteomapa. 15. returnPaises(): el contralador paises devuelve la lista al controlador meteomapa. 16. returnRegistrosEstación(): el controlador meteomapa devuelve la lista de estaciones con sus registros meteorológicos a la interfaz de usuario. 17. returnEstaciones(): el controlador meteomapa devuelve la lista de estaciones con su respectiva información a la interfaz de usuario. 18. returnPaises(): el controlador meteomapa devuelve la lista de países a la interfaz de usuario. 19. seleccionaPaís(id): el usuario selecciona un país pasando como argumento el identificador del país. 20. cargarListaEstaciones(id): el controlador meteomapa cargará la lista de estaciones que se encuentren en un país pasando como el identificador del país. 21. cargarModelo(): el controlador estaciones carga el modelo estaciones. 22. returnModelo(): se devuelve el modelo estaciones al controlador estaciones. 23. returnListaEstaciones(): se devuelve la lista de estaciones al controlador meteomapa. 24. returnListaEstaciones(): se devuelve la lista de estaciones a la interfaz de usuario. 25. seleccionaEstación(id): el usuario selecciona una estación pasando como argumento el identificador de la estación. 26. returnEstacion(): devuelve los datos informativos de la estación. 59 27. returnRegistrosEstacion(): se devuelve los últimos datos meteorológicos de la estación seleccionada. 28. consultarDetallesRegistros(id): el usuario selecciona consultar detalles de una estación meteorológica pasando como argumento el identificador de la estación. 29. cargarModelo(): el controlador registros carga el modelo registros. 30. returnModelo(): devuelve el modelo registros al controlador registros. 31. returnDetallesRegistros(): devuelve todos los registros de una estación meteorológica que se han almacenado en el día actual. 32. descargarRegistros(): el usuario selecciona descargar registros de una estación meteorológica y se crea un archivo con todos los registros de la consulta que el usuario hizo previamente. 33. cargarModelo(): el controlador registros carga el modelo registros. 34. returnModelo(): devuelve el modelo registros al controlador registros. 35. returnArchivo(): el controlador registros devuelve un archivo en formato CSV a la interfaz de usuario para su posterior descarga. 36. activarModoGrafico(): el usuario cambia el modo como se ven los resultados a un modo gráfico para observar el comportamiento de una variable. 37. cargarModelo(): el controlador registros carga el modelo registros. 38. returnModelo(): devuelve el modelo registros al controlador registros. 39. returnGraficos(): el controlador registros devuelve la consulta realizada anteriormente en forma de gráfico. 40. consultarRegistrosHistoricos(fechaInicio, fechaFinal): el usuario selecciona una fecha de inicio y una fecha final para hacer una consulta histórica de los registros de una estación. 41. cargarModelo(): el controlador registros carga el modelo registros. 42. returnModelo(): devuelve el modelo registros al controlador modelo. 43. returnRegistrosHistoricos(): devuelve el listado desde la fecha de inicio hasta la fecha final de los registros meteorológicos que se ha almacenado en la base de datos. 60 A continuación en la Figura 3.7 se muestra el modelo de secuencia de consultar mapas de predicción meteorológica: Figura 3.7 - Consultar mapas de predicción meteorológica 1. index(): el usuario inicia la carga del mapa. 2. returnMapa(): el controlador meteomapa devuelve el mapa a la interfaz de usuario. 3. consultarMapaPredicción(var): el usuario selecciona una variable que puede ser: Temperatura, precipitación, viento, oleaje, humedad relativa, cizalladura, CAPE, índice Chandler y temperatura del mar. Se pasa como argumento el valor de la variable. 4. returnMapaPredicción(): el controlador meteomapa devuelve el mapa de acuerdo a la opción seleccionada. 5. cambiarHoraPredicción(t): el usuario puede cambiar la hora de predicción a futuro, esta predicción será en intervalos de 3 horas y puede ser hasta 2 días a partir del día inicial que se hizo el cálculo. Se pasa como argumento el valor de la hora de la predicción. 61 6. returnMapa(): el controlador meteomapa devuelve el mapa de acuerdo a la opción seleccionada. 7. cambiarNivelAltitudMapa(alt): el usuario puede cambiar el nivel de altitud del mapa, se presentan 4 valores: SFC que es a nivel de superficie, 850 hPa que es a unos 1500 metros de altura, 500 hPa que es a unos 5000 metros de altura y 250 hPa que es a uno 10300 metros de altura. Se pasa como argumento el valor de la altitud seleccionada. Esta opción no se encontrará habilitada para la variable Precipitación. 8. returnMapa(): el controlador meteomapa devuelve el mapa de acuerdo a la opción seleccionada. A continuación en la Figura 3.8 se muestra el modelo de secuencia de consultar mapas satelitales: 1. index(): el usuario inicia la carga del mapa. 2. returnMapa(): el controlador meteomapa devuelve el mapa a la interfaz de usuario. 3. consultarMapaSatelital(var): el usuario selecciona una mapa satelital que puede ser de tipo 3.4.2 Funcionalidades del administrador A continuación en la Figura 3.9, se presentan el modelo de secuencia de la funcionalidad del administrador más representativa. Figura 3.8 - Consultar imágenes de mapas 62 Figura 3.9 - Administrar estaciones meteorológicas 1. Autenticar(): el usuario se autentica en el sistema. 2. cargarModelo(): el controlador usuario carga el modelo usuario. 3. returnModelo(): devuelve el modelo usuario al controlador usuario. 4. validarUsuario(): el controlador usuario valida que los datos sean los correctos. 5. returnUsuario(): si el usuario es válido, se dará un mensaje de bienvenida y entrará al modulo de administrador, si el usuario es incorrecto se le denegará el acceso. 63 6. crearEstación(): el usuario llena un formulario para agregar una estación nueva al sistema. 7. cargarModelo(): el controlador estaciones carga el modelo de estaciones. 8. returnModelo(): devuelve el modelo estaciones al controlador estaciones. 9. guardarEstación(): si todos los datos son correctos el controlador estaciones guarda la nueva estación. 10. returnOk(): el controlador estaciones devuelve un mensaje que se guardo la nueva estación. 11. consultarEstación(id): el usuario consulta la información de una estación almacenada. Se pasa como argumento el identificador de la estación. 12. cargarModelo(): el controlador estaciones carga el modelo de estaciones. 13. returnModelo(): devuelve el modelo estaciones al controlador estaciones. 14. returnEstación(): el controlador estaciones devuelve toda la información de la estación consultada a la interfaz de usuario. 15. editarEstación(id): el usuario selecciona una estación para editar pasando como argumento el identificador de la estación. 16. cargarModelo(): el controlador estaciones carga el modelo de estaciones. 17. returnModelo(): devuelve el modelo estaciones al controlador estaciones. 18. returnEstación(): el controlador estaciones devuelve los datos de la estación a editar a la interfaz de usuario. 19. guardarEstación(): el usuario realiza los cambios necesarios y selecciona guardar estación. 20. cargarModelo(): el controlador estaciones carga el modelo de estaciones. 21. returnModelo(): devuelve el modelo estaciones al controlador estaciones. 22. guardarCambios(): el controlador estaciones guarda los cambios de la estación. 23. returnOk(): el controlador estaciones devuelve un mensaje de que los cambios se realizaron de manera correctamente. 24. borrarEstación(id): el usuario selecciona una estación para eliminarla de la base de datos, se pasa como argumento el identificador de la estación. 25. cargarModelo(): el controlador estaciones carga el modelo de estaciones. 26. returnModelo(): devuelve el modelo estaciones al controlador estaciones. 27. returnOk(): devuelve un mensaje al usuario que la estación fue borrada correctamente. 64 3.5 Diagramas de flujos A continuación se explican las funcionalidades del robot a través de diagramas de flujos. 3.5.1 Funcionalidades del robot En la Figura 3.10 se presenta un diagrama de flujo del proceso de registrar datos meteorológicos. Figura 3.10 - Registrar datos meteorológicos El proceso de registrar datos meteorológicos se ejecuta cada media hora en el servidor y pasa por los siguientes pasos. Buy SmartDraw!- purchased copies print this document without a watermark . Visit www.smartdraw.com or call 1-800-768-3729. 65 1. Consultar listas de estaciones: se hace una consulta a la base de datos de todas las estaciones registradas y solo se van a tomar las que se encuentren con estatus “activo”, es decir, que la estación se encuentre operativa. En esta consulta solo se va a tomar el url de la ubicación web o la dirección del directorio local donde la estación este publicando sus resultados meteorológicos. 2. Descargar datos meteorológicos: teniendo la lista de estaciones meteorológicas se procede hacer un ciclo donde se va consultando la ubicación de cada estación para la descarga de los datos meteorológicos. Esta ubicación puede ser vía Web o local en el servidor donde se está ejecutando el robot. 3. Interpretar datos: una vez descargados los datos meteorológicos ya sea en un formato como METARs o un archivo del tipo ClientRaw o Realtime se procede a interpretar cada campo y se obtienen los valores de las variables meteorológicas persistentes, por ejemplo: variables de temperatura, punto de rocío, dirección del viento, velocidad del viento, humedad relativa, presión atmosférica, la hora y fecha local, entre otros. Antes de pasar al siguiente paso se verifica la hora y fecha reportada con la última registrada por parte de la estación, si estas dos son iguales entonces se procede a ignorar el registro y se pasa a la siguiente estación. Sí son diferentes se pasa al siguiente paso. 4. Almacenar datos meteorológicos: luego que se han interpretado los datos de los archivos o de los METARs, se procede a almacenar en la base de datos asociado a una estación meteorológica. Posteriormente se verifica si hay mas estaciones por revisar, sí todavía quedan se repite el ciclo. Si no el robot termina sus operaciones. En la Figura 3.11 se presenta un diagrama de flujo del proceso de corte de imágenes de predicción meteorológica. 66 Figura 3.11 - Procesar corte de imágenes El proceso de corte imágenes se ejecuta 24 horas a las 12 de la noche en el servidor y pasa por los siguientes pasos. 1. Organizar imágenes de predicción: Se seleccionan todas las imágenes de predicción meteorológica descargadas que se encuentran en diferentes directorios en el servidor local y se copian en un único directorio. 2. Realizar corte de imágenes: Se calcula cuántas imágenes hay en el directorio y teniendo el número total de imágenes, se distribuyen en el número de máquinas que se encuentren disponibles, en este caso solo se cuenta con dos servidores para ejecutar el robot en paralelo. Luego que cada máquina tiene el número de imágenes que le corresponde, cada una va a ejecutar el script GoogleTileCutter para hacer el corte de imágenes a cada una. 3. Almacenar imágenes resultantes: Luego que cada uno ha realizado el corte a cada imagen que le ha correspondido, se copiarán las imágenes resultantes en otro directorio donde posteriormente serán accedidas por el servidor cuando sea consultado a través del mapa interactivo cierta variable como: Temperatura, precipitación, viento, humedad relativa, oleaje, cizalladura, Índice Chandler y CAPE. Luego que se termine este proceso con todas las imágenes de predicción se dará por finalizado la ejecución del robot. Buy SmartDraw!- purchased copies print this document without a watermark . Visit www.smartdraw.com or call 1-800-768-3729. 67 4 Capitulo 4 - Desarrollo de la solución A continuación se presenta la solución del Sistema de Meteomapas Interactivos, en una primera parte el modelo Entidad/Relación de la Base de datos que se implementó para llevar el registro de datos meteorológicos provenientes de las estaciones meteorológicas y cada unos de los módulos que componen el sistema. 4.1 Diagrama de Entidad/Relación A continuación en la Figura 4.1 se presenta el diagrama de Entidad/Relación de la Base de Datos. Figura 4.1 - Modelo Entidad/Relación 68 En el modelo Entidad/Relación, tenemos una tabla llamada regiones donde se almacena el nombre y la descripción, una región puede tener un conjunto de países, en la tabla países se almacena también el nombre y una breve descripción. Adicionalmente cada país puede contener un conjunto de estaciones meteorológicas, donde en la tabla estaciones será necesario guardar la fecha cuando se guardo la estación, el nombre, la localidad, el estado y el país donde se encuentre ubicada esta estación; un código sinóptico particular de cada estación, no todas lo tienen; un código METAR que identifica a cada estación en el mundo que este reportando en formato METAR, sino reporta en este tipo de formato se deja vacío; la latitud y longitud para su posterior ubicación en el mapa geográfico; la altura sobre el nivel del mar, un estatus para indicar si la estación esta activa o inactiva, una ruta de acceso a los datos, está puede ser un url a un recurso Web o una dirección a un directorio en el servidor local; un tipo de fuente que puede ser formato METAR ó archivos del tipo ClientRaw.txt o Realtime.txt; comentarios que se quieran añadir a la estación; la zona horaria en donde se encuentra la estación y por último el identificador del usuario en el sistema que la agrego a la base de datos. Se tiene una tabla llamada “registros” y “registros de los archivos”, que va a estar asociada a la tabla de estación, la única diferencia entre estas dos tablas es que la segunda va a almacenar, la temperatura del suelo, la cantidad de lluvia diaria y la tasa de lluvia en el día, de resto se guardan la fecha y hora que reportó la estación en su respectivo formato; la fecha y hora del momento en la que se está creando el registro; adicionalmente se guardan una serie de datos meteorológicos que no necesariamente se tienen que tener todos los valores, entre ellos tenemos: Temperatura y punto de rocío tanto en grados Celsius como en Fahrenheit; dirección del viento expresado en grados como en letra; velocidad del viento que puede ser consultado en nudos, millas por hora o en kilómetros por hora; humedad relativa que está expresada en porcentaje; presión atmosférica que está en milibares o en hectopascales; ráfagas que son almacenadas en nudos; y por último la condición del tiempo que expresa una breve descripción de cómo está el tiempo actual. Cada registro que se ingresa a la 69 Base de Datos va a tener asociado a un registro de la tabla de “datos sólidos” y “datos sólidos de los archivos” donde se va almacenar el METAR ó el archivo ClientRaw.txt ó Realtime.txt sin interpretar, es decir los datos tal cual como se descargaron en el servidor. Además se tiene una tabla llamada “últimos registros” y “últimos registros de los archivos”, como su nombre lo indican llevará el registro del último reporte que haya transmitido una estación, esto va a ser muy útil para cuando se haga la consulta de cuáles son las condiciones actuales de una estación meteorológica. Aunque las dos tablas de “registros” y “registros de los archivos” sólo difieren en pocos campos, se prefirió separarse porque se iban a presentar muchos campos vacios ya que unos no se encuentran en un formato con respecto al otro. De esta forma si se agrega un nuevo formato de archivo con nuevas variables no se tendría que alterar las tablas ya creadas sino que se crearía una tabla nueva para ese formato en particular. 4.2 Módulo de Usuario El usuario accede al Sistema de Meteomapas Interactivos (SMI) a través del siguiente url: http://met.ivic.gob.ve/sammeti/meteomapa, y se carga la siguiente página como se muestra en la Figura 4.2. Imagen 4.1 - Pagina inicial del Sistema de Meteomapas Interactivos (SMI) Figura 4.2 - Pagina inicial del Sistema de Meteomapas Interactivos (SMI) http://met.ivic.gob.ve/sammeti/meteomapa 70 Cabe destacar que cuando el usuario carga la pagina principal, el navegador le va a pedir un permiso al usuario si quiere que se registre la geolocalización que consiste en rastrear la ubicación de donde se está conectando el usuario como se muestra en la Figura 4.3. Figura 4.3 - Solicitud de geolocalización al usuario Se utilizó la geolocalización para cargar el mapa lo más cercano de donde se encuentre la persona. Se obtienen la latitud y longitud, en la Figura 4.4, se puede observar el código que realiza esta función. Figura 4.4 - Código Javascript de geolocalización Luego con los valores obtenidos anteriormente, pueden ser usadas para cargar donde se va a iniciar el mapa. En la Figura 4.5 se puede observar el código que carga el mapa. 71 Figura 4.5 - Código Javascript de carga de inicio del mapa Continuamos con el mapa, en la parte superior se tiene un menú con una serie de opciones, comenzaremos con la opción de “estaciones”. Luego que el usuario la active, automáticamente se cargarán todas las estaciones que se encuentran en la base de datos, de forma de iconos, donde cada uno va a tener un color y un número que va a variar de acuerdo a la temperatura que este registrando esa estación en ese momento. En la Figura 4.6 se muestra una porción del mapa con las estaciones cargadas en esa región. Adicionalmente se habilita un menú para poder hacer la consulta de las estaciones por país. Figura 4.6 - Iconos de las estaciones cargadas en el mapa 72 Luego se puede seleccionar un país del menú que se tiene en la parte inferior derecha y automáticamente se carga una lista de estaciones asociadas a ese país y se muestra un marco informativo que contiene las condiciones del tiempo actuales al momento de seleccionar un estación o dando click sobre un icono. En la Figura 4.7 se muestra un ejemplo. En este cuadro informativo se muestran los datos de la estación como el nombre y el estado donde se encuentra, así como la ultima que esta realizo un reporte, entre los datos se consiguen, la hora y fecha, temperatura, punto de rocío, dirección del viento, velocidad del viento, humedad relativa y presión atmosférica. En el nombre de la estación se tiene un enlace para consultar los datos meteorológicos que ha reportado en más detalle, es decir, muestra todos los datos que ha reportado en el día. En la Figura 4.8 se muestra un ejemplo. Figura 4.7 - Marco informativo de la condición actual de una estación meteorológica 73 Figura 4.8 - Registro del día de una estación meteorológica En esta pantalla el usuario puede consultar los datos históricos de una estación desde que se empezó almacenar en el servidor hasta la fecha actual, por ejemplo se puede consultar desde una fecha inicial hasta una fecha final y se cargan los resultados después de dar click sobre el botón mostrar cómo se muestran en la Figura 4.9. Figura 4.9 - Registro histórico de una estación meteorológica 74 Se pueden hacer descargar de las consultas realizadas mostrándolo en un formato csv como se muestra en la Figura 4.10. Figura 4.10 - Formato del archivo de descarga Adicionalmente se pueden ver los resultados en un modo gráfico como se ve en la Figura 4.11. Figura 4.11 - Grafico de temperatura De manera predeterminada se muestra el gráfico de la temperatura pero adicionalmente se pueden observar las variables de punto de rocío, viento, humedad relativa y presión atmosférica. Para la realización de estos gráficos fue necesario el uso de las librerías de Jpgraph-3.5. 75 Volviendo al mapa principal, en el menú que se tiene en la parte superior, el usuario puede seleccionar cualquier predicción meteorológica entre ellas se tienen: temperatura, precipitación, viento, oleaje, temperatura del mar, humedad relativa, CAPE y cizalladura, todas estas predicciones fueron calculadas previamente por el modelo meteorológico GFS, con un tiempo de predicción a 2 días. Si selecciona la opción “temperatura” automáticamente se cargará un mapa de predicción sobre la interfaz de Google Maps y se mostrará como en la Figura 4.12. Figura 4.12 - Mapa de predicción de temperatura Podemos observar que se carga el mapa de predicción para la temperatura, además de una barra para cambiar la hora de predicción que irá cambiando en intervalos de 3 horas hasta un máximo de dos días, una caja de selección para cambiar el nivel de altitud, una barra para cambiar el contraste del mapa y una barra de tonalidades de colores que nos indica que la temperatura puede variar en esta región desde los 15 grados Celsius hasta 33 grados Celsius. 76 Cuando se inicia el día, se toma como el tiempo 0, las 8:30am del día 0. A partir de esta hora se puede consultar la predicción hasta las 8:30am del día 2. A la medida que el día este transcurriendo se mostrará la predicción más cercana a la hora en que se esté consultando, por ejemplo: sí son las 14:00 se mostrará la predicción de las 11:30, ahora sí son las 15:00 se cargará el mapa de predicción de las 14:30 y así sucesivamente. En el momento en que sean las 8:30 del día 1, el mapa de predicción habrá cambiado a uno nuevo porque en el servidor ya se ha realizado una nueva predicción por lo tanto las nuevas imágenes se sustituyen por las viejas. Se puede decir que el día se vuelve a reiniciar al día 0. El usuario puede cambiar la hora de predicción como se muestra en la Figura 4.13. Figura 4.13 - Cambio de la hora de predicción El usuario puede quitar la opción de estaciones dando click de nuevo sobre la opción de estaciones, posteriormente todos los iconos agregados previamente se vuelven a quitar. Ente los niveles de altitud que se pueden cambiar son: a nivel de superficie, 850 Hpa, 500 Hpa y 250 Hpa. Por ejemplo seleccionamos 500 Hpa y cambia automáticamente el tipo de mapa como la barra de mediciones como se muestra en la Figura 4.14. 77 Siguiendo con la interfaz de usuario se puede seleccionar la opción de Precipitación que a continuación se cargará la predicción meteorológica como se muestra en la Figura 4.15, en esta opción se habilitará solo la barra de predicción, no se encuentran disponibles mapas de varios niveles de altitud, el mapa que se carga es de nivel de superficie. Figura 4.15 - Mapa de precipitación de Nivel 6 de zoom Figura 4.14 - Mapa de temperatura a un nivel de 500 Hpa 78 El usuario puede disminuir el nivel de zoom a 5, cargando el siguiente mapa que se muestra en la Figura 4.16. Se puede continuar disminuyendo el nivel de zoom hasta el nivel 4 como se muestra en la Figura 4.17, si se continúa disminuyendo el nivel de zoom menor a 4 ya no cargará mas imágenes, igualmente si el zoom se aumenta a un valor mayor a 6 tampoco se cargarán imágenes ya que no se encuentran disponibles para ese nivel de zoom. Figura 4.17 - Mapa de precipitación de Nivel 4 de zoom Figura 4.16 - Mapa de precipitación de Nivel 6 de zoom 79 Siguiendo en la interfaz de usuario, el usuario puede seleccionar la opción de viento, a medida que el usuario va cambiando de variable se desactiva la anterior para que así de esta manera no haya un solapamiento de imágenes. En la Figura 4.18, se muestra el mapa de predicción del viento. Figura 4.18 - Mapa de predicción de viento En este mapa se tiene la barra de predicción, la opción para cambiar los niveles de altitud entre las opciones que se tienen son: a nivel de superficie (SFC), 850 Hpa, 500 Hpa y 250 Hpa, la barra de colores que indica las métricas para este mapa y los vecotores que indican la dirección del viento. Continuando con las opciones, el usuario puede cargar una imagen de satélite que representa la nubosidad que se encuentra actualmente en la región del Caribe y Centroamerica, esta imagen es cargada directamente desde la página http://www.ssd.noaa.gov/goes/east/tatl/vis.jpg, esta imagen es actualizada cada 5 minutos. En la Figura 4.19, se muestra un ejemplo luego de que se selecciona esta opción. http://www.ssd.noaa.gov/goes/east/tatl/vis.jpg 80 Figura 4.19 - Nubosidad sobre el área del Caribe y Centroamérica Siguiendo con la interfaz de usuario, se puede seleccionar la opción de oleaje donde se cargará el siguiente mapa que se muestra en la Figura 4.20. Este mapa de predicción fue generado en base del modelo WAM. Figura 4.20 - Mapa de predicción del oleaje 81 En este mapa se habilitará la barra de predicción junto con la barra de colores que indica las métricas asociadas a este mapa y los vectores que indican la dirección del oleaje, no se encuentra habilitado la opción de cambio de niveles de altitud de este mapa. En la siguiente opción de descargas eléctricas permitirá visualizar una imagen de las descargas eléctricas originadas sobre el área de los Altos Mirandinos y sus adyacencias como se muestra en la Figura 4.21. Es importante destacar que esta imagen es generada por el CvM cada 45 minutos. Esta imagen se puede descargar de la siguiente dirección: http://met.ivic.gob.ve/pipe/nxscreen.jpg. Figura 4.21 - Descargas eléctricas Continuando con la interfaz de usuario se tienen más opciones que están de manera oculta, si se da click sobre la opción “más (9)…”, el nueve (9) indica que hay 9 opciones adicionales, entre las primeras opciones tenemos: temperatura a nivel del mar, humedad relativa, CAPE, Cizalladura, Indice de Chandler, Altura Geopotencial y Presión a nivel del mar. Sí se selecciona la opción de temperatura a nivel del mar se podrá visualizar el siguiente mapa de predicción como se muestra en la Figura 4.22. http://met.ivic.gob.ve/pipe/nxscreen.jpg 82 Figura 4.22 - Mapa de predicción de temperatura a nivel del mar Continuando con las opciones adicionales, se puede seleccionar la opción de humedad como se muestra en la Figura 4.23. Figura 4.23 - Mapa de predicción de humedad relativa 83 Al seleccionar humedad, se encuentra habilitado la barra de predicción y las opciones para cambiar el nivel de altitud del mapa, así como la barra de colores de métricas. Continuando, si se selecciona la opción de CAPE, se puede visualizar el siguiente mapa de predicción como se muestra en la Figura 4.24. Figura 4.24 - Mapa de predicción de CAPE En este mapa se encuentra habilitada las mismas opciones de los anteriores exceptuando la opción para cambiar el nivel de altitud del mapa. Siguiendo con la siguiente opción de Cizalladura, se podrá visualizar el siguiente mapa que se muestra en la Figura 4.25, entre las opciones que se tienen son la barra de predicción y la opción para cambiar el nivel de altitud pero a diferencia de las opciones anteriores sólo está disponible: 850 Hpa, 500 Hpa y 250 Hpa. 84 Figura 4.25 - Mapa de predicción de Cizalladura Luego, sí se cambia de opción a Índice de Chandler se cargará el siguiente mapa de predicción meteorológica, que se muestra en la Figura 4.26. Figura 4.26 - Mapa de predicción de Índice de Chandler 85 La opción de Índice de Chandler no tendrá habilitado la opción para cambiar los niveles de altitud. Luego, sí se cambia de opción a Altura geopotencial, se cargara el siguiente mapa, que se muestra en la Figura 4.27. Figura 4.27 - Mapa de Altura geopotencial Posteriormente, sí se cambia de opción a Presión a nivel del mar, se cargará el siguiente mapa, que se muestra en la Figura 4.28. Figura 4.28 - Mapa de Presión a nivel del mar 86 En la sección de mapas de satelitales, se encuentran disponibles 4 opciones adicionales, una de ella es la opción del mapa Vapor de agua para la región del Caribe, este mapa es descargado desde el siguiente enlace http://www.ssd.noaa.gov/goes/east/tatl/wv.jpg, este mapa es actualizado cada 5 minutos por la NOAA. En la Figura 4.29, se muestra un ejemplo. Figura 4.29 - Vapor de agua para la región del Caribe La siguiente opción de mapa satelital de Onda corta para la región del Caribe, se muestra en la siguiente Figura 4.30. Figura 4.30 - Mapa satelital de Onda corta para la región del Caribe http://www.ssd.noaa.gov/goes/east/tatl/wv.jpg 87 Este mapa satelital de onda corta puede ser descargado desde el siguiente enlace: http://www.ssd.noaa.gov/goes/east/tatl/ir2.jpg. Al momento de seleccionar el mapa TRMM que corresponde a la Misión de Medición de Lluvias tropicales, este mapa muestra las mediciones de las últimas 3 horas. Como se muestra en la Figura 4.31. Este mapa puede ser descargado desde el siguiente enlace: http://trmm.gsfc.nasa.gov/trmm_rain/americas/americas_3hrly_zoom.gif Figura 4.31 - Mapa satelital TRMM En la siguiente opción se puede seleccionar el mapa satelital SST, que permitirá visualizar las temperaturas superficiales del mar, como se muestra en la Figura 4.32. Este mapa es descargado desde el siguiente enlace: http://www.ssec.wisc.edu/data/sst/latest_sst_nomap.gif http://www.ssd.noaa.gov/goes/east/tatl/ir2.jpg http://trmm.gsfc.nasa.gov/trmm_rain/americas/americas_3hrly_zoom.gif http://www.ssec.wisc.edu/data/sst/latest_sst_nomap.gif 88 Figura 4.32 - Mapa Satelitales SST Siguiendo con la siguiente sección de mapas de superficies, se encuentran disponibles 6 opciones adicionales. Los primeros 4 mapas de superficies son predicciones que hace la NOAA para el día que comienza, el primero para las 00:00 horas como se muestra en la Figura 4.33. Este mapa puede ser descargado del siguiente enlace: http://www.nhc.noaa.gov/tafb/ATSA_00Z.gif Figura 4.33 - Mapa de superficie para las 00:00 horas http://www.nhc.noaa.gov/tafb/ATSA_00Z.gif 89 Se puede seleccionar el mapa de superficie para las 06:00 horas, como se muestra en la Figura 4.34, esta imagen es descargada del siguiente enlace: http://www.nhc.noaa.gov/tafb/ATSA_06Z.gif. Figura 4.34 - Mapa de superficie para las 06:00 horas El siguiente mapa de superficie correspondiente para las 12:00 horas, como se muestra en la Figura 4.35, esta imagen es descargada del siguiente enlace: http://www.nhc.noaa.gov/tafb/ATSA_12Z.gif. Figura 4.35 - Mapa de superficie para las 12:00 horas http://www.nhc.noaa.gov/tafb/ATSA_06Z.gif http://www.nhc.noaa.gov/tafb/ATSA_12Z.gif 90 El siguiente mapa de superficie correspondiente para las 18:00 horas, como se muestra en la Figura 4.36, esta imagen es descargada del siguiente enlace: http://www.nhc.noaa.gov/tafb/ATSA_18Z.gif. Figura 4.36 - Mapa de superficie para las 18:00 horas La siguiente opción del mapa de superficie con las variables de Temperatura-Viento- Presión, este mapa es generado por el CvM, como se muestra en la Figura 4.37. Figura 4.37 - Mapa de superficie de Temperatura-Viento-Presión http://www.nhc.noaa.gov/tafb/ATSA_18Z.gif 91 Y por último la opción de mapa de superficie con las variables de Precipitación- Humedad Relativa, este mapa también es generado por el CvM, como se muestra en la Figura 4.38. Figura 4.38 - Mapa de superficie de Precipitación-Humedad Relativa 4.3 Módulo de Administrador El modulo de administración del Sistema de Meteomapas Interactivos (SMI), permitirá llevar un registro de las nuevas estaciones meteorológicas que se agreguen a la Base de Datos, donde cada estación debe pertenecer a un país y a su vez un país debe pertenecer a una región. Adicionalmente cada estación tendrá asociado un tipo de fuente de donde se va a descargar los datos meteorológicos. Para poder realizar todas estas funcionalidades es necesario que el usuario este autenticado y autorizado por la Unidad de Meteorología y el CvM. El usuario puede acceder a la interfaz de ingreso a través del siguiente link http://met.ivic.gob.ve/sammeti/users como se muestra en la Figura 4.39: http://met.ivic.gob.ve/sammeti/users 92 Figura 4.39 - Interfaz de ingreso Luego que se ha autenticado el usuario, ingresa al modulo de administración del Sistema de Meteomapas interactivos donde podrá administrar regiones, países, estaciones y tipo de fuentes. Se le dará un mensaje de bienvenida y un link para cerrar la sesión, como se muestra en la Figura 4.40. Figura 4.40 - Interfaz del modulo de administrador Luego el usuario puede seleccionar la funcionalidad de administrar regiones, donde le aparecerán todas las regiones agregadas en la Base de Datos, con su respectivo ID, 93 Nombre, Descripción y las acciones que puede crear, editar o eliminar esta región. Cabe resaltar que una región puede contener varios países. En la Figura 4.41 se muestra un ejemplo de esta funcionalidad. Figura 4.41 - Interfaz de administrar regiones Posteriormente, el usuario puede seleccionar la funcionalidad de administrar países donde puede crear, editar o eliminar países, como se muestra en la Figura 4.42. Figura 4.42 - Interfaz de administrar países 94 En la funcionalidad de administrar estaciones, el usuario puede agregar, consultar detalles, editar o eliminar estaciones, actualmente se tienen almacenadas 346 estaciones por lo que se todas se muestran en forma paginada, se puede cambiar de páginas desde la primera hasta la última con las flechas que se tienen en la parte inferior, como también se pueden ordenar todas las estaciones de acuerdo al ID, nombre, localidad, estado o país. En la Figura 4.43 se muestra un ejemplo de esta funcionalidad. Figura 4.43 - Interfaz de administrar países Además el usuario puede administrar los tipos de fuentes de datos meteorológicas donde posteriormente se va a consultar los datos que reportan las estaciones meteorológicas, cada estación va a estar asociada a un tipo de fuente de datos. En la Figura 4.44, se muestra esta funcionalidad. 95 Figura 4.44 - Interfaz de administrar tipo de fuentes de datos meteorológicas Volviendo a la funcionalidad de Administrar estaciones, el usuario puede agregar una estación nueva a la Base de Datos, le da click sobre el botón de crear estación y se mostrará una ventana como se muestra en la Figura 4.45 y Figura 4.46, donde se solicitan los datos de la estación como: - Nombre, - Localidad donde se encuentre ubicada, - Estado, - País, - El indicativo sinóptico que también es opcional, - Código METAR en caso que la estación reporte en forma METAR si es otro tipo de estación se puede omitir este campo, - Latitud, - Longitud, - Altura sobre el nivel mar, - Estatus en el que se encuentra actualmente esa estación, 96 - La ruta de la fuente de datos que puede ser un url a una dirección web o una ruta a un directorio del servidor local, - El tipo de fuente si son METARs, archivos Realtime ó Clientraw, - Comentarios, pueden ser opcionales. - Zona horaria. Figura 4.45 - Interfaz de agregar una estación nueva (I parte) Figura 4.46 - Interfaz de agregar una estación nueva (II parte) 97 Adicionalmente se pueden consultar los detalles de cada estación, por cuestiones de espacio, inicialmente solo se muestra el ID, nombre, localidad, estado y país, si se da click sobre el ID de la estación se cargan todos los datos referentes a esa estación en un ventana emergente como se muestra en la Figura 4.47. Figura 4.47 - Interfaz de ver detalles de una estación Entre las acciones adicionales que se tienen se puede editar o eliminar una estación, si selecciona la opción eliminar se muestra un mensaje de confirmación como en la Figura 4.48. Figura 4.48 - Mensaje de confirmación para eliminar una estación 98 El administrador puede editar una estación cambiando cualquier campo que desee, se mostrara una ventana con todos los datos de la estación cargados en un formulario, como se muestra en la Figura 4.49. Figura 4.49 - Interfaz para editar estación Las opciones de agregar, editar o eliminar, se aplican en las 4 funcionalidades de Administrar regiones, países, estaciones y tipo de fuentes. 4.4 Modulo del Robot El modulo de Robot del Sistema de Meteomapas Interactivos (SMI), consiste en dos procesos, el primer proceso es el encargado de llevar el registro de los reportes de las estaciones meteorológicas provenientes de los aeropuertos y de la red MeteoVen. Una subproceso se ejecuta cada media hora y extrae desde la Base de Datos la lista de estaciones meteorológicas que reportan en formato METAR, de esta lista se toma el url que va a ser http://weather.noaa.gov/mgetmetar.php?cccc=<code_metar>, donde el code_metar es el identificador, se hace una consulta http a la página de la NOAA y http://weather.noaa.gov/mgetmetar.php?cccc=%3ccode_metar 99 se descarga todo el html, este es procesado y solo se extrae el formato del METAR, luego usando las librerías de GeoMetar, se obtienen los datos meteorológicos que reportó esta estación para su posterior almacenamiento en la Base de Datos, adicionalmente se guarda los datos crudos que sería el formato sin interpretar como se transmitió y se actualiza una tabla que guardará los últimos datos reportados por una estación. Esto será de mucha ayuda para mostrar el estado del tiempo de una estación en particular en la interfaz de Google Maps. Antes de guardar un reporte se verificará si anteriormente ya fue almacenado de esta manera se evitarán datos repetidos. En el caso de las estaciones de la red MeteoVen que reportan en un formato distinto al METAR, se lee un archivo que puede ser de tipo Clientraw o Realtime con los datos meteorológicos y solo se toman los datos necesarios para su posterior almacenamiento, se repite el mismo procedimiento que el anterior. El segundo proceso del robot, es el encargado de realizar el corte de imágenes, luego de que todas las imágenes resultantes del modelo meteorológico GFS son descargadas en el servidor, se procede a agrupar todas las imágenes en un solo directorio, se hace un cálculo de cuántas imágenes se encuentran en el directorio y se hace una distribución equitativa entre todos los nodos que se encuentren disponible en el cluster. Cada nodo ejecutará el script GoogleTileCutter que es el encargado de realizar el corte a cada imagen para luego ser copiadas a un solo directorio las imágenes resultantes para que queden preparadas para su posterior carga a través de la interfaz de Google Maps. 100 101 5 Resultados, Conclusiones y Trabajos a futuro 5.1 Resultados A continuación se presentan los resultados logrados en este trabajo especial de grado: - Se construyó un modelo de datos que permite almacenar los datos provenientes de las estaciones meteorológicas, interpretando el formato METARs, archivos Clientraw y Realtime. - Se construyó un modelo de datos que permite llevar una administración de las estaciones que se van añadiendo a la Base de Datos. - Se automatizó el proceso de almacenamiento de los reportes que genera cada estación meteorológica. - Se elaboró una interfaz que permita al usuario visualizar las predicciones meteorológicas a través de un mapa interactivo. - Se elaboró una interfaz que permita a un usuario previamente autenticado poder administrar las estaciones que se agregan a la Base de Datos. - Se elaboró una interfaz donde se pueda visualizar las condiciones del tiempo actuales e históricas de una estación en particular. - Se colocó a disposición del público general la descarga de los archivos históricos provenientes de cada estación meteorológica. 5.2 Conclusiones La implementación del nuevo sitio basado en MeteoMapas, obtiene información en formato METAR directamente de la NOAA, de más de 340 estaciones en el área norte de Suramérica, el Caribe y Brasil. Desde finales de 2010, se han capturado más de 750.000 registros METAR de la NOAA y 12.000 de las estaciones MeteoVen que se traducen en 300mb en almacenamiento. Hasta el momento, se ha incorporado información de más de 340 estaciones, información que se toma directamente del sitio de la NOAA. Con esta información 102 más las estaciones pertenecientes a la red MeteoVen, pueden hacerse predicciones meteorológicas adecuadas hasta un máximo de 48 horas. A nivel de las interfaces de usuario, se simplificó de forma sustancial el aspecto del SAMMET, debido a lo dificultoso de su uso en la versión original. Sin embargo, el procesamiento que hay que hacer a las imágenes para que la precisión y el acercamiento sean más detallados consume mucho tiempo de cómputo. En las primeras versiones desarrolladas, se ha logrado reducir el tiempo de procesamiento de las imágenes de 3 horas a una hora y media, sin embargo estos tiempos pueden mejorarse incorporando más nodos de cómputo en la Unidad de Meteorología del IVIC. Esto traería dos consecuencias positivas: en primer lugar, podrían ejecutarse más operaciones de proceso de imágenes mejorando la escala en que se pueden visualizar los datos. Y por el otro lado, podrían añadirse nuevas regiones geográficas al análisis que se realiza. Actualmente el sistema permite a los usuarios obtener información histórica de eventos meteorológicos, de una forma y en una escala que no se había tenido antes en Venezuela. Estos datos servirán para mejorar los modelos, hacer análisis de estadísticas ambientales, y en general para conocer las variaciones de las variables atmosféricas a lo largo de períodos determinados de tiempo. 5.3 Limitaciones Entre las limitaciones que se hallaron durante el desarrollo de este Trabajo se encuentren:  Algunas funcionalidades del meteomapa no son compatibles con el navegador de Internet Explorer de las versión 8 hacia atrás.  Los datos provenientes de los METARs dependen de la NOAA, si hay algún cambio en la página se tendría que cambiar el robot.  Los reportes de los METARs están sujetos a errores por lo que son tratados por humanos y está el factor de error. 103  Si el usuario posee una conexión de internet muy baja, el rendimiento del mapa será muy pobre. 5.4 Trabajos Futuros Para las siguientes etapas de este trabajo se plantea:  Incorporar nuevos modelos de predicción al sistema.  Aumentar el número de imágenes a procesar. Para lograr esto, es necesario tener una mejor infraestructura de cluster y ancho de banda.  Se plantea enriquecer las interfaces incorporando nuevas variables, aunque manteniendo la apariencia sencilla y clara de los mapas.  Incorporar más estaciones meteorológicas a la red MeteoVen, se tiene estimado en una primera etapa incorporar una estación por estado y en una segunda etapa agregar una estación por municipio. 104 105 6 Referencias [1] Space Science and Engineering Center. University of Wisconsin-Madison. Extraido en abril 2010 desde http://www.ssec.wisc.edu/faq.html [2] Tropical Rainfall Measuring Mission. Extraído en abril 2010 desde http://kids.earth.nasa.gov/trmm/ [3] Dr. Barbara J. Munn ‘s Homa Page. California State University, Sacramento. Extraído en mayo 2010 desde http://www.csus.edu/indiv/m/munnb/Oceanography/Lectures/Oceans6d_Seaw ater.html [4] Tutiempo Network, S.L. España. Extraído en mayo 2010 desde http://www.tutiempo.net/diccionario/mapa_de_superficie.html [5] Centro virtual de Meteorología (CvM). Extraído en mayo 2010 desde http://met.ivic.gob.ve/cvm.htm [6] Graficador GRADS (Grid Analyis and Display System). http://www.cmc.org.ve/mediawiki/index.php?title=Guia_GrADS [7] Sistema Automatizado de Modelado Meteorológico para Venezuela (SAMMET). Extraído en mayo 2010 desde http://met.ivic.gob.ve/SAMMET/descripcion.html [8] Proyecto SAMMET-i del Centro virtual de Meteorología. Extraído en mayo 2010 desde http://www.yv5fih.org.ve/sammet/ayuda/descripcion.html [9] Weather Underground. Extraído en mayo 2010 desde http://www.wunderground.com [10] The Weather Channel. Extraído en mayo 2010 desde http://espanol.weather.com/ [11] National Weather Service National Centers for Environmental Prediction. Extraído en mayo 2010 desde http://www.ncep.noaa.gov/ [12] Weather Display – the Weather Station Software. Extraído en mayo 2010 desde http://www.weather-display.com/index.php [13] Sandaysoft - Cumulus Weather Station Software. Extraído en mayo 2010 desde http://sandaysoft.com/products/cumulus http://www.ssec.wisc.edu/faq.html http://kids.earth.nasa.gov/trmm/ http://www.csus.edu/indiv/m/munnb/Oceanography/Lectures/Oceans6d_Seawater.html http://www.csus.edu/indiv/m/munnb/Oceanography/Lectures/Oceans6d_Seawater.html http://met.ivic.gob.ve/cvm.htm http://www.cmc.org.ve/mediawiki/index.php?title=Guia_GrADS http://met.ivic.gob.ve/SAMMET/descripcion.html http://www.yv5fih.org.ve/sammet/ayuda/descripcion.html http://www.wunderground.com/ http://espanol.weather.com/ http://www.ncep.noaa.gov/ http://www.weather-display.com/index.php http://sandaysoft.com/products/cumulus 106 [14] Aviation Routing Weather Report. Extraído en mayo 2010 desde http://www.met.tamu.edu/class/METAR/metar.html [15] Numerical weather prediction. Extraído en mayo 2010 desde http://en.wikipedia.org/wiki/Numerical_weather_prediction [16] The Weather Research Foracasting Model Website. Extraído en mayo 2010 desde http://www.wrf-model.org/index.php [17] Global Forecast System. Extraído en mayo 2010 desde http://en.wikipedia.org/wiki/Global_Forecast_System [18] Brazilian developments on the Regional Atmospheric Modelling System. Extraído en mayo 2010 desde http://brams.cptec.inpe.br/ [19] European Centre for Medium-Range Weather Forecasts. Model WAM. Extraído en mayo 2010 desde http://www.ecmwf.int/newsevents/training/rcourse_notes/numerical_methods/ wave_model/Wave_model2.html [20] PHP: Hypertext Preprocessor. http://www.php.net/ [21] CakePHP: The rapid development PHP framework. http://www.cakephp.org [22] PostgresSQL. http://www.postgresql.org/ [23] The Perl Programming Language. http://www.perl.org/ [24] API Google Maps. http://code.google.com/intl/es- ES/apis/maps/index.html [25] MPICH2: High-performance and Widely Portable MPI. www.mcs.anl.gov/mpi/mpich/. [26] GoogleTileCutter: Unix command-line tile cutter for Google Maps. . http://code.google.com/p/googletilecutter/ [27] Jpgraph – Most powerful PHP-driven charts. http://jpgraph.net/ [28] GeoMetar: A Perl module for accessing aviation weather information. http://jeremy.zawodny.com/perl/Geo-METAR/ [29] Jquery: JavaScript Library. http://jquery.com/ http://www.met.tamu.edu/class/METAR/metar.html http://en.wikipedia.org/wiki/Numerical_weather_prediction http://www.wrf-model.org/index.php http://en.wikipedia.org/wiki/Global_Forecast_System http://brams.cptec.inpe.br/ http://www.ecmwf.int/newsevents/training/rcourse_notes/numerical_methods/wave_model/Wave_model2.html http://www.ecmwf.int/newsevents/training/rcourse_notes/numerical_methods/wave_model/Wave_model2.html http://www.php.net/ http://www.cakephp.org/ http://www.postgresql.org/ http://www.perl.org/ http://code.google.com/intl/es-ES/apis/maps/index.html http://code.google.com/intl/es-ES/apis/maps/index.html http://www.mcs.anl.gov/mpi/mpich/ http://code.google.com/p/googletilecutter/ http://jpgraph.net/ http://jeremy.zawodny.com/perl/Geo-METAR/ http://jquery.com/ 107 7 Apéndice A – Configuración del cluster de la Unidad de Meteorología En la Unidad de Meteorología se encontraban 2 servidores operando de manera independiente. Para que el robot pudiera hacer el procesamiento de las imágenes en paralelo fue necesario agrupar los dos servidores en un cluster. A continuación se explica los pasos que se aplicaron: 1. Configurar NFS (Network File System) en el nodo maestro: a) Editar el archivo /etc/hosts agregando (esto se hace en todos los nodos): 190.170.146.237 UM met.ivic.gob.ve 192.168.1.70 met met.ivic.gob.ve 192.168.1.71 nodo1 nodo1.ivic.gob.ve Nota: En los hosts esclavos hay que dejar: 127.0.0.1 localhost b) Editar el archivo /etc/exports agregando: /home 192.168.1.70/255.255.0.0(rw,sync,no_root_squash) /usr/local/ 192.168.1.70/255.255.0.0(rw,sync,no_root_squash /var/www/ 192.168.1.70/255.255.0.0(rw,sync,no_root_squash c) Ejecutamos: exportfs –ra d) Agregar una directiva al firewall: iptables -A INPUT -p tcp --dport 32771, 111 and 2049 -j ACCEPT e) Reiniciamos el servicio nfs: service nfs restart 108 f) Para que el servicio de nfs se inicie siempre cuando la maquina se enciende, ejecutamos: chkconfig nfs on 2. Configurar NFS en el nodo esclavo: a) Editar el arhivo /etc/fstab agregando: 192.168.1.70:/usr/local/ /usr/local/ nfs defaults 0 0 192.168.1.70:/home /home nfs defaults 0 0 192.168.1.70:/var/www /var/www nfs defaults 0 0 b) Ejecutamos: mount -t nfs –a c) Reiniciamos el servicio: service nfs restart d) Para que el servicio se inicie siempre luego de reiniciar ejecutamos: chkconfig nfs on Nota: Para verificar que NFS esta funcionando creamos una carpeta en /home y vemos que este replicada en todos los nodos. 3. Configurar NIS (Network Information Service) en el nodo maestro a) Indicar el NIS DOMAIN NAME nisdomainname ivic.gob.ve b) Editar el archivo /etc/sysconfig/network, agregando: NISDOMAIN="met.ivic.gob.ve" c) Reiniciar la interfaz de red: 109 service network restart Nota: Asegurarme que portmapper este corriendo con: rpcinfo -p localhost d) Creamos el archivo en /var/yp/ que se llame securenets agregando: 255.0.0.0 127.0.0.0 255.255.255.0 192.168.1.0 e) Descargar el paquete RPM ypserv desde aca: http://dir.filewatcher.com/d/RedHat/9/i386/System%20Environment/Daemon s/ypserv-2.6-2.i386.rpm.119917.html f) Instalamos el paquete: rpm -ivh ypserv-2.6-2.i386.rpm g) Editamos el archivo /etc/yp.conf agregamos: ypserv 127.0.0.1 h) Inicializamos los servicios: service yppasswdd start service ypserv start chkconfig yppasswdd on chkconfig ypserv on i) Ejecutamos: /usr/lib/yp/ypinit –m y agregamos cada uno de los host que nos va pidiendo. 4. Configurar NIS en el nodo esclavo: http://dir.filewatcher.com/d/RedHat/9/i386/System%20Environment/Daemons/ypserv-2.6-2.i386.rpm.119917.html http://dir.filewatcher.com/d/RedHat/9/i386/System%20Environment/Daemons/ypserv-2.6-2.i386.rpm.119917.html 110 a) Indicar el NIS DOMAIN NAME nisdomainname met.ivic.gob.ve b) Editar el archivo /etc/sysconfig/network agregando: NISDOMAIN="met.ivic.gob.ve" c) Reiniciar la interfaz de red service network restart d) Editamos el archivo /etc/yp.conf agregamos: domain met.ivic.gob.ve server 192.168.1.70 e) Iniciamos el servicio service ypbind start chkconfig ypbind on f) Verificamos que este corriendo: rpcinfo -u localhost ypbind g) Creamos el archivo hosts.conf en /etc/nsswitch y agregamos: order hosts, nis, bind h) Editamos el archivo /etc/nsswitch.conf passwd: files nis shadow: files nis group: files nis hosts: files dns netgroup: files nis automount: files nis aliases: files nis 5) Configurar SSH (Secure Shell) a) Creamos una carpeta que se llame .ssh en /etc/skel mkdir .ssh cd .ssh b) Ejecutamos: ssh-keygen -t rsa -f id_rsa Nota: Nos va a pedir que introduzcamos una palabra la dejamos en blanco. c) Copiamos. 111 cat id_rsa.pub >> authorized_keys d) Por último ejecutamos: chmod 600 * 6) Instalar MPICH a) Descomprimir el archivo comprimido con: tar xvzf mpich2-0.1.tar b) Creamos una carpeta para mpich: mkdir mpich2 c) Entramos en la carpeta /usr/local/mpich2 y ejecutamos: ./configure --prefix=/usr/local/mpich2 Make Make install d) Creamos el archivo mpd.hosts en la carpeta /etc/skel y añadimos: node01 ... nodeNN e) Creamos el archivo .mpd.conf (solo con permiso 600) en la carpeta /etc/skel y añadimos: MPD_SECRET=cluster f) Setear las variables de entorno source .bash_profile g) Para probar mpich: o Levantamos el proceso mpd: mpd& o Ejecutamos: mpdboot -n <nro nodos> o Para verificar si los nodos estan activos: mpdtrace o Para bajar todos los nodos mpdallexit